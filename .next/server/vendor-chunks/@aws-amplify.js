"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@aws-amplify";
exports.ids = ["vendor-chunks/@aws-amplify"];
exports.modules = {

/***/ "(rsc)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js":
/*!***********************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Amplify.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Amplify: () => (/* binding */ Amplify),\n/* harmony export */   AmplifyClass: () => (/* binding */ AmplifyClass),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Logger */ \"(rsc)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Amplify');\nvar AmplifyClass = /** @class */ (function () {\n    function AmplifyClass() {\n        // Everything that is `register`ed is tracked here\n        this._components = [];\n        this._config = {};\n        // All modules (with `getModuleName()`) are stored here for dependency injection\n        this._modules = {};\n        // for backward compatibility to avoid breaking change\n        // if someone is using like Amplify.Auth\n        this.Auth = null;\n        this.Analytics = null;\n        this.API = null;\n        this.Credentials = null;\n        this.Storage = null;\n        this.I18n = null;\n        this.Cache = null;\n        this.PubSub = null;\n        this.Interactions = null;\n        this.Pushnotification = null;\n        this.UI = null;\n        this.XR = null;\n        this.Predictions = null;\n        this.DataStore = null;\n        this.Geo = null;\n        this.Logger = _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger;\n        this.ServiceWorker = null;\n    }\n    AmplifyClass.prototype.register = function (comp) {\n        logger.debug('component registered in amplify', comp);\n        this._components.push(comp);\n        if (typeof comp.getModuleName === 'function') {\n            this._modules[comp.getModuleName()] = comp;\n            this[comp.getModuleName()] = comp;\n        }\n        else {\n            logger.debug('no getModuleName method for component', comp);\n        }\n        // Finally configure this new component(category) loaded\n        // With the new modularization changes in Amplify V3, all the Amplify\n        // component are not loaded/registered right away but when they are\n        // imported (and hence instantiated) in the client's app. This ensures\n        // that all new components imported get correctly configured with the\n        // configuration that Amplify.configure() was called with.\n        comp.configure(this._config);\n    };\n    AmplifyClass.prototype.configure = function (config) {\n        var _this = this;\n        if (!config)\n            return this._config;\n        this._config = Object.assign(this._config, config);\n        logger.debug('amplify config', this._config);\n        // Dependency Injection via property-setting.\n        // This avoids introducing a public method/interface/setter that's difficult to remove later.\n        // Plus, it reduces `if` statements within the `constructor` and `configure` of each module\n        Object.entries(this._modules).forEach(function (_a) {\n            var _b = __read(_a, 2), Name = _b[0], comp = _b[1];\n            // e.g. Auth.*\n            Object.keys(comp).forEach(function (property) {\n                // e.g. Auth[\"Credentials\"] = this._modules[\"Credentials\"] when set\n                if (_this._modules[property]) {\n                    comp[property] = _this._modules[property];\n                }\n            });\n        });\n        this._components.map(function (comp) {\n            comp.configure(_this._config);\n        });\n        return this._config;\n    };\n    AmplifyClass.prototype.addPluggable = function (pluggable) {\n        if (pluggable &&\n            pluggable['getCategory'] &&\n            typeof pluggable['getCategory'] === 'function') {\n            this._components.map(function (comp) {\n                if (comp['addPluggable'] &&\n                    typeof comp['addPluggable'] === 'function') {\n                    comp.addPluggable(pluggable);\n                }\n            });\n        }\n    };\n    return AmplifyClass;\n}());\n\nvar Amplify = new AmplifyClass();\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Amplify);\n//# sourceMappingURL=Amplify.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9BbXBsaWZ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxjQUFjLFNBQUksSUFBSSxTQUFJO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixNQUFNO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUN3RDtBQUN4RCxpQkFBaUIsa0RBQVc7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN1QjtBQUNqQjtBQUNQO0FBQ0E7QUFDQTtBQUNBLGlFQUFlLE9BQU8sRUFBQztBQUN2QiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9BbXBsaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbmltcG9ydCB7IENvbnNvbGVMb2dnZXIgYXMgTG9nZ2VyQ2xhc3MgfSBmcm9tICcuL0xvZ2dlcic7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlckNsYXNzKCdBbXBsaWZ5Jyk7XG52YXIgQW1wbGlmeUNsYXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFtcGxpZnlDbGFzcygpIHtcbiAgICAgICAgLy8gRXZlcnl0aGluZyB0aGF0IGlzIGByZWdpc3RlcmBlZCBpcyB0cmFja2VkIGhlcmVcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cyA9IFtdO1xuICAgICAgICB0aGlzLl9jb25maWcgPSB7fTtcbiAgICAgICAgLy8gQWxsIG1vZHVsZXMgKHdpdGggYGdldE1vZHVsZU5hbWUoKWApIGFyZSBzdG9yZWQgaGVyZSBmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb25cbiAgICAgICAgdGhpcy5fbW9kdWxlcyA9IHt9O1xuICAgICAgICAvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB0byBhdm9pZCBicmVha2luZyBjaGFuZ2VcbiAgICAgICAgLy8gaWYgc29tZW9uZSBpcyB1c2luZyBsaWtlIEFtcGxpZnkuQXV0aFxuICAgICAgICB0aGlzLkF1dGggPSBudWxsO1xuICAgICAgICB0aGlzLkFuYWx5dGljcyA9IG51bGw7XG4gICAgICAgIHRoaXMuQVBJID0gbnVsbDtcbiAgICAgICAgdGhpcy5DcmVkZW50aWFscyA9IG51bGw7XG4gICAgICAgIHRoaXMuU3RvcmFnZSA9IG51bGw7XG4gICAgICAgIHRoaXMuSTE4biA9IG51bGw7XG4gICAgICAgIHRoaXMuQ2FjaGUgPSBudWxsO1xuICAgICAgICB0aGlzLlB1YlN1YiA9IG51bGw7XG4gICAgICAgIHRoaXMuSW50ZXJhY3Rpb25zID0gbnVsbDtcbiAgICAgICAgdGhpcy5QdXNobm90aWZpY2F0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5VSSA9IG51bGw7XG4gICAgICAgIHRoaXMuWFIgPSBudWxsO1xuICAgICAgICB0aGlzLlByZWRpY3Rpb25zID0gbnVsbDtcbiAgICAgICAgdGhpcy5EYXRhU3RvcmUgPSBudWxsO1xuICAgICAgICB0aGlzLkdlbyA9IG51bGw7XG4gICAgICAgIHRoaXMuTG9nZ2VyID0gTG9nZ2VyQ2xhc3M7XG4gICAgICAgIHRoaXMuU2VydmljZVdvcmtlciA9IG51bGw7XG4gICAgfVxuICAgIEFtcGxpZnlDbGFzcy5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY29tcCkge1xuICAgICAgICBsb2dnZXIuZGVidWcoJ2NvbXBvbmVudCByZWdpc3RlcmVkIGluIGFtcGxpZnknLCBjb21wKTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cy5wdXNoKGNvbXApO1xuICAgICAgICBpZiAodHlwZW9mIGNvbXAuZ2V0TW9kdWxlTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5fbW9kdWxlc1tjb21wLmdldE1vZHVsZU5hbWUoKV0gPSBjb21wO1xuICAgICAgICAgICAgdGhpc1tjb21wLmdldE1vZHVsZU5hbWUoKV0gPSBjb21wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdubyBnZXRNb2R1bGVOYW1lIG1ldGhvZCBmb3IgY29tcG9uZW50JywgY29tcCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmluYWxseSBjb25maWd1cmUgdGhpcyBuZXcgY29tcG9uZW50KGNhdGVnb3J5KSBsb2FkZWRcbiAgICAgICAgLy8gV2l0aCB0aGUgbmV3IG1vZHVsYXJpemF0aW9uIGNoYW5nZXMgaW4gQW1wbGlmeSBWMywgYWxsIHRoZSBBbXBsaWZ5XG4gICAgICAgIC8vIGNvbXBvbmVudCBhcmUgbm90IGxvYWRlZC9yZWdpc3RlcmVkIHJpZ2h0IGF3YXkgYnV0IHdoZW4gdGhleSBhcmVcbiAgICAgICAgLy8gaW1wb3J0ZWQgKGFuZCBoZW5jZSBpbnN0YW50aWF0ZWQpIGluIHRoZSBjbGllbnQncyBhcHAuIFRoaXMgZW5zdXJlc1xuICAgICAgICAvLyB0aGF0IGFsbCBuZXcgY29tcG9uZW50cyBpbXBvcnRlZCBnZXQgY29ycmVjdGx5IGNvbmZpZ3VyZWQgd2l0aCB0aGVcbiAgICAgICAgLy8gY29uZmlndXJhdGlvbiB0aGF0IEFtcGxpZnkuY29uZmlndXJlKCkgd2FzIGNhbGxlZCB3aXRoLlxuICAgICAgICBjb21wLmNvbmZpZ3VyZSh0aGlzLl9jb25maWcpO1xuICAgIH07XG4gICAgQW1wbGlmeUNsYXNzLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghY29uZmlnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICAgICAgdGhpcy5fY29uZmlnID0gT2JqZWN0LmFzc2lnbih0aGlzLl9jb25maWcsIGNvbmZpZyk7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnYW1wbGlmeSBjb25maWcnLCB0aGlzLl9jb25maWcpO1xuICAgICAgICAvLyBEZXBlbmRlbmN5IEluamVjdGlvbiB2aWEgcHJvcGVydHktc2V0dGluZy5cbiAgICAgICAgLy8gVGhpcyBhdm9pZHMgaW50cm9kdWNpbmcgYSBwdWJsaWMgbWV0aG9kL2ludGVyZmFjZS9zZXR0ZXIgdGhhdCdzIGRpZmZpY3VsdCB0byByZW1vdmUgbGF0ZXIuXG4gICAgICAgIC8vIFBsdXMsIGl0IHJlZHVjZXMgYGlmYCBzdGF0ZW1lbnRzIHdpdGhpbiB0aGUgYGNvbnN0cnVjdG9yYCBhbmQgYGNvbmZpZ3VyZWAgb2YgZWFjaCBtb2R1bGVcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5fbW9kdWxlcykuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksIE5hbWUgPSBfYlswXSwgY29tcCA9IF9iWzFdO1xuICAgICAgICAgICAgLy8gZS5nLiBBdXRoLipcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGNvbXApLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgLy8gZS5nLiBBdXRoW1wiQ3JlZGVudGlhbHNcIl0gPSB0aGlzLl9tb2R1bGVzW1wiQ3JlZGVudGlhbHNcIl0gd2hlbiBzZXRcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX21vZHVsZXNbcHJvcGVydHldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBbcHJvcGVydHldID0gX3RoaXMuX21vZHVsZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cy5tYXAoZnVuY3Rpb24gKGNvbXApIHtcbiAgICAgICAgICAgIGNvbXAuY29uZmlndXJlKF90aGlzLl9jb25maWcpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICB9O1xuICAgIEFtcGxpZnlDbGFzcy5wcm90b3R5cGUuYWRkUGx1Z2dhYmxlID0gZnVuY3Rpb24gKHBsdWdnYWJsZSkge1xuICAgICAgICBpZiAocGx1Z2dhYmxlICYmXG4gICAgICAgICAgICBwbHVnZ2FibGVbJ2dldENhdGVnb3J5J10gJiZcbiAgICAgICAgICAgIHR5cGVvZiBwbHVnZ2FibGVbJ2dldENhdGVnb3J5J10gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudHMubWFwKGZ1bmN0aW9uIChjb21wKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBbJ2FkZFBsdWdnYWJsZSddICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBjb21wWydhZGRQbHVnZ2FibGUnXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBjb21wLmFkZFBsdWdnYWJsZShwbHVnZ2FibGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQW1wbGlmeUNsYXNzO1xufSgpKTtcbmV4cG9ydCB7IEFtcGxpZnlDbGFzcyB9O1xuZXhwb3J0IHZhciBBbXBsaWZ5ID0gbmV3IEFtcGxpZnlDbGFzcygpO1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IEFtcGxpZnk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BbXBsaWZ5LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js":
/*!************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConsoleLogger: () => (/* binding */ ConsoleLogger),\n/* harmony export */   LOG_TYPE: () => (/* binding */ LOG_TYPE)\n/* harmony export */ });\n/* harmony import */ var _Util_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util/Constants */ \"(rsc)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js\");\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __values = (undefined && undefined.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (undefined && undefined.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\n\nvar LOG_LEVELS = {\n    VERBOSE: 1,\n    DEBUG: 2,\n    INFO: 3,\n    WARN: 4,\n    ERROR: 5,\n};\nvar LOG_TYPE;\n(function (LOG_TYPE) {\n    LOG_TYPE[\"DEBUG\"] = \"DEBUG\";\n    LOG_TYPE[\"ERROR\"] = \"ERROR\";\n    LOG_TYPE[\"INFO\"] = \"INFO\";\n    LOG_TYPE[\"WARN\"] = \"WARN\";\n    LOG_TYPE[\"VERBOSE\"] = \"VERBOSE\";\n})(LOG_TYPE || (LOG_TYPE = {}));\n/**\n * Write logs\n * @class Logger\n */\nvar ConsoleLogger = /** @class */ (function () {\n    /**\n     * @constructor\n     * @param {string} name - Name of the logger\n     */\n    function ConsoleLogger(name, level) {\n        if (level === void 0) { level = LOG_TYPE.WARN; }\n        this.name = name;\n        this.level = level;\n        this._pluggables = [];\n    }\n    ConsoleLogger.prototype._padding = function (n) {\n        return n < 10 ? '0' + n : '' + n;\n    };\n    ConsoleLogger.prototype._ts = function () {\n        var dt = new Date();\n        return ([this._padding(dt.getMinutes()), this._padding(dt.getSeconds())].join(':') +\n            '.' +\n            dt.getMilliseconds());\n    };\n    ConsoleLogger.prototype.configure = function (config) {\n        if (!config)\n            return this._config;\n        this._config = config;\n        return this._config;\n    };\n    /**\n     * Write log\n     * @method\n     * @memeberof Logger\n     * @param {LOG_TYPE|string} type - log type, default INFO\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype._log = function (type) {\n        var e_1, _a;\n        var msg = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            msg[_i - 1] = arguments[_i];\n        }\n        var logger_level_name = this.level;\n        if (ConsoleLogger.LOG_LEVEL) {\n            logger_level_name = ConsoleLogger.LOG_LEVEL;\n        }\n        if (typeof window !== 'undefined' && window.LOG_LEVEL) {\n            logger_level_name = window.LOG_LEVEL;\n        }\n        var logger_level = LOG_LEVELS[logger_level_name];\n        var type_level = LOG_LEVELS[type];\n        if (!(type_level >= logger_level)) {\n            // Do nothing if type is not greater than or equal to logger level (handle undefined)\n            return;\n        }\n        var log = console.log.bind(console);\n        if (type === LOG_TYPE.ERROR && console.error) {\n            log = console.error.bind(console);\n        }\n        if (type === LOG_TYPE.WARN && console.warn) {\n            log = console.warn.bind(console);\n        }\n        var prefix = \"[\" + type + \"] \" + this._ts() + \" \" + this.name;\n        var message = '';\n        if (msg.length === 1 && typeof msg[0] === 'string') {\n            message = prefix + \" - \" + msg[0];\n            log(message);\n        }\n        else if (msg.length === 1) {\n            message = prefix + \" \" + msg[0];\n            log(prefix, msg[0]);\n        }\n        else if (typeof msg[0] === 'string') {\n            var obj = msg.slice(1);\n            if (obj.length === 1) {\n                obj = obj[0];\n            }\n            message = prefix + \" - \" + msg[0] + \" \" + obj;\n            log(prefix + \" - \" + msg[0], obj);\n        }\n        else {\n            message = prefix + \" \" + msg;\n            log(prefix, msg);\n        }\n        try {\n            for (var _b = __values(this._pluggables), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var plugin = _c.value;\n                var logEvent = { message: message, timestamp: Date.now() };\n                plugin.pushLogs([logEvent]);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    /**\n     * Write General log. Default to INFO\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.log = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.INFO], msg));\n    };\n    /**\n     * Write INFO log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.info = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.INFO], msg));\n    };\n    /**\n     * Write WARN log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.warn = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.WARN], msg));\n    };\n    /**\n     * Write ERROR log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.error = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.ERROR], msg));\n    };\n    /**\n     * Write DEBUG log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.debug = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.DEBUG], msg));\n    };\n    /**\n     * Write VERBOSE log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.verbose = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.VERBOSE], msg));\n    };\n    ConsoleLogger.prototype.addPluggable = function (pluggable) {\n        if (pluggable && pluggable.getCategoryName() === _Util_Constants__WEBPACK_IMPORTED_MODULE_0__.AWS_CLOUDWATCH_CATEGORY) {\n            this._pluggables.push(pluggable);\n            pluggable.configure(this._config);\n        }\n    };\n    ConsoleLogger.prototype.listPluggables = function () {\n        return this._pluggables;\n    };\n    ConsoleLogger.LOG_LEVEL = null;\n    return ConsoleLogger;\n}());\n\n//# sourceMappingURL=ConsoleLogger.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9Mb2dnZXIvQ29uc29sZUxvZ2dlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBSSxJQUFJLFNBQUk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsU0FBSSxJQUFJLFNBQUk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQUksSUFBSSxTQUFJO0FBQzVCLDZCQUE2QixzQkFBc0I7QUFDbkQ7QUFDQTtBQUM0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0QkFBNEI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxpQkFBaUI7QUFDaEMsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsVUFBVTtBQUNoRjtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGVBQWU7QUFDOUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGVBQWU7QUFDOUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsb0VBQXVCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDd0I7QUFDekIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vTG9nZ2VyL0NvbnNvbGVMb2dnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDE3LTIwMTkgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGhcbiAqIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wL1xuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUlxuICogQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbnZhciBfX3NwcmVhZCA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWQpIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xuICAgIHJldHVybiBhcjtcbn07XG5pbXBvcnQgeyBBV1NfQ0xPVURXQVRDSF9DQVRFR09SWSB9IGZyb20gJy4uL1V0aWwvQ29uc3RhbnRzJztcbnZhciBMT0dfTEVWRUxTID0ge1xuICAgIFZFUkJPU0U6IDEsXG4gICAgREVCVUc6IDIsXG4gICAgSU5GTzogMyxcbiAgICBXQVJOOiA0LFxuICAgIEVSUk9SOiA1LFxufTtcbmV4cG9ydCB2YXIgTE9HX1RZUEU7XG4oZnVuY3Rpb24gKExPR19UWVBFKSB7XG4gICAgTE9HX1RZUEVbXCJERUJVR1wiXSA9IFwiREVCVUdcIjtcbiAgICBMT0dfVFlQRVtcIkVSUk9SXCJdID0gXCJFUlJPUlwiO1xuICAgIExPR19UWVBFW1wiSU5GT1wiXSA9IFwiSU5GT1wiO1xuICAgIExPR19UWVBFW1wiV0FSTlwiXSA9IFwiV0FSTlwiO1xuICAgIExPR19UWVBFW1wiVkVSQk9TRVwiXSA9IFwiVkVSQk9TRVwiO1xufSkoTE9HX1RZUEUgfHwgKExPR19UWVBFID0ge30pKTtcbi8qKlxuICogV3JpdGUgbG9nc1xuICogQGNsYXNzIExvZ2dlclxuICovXG52YXIgQ29uc29sZUxvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIE5hbWUgb2YgdGhlIGxvZ2dlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENvbnNvbGVMb2dnZXIobmFtZSwgbGV2ZWwpIHtcbiAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBMT0dfVFlQRS5XQVJOOyB9XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgdGhpcy5fcGx1Z2dhYmxlcyA9IFtdO1xuICAgIH1cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5fcGFkZGluZyA9IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHJldHVybiBuIDwgMTAgPyAnMCcgKyBuIDogJycgKyBuO1xuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUuX3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXR1cm4gKFt0aGlzLl9wYWRkaW5nKGR0LmdldE1pbnV0ZXMoKSksIHRoaXMuX3BhZGRpbmcoZHQuZ2V0U2Vjb25kcygpKV0uam9pbignOicpICtcbiAgICAgICAgICAgICcuJyArXG4gICAgICAgICAgICBkdC5nZXRNaWxsaXNlY29uZHMoKSk7XG4gICAgfTtcbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIGlmICghY29uZmlnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgbG9nXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1lYmVyb2YgTG9nZ2VyXG4gICAgICogQHBhcmFtIHtMT0dfVFlQRXxzdHJpbmd9IHR5cGUgLSBsb2cgdHlwZSwgZGVmYXVsdCBJTkZPXG4gICAgICogQHBhcmFtIHtzdHJpbmd8b2JqZWN0fSBtc2cgLSBMb2dnaW5nIG1lc3NhZ2Ugb3Igb2JqZWN0XG4gICAgICovXG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUuX2xvZyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHZhciBlXzEsIF9hO1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvZ2dlcl9sZXZlbF9uYW1lID0gdGhpcy5sZXZlbDtcbiAgICAgICAgaWYgKENvbnNvbGVMb2dnZXIuTE9HX0xFVkVMKSB7XG4gICAgICAgICAgICBsb2dnZXJfbGV2ZWxfbmFtZSA9IENvbnNvbGVMb2dnZXIuTE9HX0xFVkVMO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTE9HX0xFVkVMKSB7XG4gICAgICAgICAgICBsb2dnZXJfbGV2ZWxfbmFtZSA9IHdpbmRvdy5MT0dfTEVWRUw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvZ2dlcl9sZXZlbCA9IExPR19MRVZFTFNbbG9nZ2VyX2xldmVsX25hbWVdO1xuICAgICAgICB2YXIgdHlwZV9sZXZlbCA9IExPR19MRVZFTFNbdHlwZV07XG4gICAgICAgIGlmICghKHR5cGVfbGV2ZWwgPj0gbG9nZ2VyX2xldmVsKSkge1xuICAgICAgICAgICAgLy8gRG8gbm90aGluZyBpZiB0eXBlIGlzIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gbG9nZ2VyIGxldmVsIChoYW5kbGUgdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsb2cgPSBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpO1xuICAgICAgICBpZiAodHlwZSA9PT0gTE9HX1RZUEUuRVJST1IgJiYgY29uc29sZS5lcnJvcikge1xuICAgICAgICAgICAgbG9nID0gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBMT0dfVFlQRS5XQVJOICYmIGNvbnNvbGUud2Fybikge1xuICAgICAgICAgICAgbG9nID0gY29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWZpeCA9IFwiW1wiICsgdHlwZSArIFwiXSBcIiArIHRoaXMuX3RzKCkgKyBcIiBcIiArIHRoaXMubmFtZTtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSAnJztcbiAgICAgICAgaWYgKG1zZy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIG1zZ1swXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiAtIFwiICsgbXNnWzBdO1xuICAgICAgICAgICAgbG9nKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1zZy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiBcIiArIG1zZ1swXTtcbiAgICAgICAgICAgIGxvZyhwcmVmaXgsIG1zZ1swXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG1zZ1swXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSBtc2cuc2xpY2UoMSk7XG4gICAgICAgICAgICBpZiAob2JqLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIG9iaiA9IG9ialswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiAtIFwiICsgbXNnWzBdICsgXCIgXCIgKyBvYmo7XG4gICAgICAgICAgICBsb2cocHJlZml4ICsgXCIgLSBcIiArIG1zZ1swXSwgb2JqKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiBcIiArIG1zZztcbiAgICAgICAgICAgIGxvZyhwcmVmaXgsIG1zZyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXModGhpcy5fcGx1Z2dhYmxlcyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luID0gX2MudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGxvZ0V2ZW50ID0geyBtZXNzYWdlOiBtZXNzYWdlLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfTtcbiAgICAgICAgICAgICAgICBwbHVnaW4ucHVzaExvZ3MoW2xvZ0V2ZW50XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgR2VuZXJhbCBsb2cuIERlZmF1bHQgdG8gSU5GT1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1zZyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgbXNnW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbG9nLmFwcGx5KHRoaXMsIF9fc3ByZWFkKFtMT0dfVFlQRS5JTkZPXSwgbXNnKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXcml0ZSBJTkZPIGxvZ1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtc2cgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIG1zZ1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvZy5hcHBseSh0aGlzLCBfX3NwcmVhZChbTE9HX1RZUEUuSU5GT10sIG1zZykpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgV0FSTiBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLldBUk5dLCBtc2cpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFdyaXRlIEVSUk9SIGxvZ1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLkVSUk9SXSwgbXNnKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXcml0ZSBERUJVRyBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1zZyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgbXNnW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbG9nLmFwcGx5KHRoaXMsIF9fc3ByZWFkKFtMT0dfVFlQRS5ERUJVR10sIG1zZykpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgVkVSQk9TRSBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS52ZXJib3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLlZFUkJPU0VdLCBtc2cpKTtcbiAgICB9O1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmFkZFBsdWdnYWJsZSA9IGZ1bmN0aW9uIChwbHVnZ2FibGUpIHtcbiAgICAgICAgaWYgKHBsdWdnYWJsZSAmJiBwbHVnZ2FibGUuZ2V0Q2F0ZWdvcnlOYW1lKCkgPT09IEFXU19DTE9VRFdBVENIX0NBVEVHT1JZKSB7XG4gICAgICAgICAgICB0aGlzLl9wbHVnZ2FibGVzLnB1c2gocGx1Z2dhYmxlKTtcbiAgICAgICAgICAgIHBsdWdnYWJsZS5jb25maWd1cmUodGhpcy5fY29uZmlnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUubGlzdFBsdWdnYWJsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wbHVnZ2FibGVzO1xuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5MT0dfTEVWRUwgPSBudWxsO1xuICAgIHJldHVybiBDb25zb2xlTG9nZ2VyO1xufSgpKTtcbmV4cG9ydCB7IENvbnNvbGVMb2dnZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnNvbGVMb2dnZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js":
/*!******************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AWS_CLOUDWATCH_BASE_BUFFER_SIZE: () => (/* binding */ AWS_CLOUDWATCH_BASE_BUFFER_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_CATEGORY: () => (/* binding */ AWS_CLOUDWATCH_CATEGORY),\n/* harmony export */   AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE: () => (/* binding */ AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_MAX_EVENT_SIZE: () => (/* binding */ AWS_CLOUDWATCH_MAX_EVENT_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_PROVIDER_NAME: () => (/* binding */ AWS_CLOUDWATCH_PROVIDER_NAME),\n/* harmony export */   NO_CREDS_ERROR_STRING: () => (/* binding */ NO_CREDS_ERROR_STRING),\n/* harmony export */   RETRY_ERROR_CODES: () => (/* binding */ RETRY_ERROR_CODES)\n/* harmony export */ });\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// Logging constants\nvar AWS_CLOUDWATCH_BASE_BUFFER_SIZE = 26;\nvar AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE = 1048576;\nvar AWS_CLOUDWATCH_MAX_EVENT_SIZE = 256000;\nvar AWS_CLOUDWATCH_CATEGORY = 'Logging';\nvar AWS_CLOUDWATCH_PROVIDER_NAME = 'AWSCloudWatch';\nvar NO_CREDS_ERROR_STRING = 'No credentials';\nvar RETRY_ERROR_CODES = [\n    'ResourceNotFoundException',\n    'InvalidSequenceTokenException',\n];\n\n//# sourceMappingURL=Constants.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL0NvbnN0YW50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNpTjtBQUNqTiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL0NvbnN0YW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTctMjAxOSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gTG9nZ2luZyBjb25zdGFudHNcbnZhciBBV1NfQ0xPVURXQVRDSF9CQVNFX0JVRkZFUl9TSVpFID0gMjY7XG52YXIgQVdTX0NMT1VEV0FUQ0hfTUFYX0JBVENIX0VWRU5UX1NJWkUgPSAxMDQ4NTc2O1xudmFyIEFXU19DTE9VRFdBVENIX01BWF9FVkVOVF9TSVpFID0gMjU2MDAwO1xudmFyIEFXU19DTE9VRFdBVENIX0NBVEVHT1JZID0gJ0xvZ2dpbmcnO1xudmFyIEFXU19DTE9VRFdBVENIX1BST1ZJREVSX05BTUUgPSAnQVdTQ2xvdWRXYXRjaCc7XG52YXIgTk9fQ1JFRFNfRVJST1JfU1RSSU5HID0gJ05vIGNyZWRlbnRpYWxzJztcbnZhciBSRVRSWV9FUlJPUl9DT0RFUyA9IFtcbiAgICAnUmVzb3VyY2VOb3RGb3VuZEV4Y2VwdGlvbicsXG4gICAgJ0ludmFsaWRTZXF1ZW5jZVRva2VuRXhjZXB0aW9uJyxcbl07XG5leHBvcnQgeyBBV1NfQ0xPVURXQVRDSF9CQVNFX0JVRkZFUl9TSVpFLCBBV1NfQ0xPVURXQVRDSF9DQVRFR09SWSwgQVdTX0NMT1VEV0FUQ0hfTUFYX0JBVENIX0VWRU5UX1NJWkUsIEFXU19DTE9VRFdBVENIX01BWF9FVkVOVF9TSVpFLCBBV1NfQ0xPVURXQVRDSF9QUk9WSURFUl9OQU1FLCBOT19DUkVEU19FUlJPUl9TVFJJTkcsIFJFVFJZX0VSUk9SX0NPREVTLCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29uc3RhbnRzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/Auth.js":
/*!********************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/Auth.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Auth: () => (/* binding */ Auth),\n/* harmony export */   AuthClass: () => (/* binding */ AuthClass)\n/* harmony export */ });\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./types/Auth */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/types/Auth.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Hub.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Credentials.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Parser.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/UniversalStorage/index.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/StorageHelper/index.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js\");\n/* harmony import */ var amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! amazon-cognito-identity-js */ \"(ssr)/./node_modules/amazon-cognito-identity-js/es/index.js\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _OAuth_OAuth__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./OAuth/OAuth */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js\");\n/* harmony import */ var _urlListener__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./urlListener */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/urlListener.js\");\n/* harmony import */ var _Errors__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Errors */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/Errors.js\");\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *\t http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n\n\n\n\n\n\n\n\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_2__.ConsoleLogger('AuthClass');\nvar USER_ADMIN_SCOPE = 'aws.cognito.signin.user.admin';\n// 10 sec, following this guide https://www.nngroup.com/articles/response-times-3-important-limits/\nvar OAUTH_FLOW_MS_TIMEOUT = 10 * 1000;\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' && typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchAuthEvent = function (event, data, message) {\n    _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.dispatch('auth', { event: event, data: data, message: message }, 'Auth', AMPLIFY_SYMBOL);\n};\n// Cognito Documentation for max device\n// tslint:disable-next-line:max-line-length\n// https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_ListDevices.html#API_ListDevices_RequestSyntax\nvar MAX_DEVICES = 60;\nvar MAX_AUTOSIGNIN_POLLING_MS = 3 * 60 * 1000;\n/**\n * Provide authentication steps\n */\nvar AuthClass = /** @class */ (function () {\n    /**\n     * Initialize Auth with AWS configurations\n     * @param {Object} config - Configuration of the Auth\n     */\n    function AuthClass(config) {\n        var _this = this;\n        this.userPool = null;\n        this.user = null;\n        this.oAuthFlowInProgress = false;\n        this.autoSignInInitiated = false;\n        this.Credentials = _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__.Credentials;\n        this.wrapRefreshSessionCallback = function (callback) {\n            var wrapped = function (error, data) {\n                if (data) {\n                    dispatchAuthEvent('tokenRefresh', undefined, \"New token retrieved\");\n                }\n                else {\n                    dispatchAuthEvent('tokenRefresh_failure', error, \"Failed to retrieve new token\");\n                }\n                return callback(error, data);\n            };\n            return wrapped;\n        }; // prettier-ignore\n        this.configure(config);\n        this.currentCredentials = this.currentCredentials.bind(this);\n        this.currentUserCredentials = this.currentUserCredentials.bind(this);\n        _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.listen('auth', function (_a) {\n            var payload = _a.payload;\n            var event = payload.event;\n            switch (event) {\n                case 'signIn':\n                    _this._storage.setItem('amplify-signin-with-hostedUI', 'false');\n                    break;\n                case 'signOut':\n                    _this._storage.removeItem('amplify-signin-with-hostedUI');\n                    break;\n                case 'cognitoHostedUI':\n                    _this._storage.setItem('amplify-signin-with-hostedUI', 'true');\n                    break;\n            }\n        });\n    }\n    AuthClass.prototype.getModuleName = function () {\n        return 'Auth';\n    };\n    AuthClass.prototype.configure = function (config) {\n        var _this = this;\n        if (!config)\n            return this._config || {};\n        logger.debug('configure Auth');\n        var conf = Object.assign({}, this._config, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_5__.Parser.parseMobilehubConfig(config).Auth, config);\n        this._config = conf;\n        var _a = this._config, userPoolId = _a.userPoolId, userPoolWebClientId = _a.userPoolWebClientId, cookieStorage = _a.cookieStorage, oauth = _a.oauth, region = _a.region, identityPoolId = _a.identityPoolId, mandatorySignIn = _a.mandatorySignIn, refreshHandlers = _a.refreshHandlers, identityPoolRegion = _a.identityPoolRegion, clientMetadata = _a.clientMetadata, endpoint = _a.endpoint;\n        if (!this._config.storage) {\n            // backward compatability\n            if (cookieStorage)\n                this._storage = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CookieStorage(cookieStorage);\n            else {\n                this._storage = config.ssr\n                    ? new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_6__.UniversalStorage()\n                    : new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.StorageHelper().getStorage();\n            }\n        }\n        else {\n            if (!this._isValidAuthStorage(this._config.storage)) {\n                logger.error('The storage in the Auth config is not valid!');\n                throw new Error('Empty storage object');\n            }\n            this._storage = this._config.storage;\n        }\n        this._storageSync = Promise.resolve();\n        if (typeof this._storage['sync'] === 'function') {\n            this._storageSync = this._storage['sync']();\n        }\n        if (userPoolId) {\n            var userPoolData = {\n                UserPoolId: userPoolId,\n                ClientId: userPoolWebClientId,\n                endpoint: endpoint,\n            };\n            userPoolData.Storage = this._storage;\n            this.userPool = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserPool(userPoolData, this.wrapRefreshSessionCallback);\n        }\n        this.Credentials.configure({\n            mandatorySignIn: mandatorySignIn,\n            region: identityPoolRegion || region,\n            userPoolId: userPoolId,\n            identityPoolId: identityPoolId,\n            refreshHandlers: refreshHandlers,\n            storage: this._storage,\n        });\n        // initialize cognitoauth client if hosted ui options provided\n        // to keep backward compatibility:\n        var cognitoHostedUIConfig = oauth\n            ? (0,_types__WEBPACK_IMPORTED_MODULE_8__.isCognitoHostedOpts)(this._config.oauth)\n                ? oauth\n                : oauth.awsCognito\n            : undefined;\n        if (cognitoHostedUIConfig) {\n            var cognitoAuthParams = Object.assign({\n                cognitoClientId: userPoolWebClientId,\n                UserPoolId: userPoolId,\n                domain: cognitoHostedUIConfig['domain'],\n                scopes: cognitoHostedUIConfig['scope'],\n                redirectSignIn: cognitoHostedUIConfig['redirectSignIn'],\n                redirectSignOut: cognitoHostedUIConfig['redirectSignOut'],\n                responseType: cognitoHostedUIConfig['responseType'],\n                Storage: this._storage,\n                urlOpener: cognitoHostedUIConfig['urlOpener'],\n                clientMetadata: clientMetadata,\n            }, cognitoHostedUIConfig['options']);\n            this._oAuthHandler = new _OAuth_OAuth__WEBPACK_IMPORTED_MODULE_9__[\"default\"]({\n                scopes: cognitoAuthParams.scopes,\n                config: cognitoAuthParams,\n                cognitoClientId: cognitoAuthParams.cognitoClientId,\n            });\n            // **NOTE** - Remove this in a future major release as it is a breaking change\n            // Prevents _handleAuthResponse from being called multiple times in Expo\n            // See https://github.com/aws-amplify/amplify-js/issues/4388\n            var usedResponseUrls_1 = {};\n            (0,_urlListener__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(function (_a) {\n                var url = _a.url;\n                if (usedResponseUrls_1[url]) {\n                    return;\n                }\n                usedResponseUrls_1[url] = true;\n                _this._handleAuthResponse(url);\n            });\n        }\n        dispatchAuthEvent('configured', null, \"The Auth category has been configured successfully\");\n        if (!this.autoSignInInitiated &&\n            typeof this._storage['getItem'] === 'function') {\n            var pollingInitiated = this.isTrueStorageValue('amplify-polling-started');\n            if (pollingInitiated) {\n                dispatchAuthEvent('autoSignIn_failure', null, _types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.AutoSignInError);\n                this._storage.removeItem('amplify-auto-sign-in');\n            }\n            this._storage.removeItem('amplify-polling-started');\n        }\n        return this._config;\n    };\n    /**\n     * Sign up with username, password and other attributes like phone, email\n     * @param {String | object} params - The user attributes used for signin\n     * @param {String[]} restOfAttrs - for the backward compatability\n     * @return - A promise resolves callback data if success\n     */\n    AuthClass.prototype.signUp = function (params) {\n        var _this = this;\n        var restOfAttrs = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            restOfAttrs[_i - 1] = arguments[_i];\n        }\n        var _a, _b, _c;\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        var username = null;\n        var password = null;\n        var attributes = [];\n        var validationData = null;\n        var clientMetadata;\n        var autoSignIn = { enabled: false };\n        var autoSignInValidationData = {};\n        var autoSignInClientMetaData = {};\n        if (params && typeof params === 'string') {\n            username = params;\n            password = restOfAttrs ? restOfAttrs[0] : null;\n            var email = restOfAttrs ? restOfAttrs[1] : null;\n            var phone_number = restOfAttrs ? restOfAttrs[2] : null;\n            if (email)\n                attributes.push(new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserAttribute({ Name: 'email', Value: email }));\n            if (phone_number)\n                attributes.push(new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserAttribute({\n                    Name: 'phone_number',\n                    Value: phone_number,\n                }));\n        }\n        else if (params && typeof params === 'object') {\n            username = params['username'];\n            password = params['password'];\n            if (params && params.clientMetadata) {\n                clientMetadata = params.clientMetadata;\n            }\n            else if (this._config.clientMetadata) {\n                clientMetadata = this._config.clientMetadata;\n            }\n            var attrs_1 = params['attributes'];\n            if (attrs_1) {\n                Object.keys(attrs_1).map(function (key) {\n                    attributes.push(new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserAttribute({ Name: key, Value: attrs_1[key] }));\n                });\n            }\n            var validationDataObject_1 = params['validationData'];\n            if (validationDataObject_1) {\n                validationData = [];\n                Object.keys(validationDataObject_1).map(function (key) {\n                    validationData.push(new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserAttribute({\n                        Name: key,\n                        Value: validationDataObject_1[key],\n                    }));\n                });\n            }\n            autoSignIn = (_a = params.autoSignIn) !== null && _a !== void 0 ? _a : { enabled: false };\n            if (autoSignIn.enabled) {\n                this._storage.setItem('amplify-auto-sign-in', 'true');\n                autoSignInValidationData = (_b = autoSignIn.validationData) !== null && _b !== void 0 ? _b : {};\n                autoSignInClientMetaData = (_c = autoSignIn.clientMetaData) !== null && _c !== void 0 ? _c : {};\n            }\n        }\n        else {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.SignUpError);\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        if (!password) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyPassword);\n        }\n        logger.debug('signUp attrs:', attributes);\n        logger.debug('signUp validation data:', validationData);\n        return new Promise(function (resolve, reject) {\n            _this.userPool.signUp(username, password, attributes, validationData, function (err, data) {\n                if (err) {\n                    dispatchAuthEvent('signUp_failure', err, username + \" failed to signup\");\n                    reject(err);\n                }\n                else {\n                    dispatchAuthEvent('signUp', data, username + \" has signed up successfully\");\n                    if (autoSignIn.enabled) {\n                        _this.handleAutoSignIn(username, password, autoSignInValidationData, autoSignInClientMetaData, data);\n                    }\n                    resolve(data);\n                }\n            }, clientMetadata);\n        });\n    };\n    AuthClass.prototype.handleAutoSignIn = function (username, password, validationData, clientMetadata, data) {\n        this.autoSignInInitiated = true;\n        var authDetails = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.AuthenticationDetails({\n            Username: username,\n            Password: password,\n            ValidationData: validationData,\n            ClientMetadata: clientMetadata,\n        });\n        if (data.userConfirmed) {\n            this.signInAfterUserConfirmed(authDetails);\n        }\n        else if (this._config.signUpVerificationMethod === 'link') {\n            this.handleLinkAutoSignIn(authDetails);\n        }\n        else {\n            this.handleCodeAutoSignIn(authDetails);\n        }\n    };\n    AuthClass.prototype.handleCodeAutoSignIn = function (authDetails) {\n        var _this = this;\n        var listenEvent = function (_a) {\n            var payload = _a.payload;\n            if (payload.event === 'confirmSignUp') {\n                _this.signInAfterUserConfirmed(authDetails, listenEvent);\n            }\n        };\n        _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.listen('auth', listenEvent);\n    };\n    AuthClass.prototype.handleLinkAutoSignIn = function (authDetails) {\n        var _this = this;\n        this._storage.setItem('amplify-polling-started', 'true');\n        var start = Date.now();\n        var autoSignInPollingIntervalId = setInterval(function () {\n            if (Date.now() - start > MAX_AUTOSIGNIN_POLLING_MS) {\n                clearInterval(autoSignInPollingIntervalId);\n                dispatchAuthEvent('autoSignIn_failure', null, 'Please confirm your account and use your credentials to sign in.');\n                _this._storage.removeItem('amplify-auto-sign-in');\n            }\n            else {\n                _this.signInAfterUserConfirmed(authDetails, null, autoSignInPollingIntervalId);\n            }\n        }, 5000);\n    };\n    AuthClass.prototype.signInAfterUserConfirmed = function (authDetails, listenEvent, autoSignInPollingIntervalId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var user, error_1;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        user = this.createCognitoUser(authDetails.getUsername());\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, user.authenticateUser(authDetails, this.authCallbacks(user, function (value) {\n                                dispatchAuthEvent('autoSignIn', value, authDetails.getUsername() + \" has signed in successfully\");\n                                if (listenEvent) {\n                                    _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.remove('auth', listenEvent);\n                                }\n                                if (autoSignInPollingIntervalId) {\n                                    clearInterval(autoSignInPollingIntervalId);\n                                    _this._storage.removeItem('amplify-polling-started');\n                                }\n                                _this._storage.removeItem('amplify-auto-sign-in');\n                            }, function (error) {\n                                logger.error(error);\n                                _this._storage.removeItem('amplify-auto-sign-in');\n                            }))];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_1 = _a.sent();\n                        logger.error(error_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Send the verification code to confirm sign up\n     * @param {String} username - The username to be confirmed\n     * @param {String} code - The verification code\n     * @param {ConfirmSignUpOptions} options - other options for confirm signup\n     * @return - A promise resolves callback data if success\n     */\n    AuthClass.prototype.confirmSignUp = function (username, code, options) {\n        var _this = this;\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        if (!code) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyCode);\n        }\n        var user = this.createCognitoUser(username);\n        var forceAliasCreation = options && typeof options.forceAliasCreation === 'boolean'\n            ? options.forceAliasCreation\n            : true;\n        var clientMetadata;\n        if (options && options.clientMetadata) {\n            clientMetadata = options.clientMetadata;\n        }\n        else if (this._config.clientMetadata) {\n            clientMetadata = this._config.clientMetadata;\n        }\n        return new Promise(function (resolve, reject) {\n            user.confirmRegistration(code, forceAliasCreation, function (err, data) {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    dispatchAuthEvent('confirmSignUp', data, username + \" has been confirmed successfully\");\n                    var autoSignIn = _this.isTrueStorageValue('amplify-auto-sign-in');\n                    if (autoSignIn && !_this.autoSignInInitiated) {\n                        dispatchAuthEvent('autoSignIn_failure', null, _types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.AutoSignInError);\n                        _this._storage.removeItem('amplify-auto-sign-in');\n                    }\n                    resolve(data);\n                }\n            }, clientMetadata);\n        });\n    };\n    AuthClass.prototype.isTrueStorageValue = function (value) {\n        var item = this._storage.getItem(value);\n        return item ? item === 'true' : false;\n    };\n    /**\n     * Resend the verification code\n     * @param {String} username - The username to be confirmed\n     * @param {ClientMetadata} clientMetadata - Metadata to be passed to Cognito Lambda triggers\n     * @return - A promise resolves code delivery details if successful\n     */\n    AuthClass.prototype.resendSignUp = function (username, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        var user = this.createCognitoUser(username);\n        return new Promise(function (resolve, reject) {\n            user.resendConfirmationCode(function (err, data) {\n                if (err) {\n                    reject(err);\n                }\n                else {\n                    resolve(data);\n                }\n            }, clientMetadata);\n        });\n    };\n    /**\n     * Sign in\n     * @param {String | SignInOpts} usernameOrSignInOpts - The username to be signed in or the sign in options\n     * @param {String} pw - The password of the username\n     * @param {ClientMetaData} clientMetadata - Client metadata for custom workflows\n     * @return - A promise resolves the CognitoUser\n     */\n    AuthClass.prototype.signIn = function (usernameOrSignInOpts, pw, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        var username = null;\n        var password = null;\n        var validationData = {};\n        // for backward compatibility\n        if (typeof usernameOrSignInOpts === 'string') {\n            username = usernameOrSignInOpts;\n            password = pw;\n        }\n        else if ((0,_types__WEBPACK_IMPORTED_MODULE_8__.isUsernamePasswordOpts)(usernameOrSignInOpts)) {\n            if (typeof pw !== 'undefined') {\n                logger.warn('The password should be defined under the first parameter object!');\n            }\n            username = usernameOrSignInOpts.username;\n            password = usernameOrSignInOpts.password;\n            validationData = usernameOrSignInOpts.validationData;\n        }\n        else {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.InvalidUsername);\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        var authDetails = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.AuthenticationDetails({\n            Username: username,\n            Password: password,\n            ValidationData: validationData,\n            ClientMetadata: clientMetadata,\n        });\n        if (password) {\n            return this.signInWithPassword(authDetails);\n        }\n        else {\n            return this.signInWithoutPassword(authDetails);\n        }\n    };\n    /**\n     * Return an object with the authentication callbacks\n     * @param {CognitoUser} user - the cognito user object\n     * @param {} resolve - function called when resolving the current step\n     * @param {} reject - function called when rejecting the current step\n     * @return - an object with the callback methods for user authentication\n     */\n    AuthClass.prototype.authCallbacks = function (user, resolve, reject) {\n        var _this = this;\n        var that = this;\n        return {\n            onSuccess: function (session) { return __awaiter(_this, void 0, void 0, function () {\n                var cred, e_1, currentUser, e_2;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            logger.debug(session);\n                            delete user['challengeName'];\n                            delete user['challengeParam'];\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 4, 5, 9]);\n                            return [4 /*yield*/, this.Credentials.clear()];\n                        case 2:\n                            _a.sent();\n                            return [4 /*yield*/, this.Credentials.set(session, 'session')];\n                        case 3:\n                            cred = _a.sent();\n                            logger.debug('succeed to get cognito credentials', cred);\n                            return [3 /*break*/, 9];\n                        case 4:\n                            e_1 = _a.sent();\n                            logger.debug('cannot get cognito credentials', e_1);\n                            return [3 /*break*/, 9];\n                        case 5:\n                            _a.trys.push([5, 7, , 8]);\n                            return [4 /*yield*/, this.currentUserPoolUser()];\n                        case 6:\n                            currentUser = _a.sent();\n                            that.user = currentUser;\n                            dispatchAuthEvent('signIn', currentUser, \"A user \" + user.getUsername() + \" has been signed in\");\n                            resolve(currentUser);\n                            return [3 /*break*/, 8];\n                        case 7:\n                            e_2 = _a.sent();\n                            logger.error('Failed to get the signed in user', e_2);\n                            reject(e_2);\n                            return [3 /*break*/, 8];\n                        case 8: return [7 /*endfinally*/];\n                        case 9: return [2 /*return*/];\n                    }\n                });\n            }); },\n            onFailure: function (err) {\n                logger.debug('signIn failure', err);\n                dispatchAuthEvent('signIn_failure', err, user.getUsername() + \" failed to signin\");\n                reject(err);\n            },\n            customChallenge: function (challengeParam) {\n                logger.debug('signIn custom challenge answer required');\n                user['challengeName'] = 'CUSTOM_CHALLENGE';\n                user['challengeParam'] = challengeParam;\n                resolve(user);\n            },\n            mfaRequired: function (challengeName, challengeParam) {\n                logger.debug('signIn MFA required');\n                user['challengeName'] = challengeName;\n                user['challengeParam'] = challengeParam;\n                resolve(user);\n            },\n            mfaSetup: function (challengeName, challengeParam) {\n                logger.debug('signIn mfa setup', challengeName);\n                user['challengeName'] = challengeName;\n                user['challengeParam'] = challengeParam;\n                resolve(user);\n            },\n            newPasswordRequired: function (userAttributes, requiredAttributes) {\n                logger.debug('signIn new password');\n                user['challengeName'] = 'NEW_PASSWORD_REQUIRED';\n                user['challengeParam'] = {\n                    userAttributes: userAttributes,\n                    requiredAttributes: requiredAttributes,\n                };\n                resolve(user);\n            },\n            totpRequired: function (challengeName, challengeParam) {\n                logger.debug('signIn totpRequired');\n                user['challengeName'] = challengeName;\n                user['challengeParam'] = challengeParam;\n                resolve(user);\n            },\n            selectMFAType: function (challengeName, challengeParam) {\n                logger.debug('signIn selectMFAType', challengeName);\n                user['challengeName'] = challengeName;\n                user['challengeParam'] = challengeParam;\n                resolve(user);\n            },\n        };\n    };\n    /**\n     * Sign in with a password\n     * @private\n     * @param {AuthenticationDetails} authDetails - the user sign in data\n     * @return - A promise resolves the CognitoUser object if success or mfa required\n     */\n    AuthClass.prototype.signInWithPassword = function (authDetails) {\n        var _this = this;\n        if (this.pendingSignIn) {\n            throw new Error('Pending sign-in attempt already in progress');\n        }\n        var user = this.createCognitoUser(authDetails.getUsername());\n        this.pendingSignIn = new Promise(function (resolve, reject) {\n            user.authenticateUser(authDetails, _this.authCallbacks(user, function (value) {\n                _this.pendingSignIn = null;\n                resolve(value);\n            }, function (error) {\n                _this.pendingSignIn = null;\n                reject(error);\n            }));\n        });\n        return this.pendingSignIn;\n    };\n    /**\n     * Sign in without a password\n     * @private\n     * @param {AuthenticationDetails} authDetails - the user sign in data\n     * @return - A promise resolves the CognitoUser object if success or mfa required\n     */\n    AuthClass.prototype.signInWithoutPassword = function (authDetails) {\n        var _this = this;\n        var user = this.createCognitoUser(authDetails.getUsername());\n        user.setAuthenticationFlowType('CUSTOM_AUTH');\n        return new Promise(function (resolve, reject) {\n            user.initiateAuth(authDetails, _this.authCallbacks(user, resolve, reject));\n        });\n    };\n    /**\n     * This was previously used by an authenticated user to get MFAOptions,\n     * but no longer returns a meaningful response. Refer to the documentation for\n     * how to setup and use MFA: https://docs.amplify.aws/lib/auth/mfa/q/platform/js\n     * @deprecated\n     * @param {CognitoUser} user - the current user\n     * @return - A promise resolves the current preferred mfa option if success\n     */\n    AuthClass.prototype.getMFAOptions = function (user) {\n        return new Promise(function (res, rej) {\n            user.getMFAOptions(function (err, mfaOptions) {\n                if (err) {\n                    logger.debug('get MFA Options failed', err);\n                    rej(err);\n                    return;\n                }\n                logger.debug('get MFA options success', mfaOptions);\n                res(mfaOptions);\n                return;\n            });\n        });\n    };\n    /**\n     * get preferred mfa method\n     * @param {CognitoUser} user - the current cognito user\n     * @param {GetPreferredMFAOpts} params - options for getting the current user preferred MFA\n     */\n    AuthClass.prototype.getPreferredMFA = function (user, params) {\n        var _this = this;\n        var that = this;\n        return new Promise(function (res, rej) {\n            var clientMetadata = _this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n            var bypassCache = params ? params.bypassCache : false;\n            user.getUserData(function (err, data) { return __awaiter(_this, void 0, void 0, function () {\n                var cleanUpError_1, mfaType;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!err) return [3 /*break*/, 5];\n                            logger.debug('getting preferred mfa failed', err);\n                            if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                        case 2:\n                            _a.sent();\n                            return [3 /*break*/, 4];\n                        case 3:\n                            cleanUpError_1 = _a.sent();\n                            rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_1.message));\n                            return [2 /*return*/];\n                        case 4:\n                            rej(err);\n                            return [2 /*return*/];\n                        case 5:\n                            mfaType = that._getMfaTypeFromUserData(data);\n                            if (!mfaType) {\n                                rej('invalid MFA Type');\n                                return [2 /*return*/];\n                            }\n                            else {\n                                res(mfaType);\n                                return [2 /*return*/];\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); }, { bypassCache: bypassCache, clientMetadata: clientMetadata });\n        });\n    };\n    AuthClass.prototype._getMfaTypeFromUserData = function (data) {\n        var ret = null;\n        var preferredMFA = data.PreferredMfaSetting;\n        // if the user has used Auth.setPreferredMFA() to setup the mfa type\n        // then the \"PreferredMfaSetting\" would exist in the response\n        if (preferredMFA) {\n            ret = preferredMFA;\n        }\n        else {\n            // if mfaList exists but empty, then its noMFA\n            var mfaList = data.UserMFASettingList;\n            if (!mfaList) {\n                // if SMS was enabled by using Auth.enableSMS(),\n                // the response would contain MFAOptions\n                // as for now Cognito only supports for SMS, so we will say it is 'SMS_MFA'\n                // if it does not exist, then it should be NOMFA\n                var MFAOptions = data.MFAOptions;\n                if (MFAOptions) {\n                    ret = 'SMS_MFA';\n                }\n                else {\n                    ret = 'NOMFA';\n                }\n            }\n            else if (mfaList.length === 0) {\n                ret = 'NOMFA';\n            }\n            else {\n                logger.debug('invalid case for getPreferredMFA', data);\n            }\n        }\n        return ret;\n    };\n    AuthClass.prototype._getUserData = function (user, params) {\n        var _this = this;\n        return new Promise(function (res, rej) {\n            user.getUserData(function (err, data) { return __awaiter(_this, void 0, void 0, function () {\n                var cleanUpError_2;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!err) return [3 /*break*/, 5];\n                            logger.debug('getting user data failed', err);\n                            if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                        case 2:\n                            _a.sent();\n                            return [3 /*break*/, 4];\n                        case 3:\n                            cleanUpError_2 = _a.sent();\n                            rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_2.message));\n                            return [2 /*return*/];\n                        case 4:\n                            rej(err);\n                            return [2 /*return*/];\n                        case 5:\n                            res(data);\n                            _a.label = 6;\n                        case 6: return [2 /*return*/];\n                    }\n                });\n            }); }, params);\n        });\n    };\n    /**\n     * set preferred MFA method\n     * @param {CognitoUser} user - the current Cognito user\n     * @param {string} mfaMethod - preferred mfa method\n     * @return - A promise resolve if success\n     */\n    AuthClass.prototype.setPreferredMFA = function (user, mfaMethod) {\n        return __awaiter(this, void 0, void 0, function () {\n            var clientMetadata, userData, smsMfaSettings, totpMfaSettings, _a, mfaList, currentMFAType, that;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        clientMetadata = this._config.clientMetadata;\n                        return [4 /*yield*/, this._getUserData(user, {\n                                bypassCache: true,\n                                clientMetadata: clientMetadata,\n                            })];\n                    case 1:\n                        userData = _b.sent();\n                        smsMfaSettings = null;\n                        totpMfaSettings = null;\n                        _a = mfaMethod;\n                        switch (_a) {\n                            case 'TOTP': return [3 /*break*/, 2];\n                            case 'SOFTWARE_TOKEN_MFA': return [3 /*break*/, 2];\n                            case 'SMS': return [3 /*break*/, 3];\n                            case 'SMS_MFA': return [3 /*break*/, 3];\n                            case 'NOMFA': return [3 /*break*/, 4];\n                        }\n                        return [3 /*break*/, 6];\n                    case 2:\n                        totpMfaSettings = {\n                            PreferredMfa: true,\n                            Enabled: true,\n                        };\n                        return [3 /*break*/, 7];\n                    case 3:\n                        smsMfaSettings = {\n                            PreferredMfa: true,\n                            Enabled: true,\n                        };\n                        return [3 /*break*/, 7];\n                    case 4:\n                        mfaList = userData['UserMFASettingList'];\n                        return [4 /*yield*/, this._getMfaTypeFromUserData(userData)];\n                    case 5:\n                        currentMFAType = _b.sent();\n                        if (currentMFAType === 'NOMFA') {\n                            return [2 /*return*/, Promise.resolve('No change for mfa type')];\n                        }\n                        else if (currentMFAType === 'SMS_MFA') {\n                            smsMfaSettings = {\n                                PreferredMfa: false,\n                                Enabled: false,\n                            };\n                        }\n                        else if (currentMFAType === 'SOFTWARE_TOKEN_MFA') {\n                            totpMfaSettings = {\n                                PreferredMfa: false,\n                                Enabled: false,\n                            };\n                        }\n                        else {\n                            return [2 /*return*/, this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.InvalidMFA)];\n                        }\n                        // if there is a UserMFASettingList in the response\n                        // we need to disable every mfa type in that list\n                        if (mfaList && mfaList.length !== 0) {\n                            // to disable SMS or TOTP if exists in that list\n                            mfaList.forEach(function (mfaType) {\n                                if (mfaType === 'SMS_MFA') {\n                                    smsMfaSettings = {\n                                        PreferredMfa: false,\n                                        Enabled: false,\n                                    };\n                                }\n                                else if (mfaType === 'SOFTWARE_TOKEN_MFA') {\n                                    totpMfaSettings = {\n                                        PreferredMfa: false,\n                                        Enabled: false,\n                                    };\n                                }\n                            });\n                        }\n                        return [3 /*break*/, 7];\n                    case 6:\n                        logger.debug('no validmfa method provided');\n                        return [2 /*return*/, this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NoMFA)];\n                    case 7:\n                        that = this;\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                user.setUserMfaPreference(smsMfaSettings, totpMfaSettings, function (err, result) {\n                                    if (err) {\n                                        logger.debug('Set user mfa preference error', err);\n                                        return rej(err);\n                                    }\n                                    logger.debug('Set user mfa success', result);\n                                    logger.debug('Caching the latest user data into local');\n                                    // cache the latest result into user data\n                                    user.getUserData(function (err, data) { return __awaiter(_this, void 0, void 0, function () {\n                                        var cleanUpError_3;\n                                        return __generator(this, function (_a) {\n                                            switch (_a.label) {\n                                                case 0:\n                                                    if (!err) return [3 /*break*/, 5];\n                                                    logger.debug('getting user data failed', err);\n                                                    if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                                                    _a.label = 1;\n                                                case 1:\n                                                    _a.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                                                case 2:\n                                                    _a.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    cleanUpError_3 = _a.sent();\n                                                    rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_3.message));\n                                                    return [2 /*return*/];\n                                                case 4: return [2 /*return*/, rej(err)];\n                                                case 5: return [2 /*return*/, res(result)];\n                                            }\n                                        });\n                                    }); }, {\n                                        bypassCache: true,\n                                        clientMetadata: clientMetadata,\n                                    });\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    /**\n     * disable SMS\n     * @deprecated\n     * @param {CognitoUser} user - the current user\n     * @return - A promise resolves is success\n     */\n    AuthClass.prototype.disableSMS = function (user) {\n        return new Promise(function (res, rej) {\n            user.disableMFA(function (err, data) {\n                if (err) {\n                    logger.debug('disable mfa failed', err);\n                    rej(err);\n                    return;\n                }\n                logger.debug('disable mfa succeed', data);\n                res(data);\n                return;\n            });\n        });\n    };\n    /**\n     * enable SMS\n     * @deprecated\n     * @param {CognitoUser} user - the current user\n     * @return - A promise resolves is success\n     */\n    AuthClass.prototype.enableSMS = function (user) {\n        return new Promise(function (res, rej) {\n            user.enableMFA(function (err, data) {\n                if (err) {\n                    logger.debug('enable mfa failed', err);\n                    rej(err);\n                    return;\n                }\n                logger.debug('enable mfa succeed', data);\n                res(data);\n                return;\n            });\n        });\n    };\n    /**\n     * Setup TOTP\n     * @param {CognitoUser} user - the current user\n     * @return - A promise resolves with the secret code if success\n     */\n    AuthClass.prototype.setupTOTP = function (user) {\n        return new Promise(function (res, rej) {\n            user.associateSoftwareToken({\n                onFailure: function (err) {\n                    logger.debug('associateSoftwareToken failed', err);\n                    rej(err);\n                    return;\n                },\n                associateSecretCode: function (secretCode) {\n                    logger.debug('associateSoftwareToken sucess', secretCode);\n                    res(secretCode);\n                    return;\n                },\n            });\n        });\n    };\n    /**\n     * verify TOTP setup\n     * @param {CognitoUser} user - the current user\n     * @param {string} challengeAnswer - challenge answer\n     * @return - A promise resolves is success\n     */\n    AuthClass.prototype.verifyTotpToken = function (user, challengeAnswer) {\n        logger.debug('verification totp token', user, challengeAnswer);\n        return new Promise(function (res, rej) {\n            user.verifySoftwareToken(challengeAnswer, 'My TOTP device', {\n                onFailure: function (err) {\n                    logger.debug('verifyTotpToken failed', err);\n                    rej(err);\n                    return;\n                },\n                onSuccess: function (data) {\n                    dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n                    logger.debug('verifyTotpToken success', data);\n                    res(data);\n                    return;\n                },\n            });\n        });\n    };\n    /**\n     * Send MFA code to confirm sign in\n     * @param {Object} user - The CognitoUser object\n     * @param {String} code - The confirmation code\n     */\n    AuthClass.prototype.confirmSignIn = function (user, code, mfaType, clientMetadata) {\n        var _this = this;\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!code) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyCode);\n        }\n        var that = this;\n        return new Promise(function (resolve, reject) {\n            user.sendMFACode(code, {\n                onSuccess: function (session) { return __awaiter(_this, void 0, void 0, function () {\n                    var cred, e_3;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                logger.debug(session);\n                                _a.label = 1;\n                            case 1:\n                                _a.trys.push([1, 4, 5, 6]);\n                                return [4 /*yield*/, this.Credentials.clear()];\n                            case 2:\n                                _a.sent();\n                                return [4 /*yield*/, this.Credentials.set(session, 'session')];\n                            case 3:\n                                cred = _a.sent();\n                                logger.debug('succeed to get cognito credentials', cred);\n                                return [3 /*break*/, 6];\n                            case 4:\n                                e_3 = _a.sent();\n                                logger.debug('cannot get cognito credentials', e_3);\n                                return [3 /*break*/, 6];\n                            case 5:\n                                that.user = user;\n                                dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n                                resolve(user);\n                                return [7 /*endfinally*/];\n                            case 6: return [2 /*return*/];\n                        }\n                    });\n                }); },\n                onFailure: function (err) {\n                    logger.debug('confirm signIn failure', err);\n                    reject(err);\n                },\n            }, mfaType, clientMetadata);\n        });\n    };\n    AuthClass.prototype.completeNewPassword = function (user, password, requiredAttributes, clientMetadata) {\n        var _this = this;\n        if (requiredAttributes === void 0) { requiredAttributes = {}; }\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!password) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyPassword);\n        }\n        var that = this;\n        return new Promise(function (resolve, reject) {\n            user.completeNewPasswordChallenge(password, requiredAttributes, {\n                onSuccess: function (session) { return __awaiter(_this, void 0, void 0, function () {\n                    var cred, e_4;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                logger.debug(session);\n                                _a.label = 1;\n                            case 1:\n                                _a.trys.push([1, 4, 5, 6]);\n                                return [4 /*yield*/, this.Credentials.clear()];\n                            case 2:\n                                _a.sent();\n                                return [4 /*yield*/, this.Credentials.set(session, 'session')];\n                            case 3:\n                                cred = _a.sent();\n                                logger.debug('succeed to get cognito credentials', cred);\n                                return [3 /*break*/, 6];\n                            case 4:\n                                e_4 = _a.sent();\n                                logger.debug('cannot get cognito credentials', e_4);\n                                return [3 /*break*/, 6];\n                            case 5:\n                                that.user = user;\n                                dispatchAuthEvent('signIn', user, \"A user \" + user.getUsername() + \" has been signed in\");\n                                resolve(user);\n                                return [7 /*endfinally*/];\n                            case 6: return [2 /*return*/];\n                        }\n                    });\n                }); },\n                onFailure: function (err) {\n                    logger.debug('completeNewPassword failure', err);\n                    dispatchAuthEvent('completeNewPassword_failure', err, _this.user + \" failed to complete the new password flow\");\n                    reject(err);\n                },\n                mfaRequired: function (challengeName, challengeParam) {\n                    logger.debug('signIn MFA required');\n                    user['challengeName'] = challengeName;\n                    user['challengeParam'] = challengeParam;\n                    resolve(user);\n                },\n                mfaSetup: function (challengeName, challengeParam) {\n                    logger.debug('signIn mfa setup', challengeName);\n                    user['challengeName'] = challengeName;\n                    user['challengeParam'] = challengeParam;\n                    resolve(user);\n                },\n                totpRequired: function (challengeName, challengeParam) {\n                    logger.debug('signIn mfa setup', challengeName);\n                    user['challengeName'] = challengeName;\n                    user['challengeParam'] = challengeParam;\n                    resolve(user);\n                },\n            }, clientMetadata);\n        });\n    };\n    /**\n     * Send the answer to a custom challenge\n     * @param {CognitoUser} user - The CognitoUser object\n     * @param {String} challengeResponses - The confirmation code\n     */\n    AuthClass.prototype.sendCustomChallengeAnswer = function (user, challengeResponses, clientMetadata) {\n        var _this = this;\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        if (!challengeResponses) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyChallengeResponse);\n        }\n        var that = this;\n        return new Promise(function (resolve, reject) {\n            user.sendCustomChallengeAnswer(challengeResponses, _this.authCallbacks(user, resolve, reject), clientMetadata);\n        });\n    };\n    /**\n     * Delete an authenticated users' attributes\n     * @param {CognitoUser} - The currently logged in user object\n     * @return {Promise}\n     **/\n    AuthClass.prototype.deleteUserAttributes = function (user, attributeNames) {\n        var that = this;\n        return new Promise(function (resolve, reject) {\n            that.userSession(user).then(function (session) {\n                user.deleteAttributes(attributeNames, function (err, result) {\n                    if (err) {\n                        return reject(err);\n                    }\n                    else {\n                        return resolve(result);\n                    }\n                });\n            });\n        });\n    };\n    /**\n     * Delete the current authenticated user\n     * @return {Promise}\n     **/\n    // TODO: Check return type void\n    AuthClass.prototype.deleteUser = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_5, isSignedInHostedUI;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_5 = _a.sent();\n                        logger.debug('Failed to sync cache info into memory', e_5);\n                        throw new Error(e_5);\n                    case 3:\n                        isSignedInHostedUI = this._oAuthHandler &&\n                            this._storage.getItem('amplify-signin-with-hostedUI') === 'true';\n                        return [2 /*return*/, new Promise(function (res, rej) { return __awaiter(_this, void 0, void 0, function () {\n                                var user_1;\n                                var _this = this;\n                                return __generator(this, function (_a) {\n                                    if (this.userPool) {\n                                        user_1 = this.userPool.getCurrentUser();\n                                        if (!user_1) {\n                                            logger.debug('Failed to get user from user pool');\n                                            return [2 /*return*/, rej(new Error('No current user.'))];\n                                        }\n                                        else {\n                                            user_1.getSession(function (err, session) { return __awaiter(_this, void 0, void 0, function () {\n                                                var cleanUpError_4;\n                                                var _this = this;\n                                                return __generator(this, function (_a) {\n                                                    switch (_a.label) {\n                                                        case 0:\n                                                            if (!err) return [3 /*break*/, 5];\n                                                            logger.debug('Failed to get the user session', err);\n                                                            if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                                                            _a.label = 1;\n                                                        case 1:\n                                                            _a.trys.push([1, 3, , 4]);\n                                                            return [4 /*yield*/, this.cleanUpInvalidSession(user_1)];\n                                                        case 2:\n                                                            _a.sent();\n                                                            return [3 /*break*/, 4];\n                                                        case 3:\n                                                            cleanUpError_4 = _a.sent();\n                                                            rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_4.message));\n                                                            return [2 /*return*/];\n                                                        case 4: return [2 /*return*/, rej(err)];\n                                                        case 5:\n                                                            user_1.deleteUser(function (err, result) {\n                                                                if (err) {\n                                                                    rej(err);\n                                                                }\n                                                                else {\n                                                                    dispatchAuthEvent('userDeleted', result, 'The authenticated user has been deleted.');\n                                                                    user_1.signOut();\n                                                                    _this.user = null;\n                                                                    try {\n                                                                        _this.cleanCachedItems(); // clean aws credentials\n                                                                    }\n                                                                    catch (e) {\n                                                                        // TODO: change to rejects in refactor\n                                                                        logger.debug('failed to clear cached items');\n                                                                    }\n                                                                    if (isSignedInHostedUI) {\n                                                                        _this.oAuthSignOutRedirect(res, rej);\n                                                                    }\n                                                                    else {\n                                                                        dispatchAuthEvent('signOut', _this.user, \"A user has been signed out\");\n                                                                        res(result);\n                                                                    }\n                                                                }\n                                                            });\n                                                            _a.label = 6;\n                                                        case 6: return [2 /*return*/];\n                                                    }\n                                                });\n                                            }); });\n                                        }\n                                    }\n                                    else {\n                                        logger.debug('no Congito User pool');\n                                        rej(new Error('Cognito User pool does not exist'));\n                                    }\n                                    return [2 /*return*/];\n                                });\n                            }); })];\n                }\n            });\n        });\n    };\n    /**\n     * Update an authenticated users' attributes\n     * @param {CognitoUser} - The currently logged in user object\n     * @return {Promise}\n     **/\n    AuthClass.prototype.updateUserAttributes = function (user, attributes, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        var attributeList = [];\n        var that = this;\n        return new Promise(function (resolve, reject) {\n            that.userSession(user).then(function (session) {\n                for (var key in attributes) {\n                    if (key !== 'sub' && key.indexOf('_verified') < 0) {\n                        var attr = {\n                            Name: key,\n                            Value: attributes[key],\n                        };\n                        attributeList.push(attr);\n                    }\n                }\n                user.updateAttributes(attributeList, function (err, result) {\n                    if (err) {\n                        return reject(err);\n                    }\n                    else {\n                        return resolve(result);\n                    }\n                }, clientMetadata);\n            });\n        });\n    };\n    /**\n     * Return user attributes\n     * @param {Object} user - The CognitoUser object\n     * @return - A promise resolves to user attributes if success\n     */\n    AuthClass.prototype.userAttributes = function (user) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.userSession(user).then(function (session) {\n                user.getUserAttributes(function (err, attributes) {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(attributes);\n                    }\n                });\n            });\n        });\n    };\n    AuthClass.prototype.verifiedContact = function (user) {\n        var that = this;\n        return this.userAttributes(user).then(function (attributes) {\n            var attrs = that.attributesToObject(attributes);\n            var unverified = {};\n            var verified = {};\n            if (attrs['email']) {\n                if (attrs['email_verified']) {\n                    verified['email'] = attrs['email'];\n                }\n                else {\n                    unverified['email'] = attrs['email'];\n                }\n            }\n            if (attrs['phone_number']) {\n                if (attrs['phone_number_verified']) {\n                    verified['phone_number'] = attrs['phone_number'];\n                }\n                else {\n                    unverified['phone_number'] = attrs['phone_number'];\n                }\n            }\n            return {\n                verified: verified,\n                unverified: unverified,\n            };\n        });\n    };\n    AuthClass.prototype.isErrorWithMessage = function (err) {\n        return (typeof err === 'object' &&\n            Object.prototype.hasOwnProperty.call(err, 'message'));\n    };\n    // Session revoked by another app\n    AuthClass.prototype.isTokenRevokedError = function (err) {\n        return (this.isErrorWithMessage(err) &&\n            err.message === 'Access Token has been revoked');\n    };\n    AuthClass.prototype.isRefreshTokenRevokedError = function (err) {\n        return (this.isErrorWithMessage(err) &&\n            err.message === 'Refresh Token has been revoked');\n    };\n    AuthClass.prototype.isUserDisabledError = function (err) {\n        return this.isErrorWithMessage(err) && err.message === 'User is disabled.';\n    };\n    AuthClass.prototype.isUserDoesNotExistError = function (err) {\n        return (this.isErrorWithMessage(err) && err.message === 'User does not exist.');\n    };\n    AuthClass.prototype.isRefreshTokenExpiredError = function (err) {\n        return (this.isErrorWithMessage(err) &&\n            err.message === 'Refresh Token has expired');\n    };\n    AuthClass.prototype.isSignedInHostedUI = function () {\n        return (this._oAuthHandler &&\n            this._storage.getItem('amplify-signin-with-hostedUI') === 'true');\n    };\n    AuthClass.prototype.isSessionInvalid = function (err) {\n        return (this.isUserDisabledError(err) ||\n            this.isUserDoesNotExistError(err) ||\n            this.isTokenRevokedError(err) ||\n            this.isRefreshTokenRevokedError(err) ||\n            this.isRefreshTokenExpiredError(err));\n    };\n    AuthClass.prototype.cleanUpInvalidSession = function (user) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_6;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        user.signOut();\n                        this.user = null;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.cleanCachedItems()];\n                    case 2:\n                        _a.sent(); // clean aws credentials\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_6 = _a.sent();\n                        logger.debug('failed to clear cached items');\n                        return [3 /*break*/, 4];\n                    case 4:\n                        if (this.isSignedInHostedUI()) {\n                            return [2 /*return*/, new Promise(function (res, rej) {\n                                    _this.oAuthSignOutRedirect(res, rej);\n                                })];\n                        }\n                        else {\n                            dispatchAuthEvent('signOut', this.user, \"A user has been signed out\");\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Get current authenticated user\n     * @return - A promise resolves to current authenticated CognitoUser if success\n     */\n    AuthClass.prototype.currentUserPoolUser = function (params) {\n        var _this = this;\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        return new Promise(function (res, rej) {\n            _this._storageSync\n                .then(function () { return __awaiter(_this, void 0, void 0, function () {\n                var user, clientMetadata;\n                var _this = this;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!this.isOAuthInProgress()) return [3 /*break*/, 2];\n                            logger.debug('OAuth signIn in progress, waiting for resolution...');\n                            return [4 /*yield*/, new Promise(function (res) {\n                                    var timeoutId = setTimeout(function () {\n                                        logger.debug('OAuth signIn in progress timeout');\n                                        _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.remove('auth', hostedUISignCallback);\n                                        res();\n                                    }, OAUTH_FLOW_MS_TIMEOUT);\n                                    _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.listen('auth', hostedUISignCallback);\n                                    function hostedUISignCallback(_a) {\n                                        var payload = _a.payload;\n                                        var event = payload.event;\n                                        if (event === 'cognitoHostedUI' ||\n                                            event === 'cognitoHostedUI_failure') {\n                                            logger.debug(\"OAuth signIn resolved: \" + event);\n                                            clearTimeout(timeoutId);\n                                            _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.remove('auth', hostedUISignCallback);\n                                            res();\n                                        }\n                                    }\n                                })];\n                        case 1:\n                            _a.sent();\n                            _a.label = 2;\n                        case 2:\n                            user = this.userPool.getCurrentUser();\n                            if (!user) {\n                                logger.debug('Failed to get user from user pool');\n                                rej('No current user');\n                                return [2 /*return*/];\n                            }\n                            clientMetadata = this._config.clientMetadata;\n                            // refresh the session if the session expired.\n                            user.getSession(function (err, session) { return __awaiter(_this, void 0, void 0, function () {\n                                var cleanUpError_5, bypassCache, clientMetadata, _a, scope;\n                                var _this = this;\n                                return __generator(this, function (_b) {\n                                    switch (_b.label) {\n                                        case 0:\n                                            if (!err) return [3 /*break*/, 5];\n                                            logger.debug('Failed to get the user session', err);\n                                            if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                                            _b.label = 1;\n                                        case 1:\n                                            _b.trys.push([1, 3, , 4]);\n                                            return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                                        case 2:\n                                            _b.sent();\n                                            return [3 /*break*/, 4];\n                                        case 3:\n                                            cleanUpError_5 = _b.sent();\n                                            rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_5.message));\n                                            return [2 /*return*/];\n                                        case 4:\n                                            rej(err);\n                                            return [2 /*return*/];\n                                        case 5:\n                                            bypassCache = params ? params.bypassCache : false;\n                                            if (!bypassCache) return [3 /*break*/, 7];\n                                            return [4 /*yield*/, this.Credentials.clear()];\n                                        case 6:\n                                            _b.sent();\n                                            _b.label = 7;\n                                        case 7:\n                                            clientMetadata = this._config.clientMetadata;\n                                            _a = session.getAccessToken().decodePayload().scope, scope = _a === void 0 ? '' : _a;\n                                            if (scope.split(' ').includes(USER_ADMIN_SCOPE)) {\n                                                user.getUserData(function (err, data) { return __awaiter(_this, void 0, void 0, function () {\n                                                    var cleanUpError_6, preferredMFA, attributeList, i, attribute, userAttribute, attributes;\n                                                    return __generator(this, function (_a) {\n                                                        switch (_a.label) {\n                                                            case 0:\n                                                                if (!err) return [3 /*break*/, 7];\n                                                                logger.debug('getting user data failed', err);\n                                                                if (!this.isSessionInvalid(err)) return [3 /*break*/, 5];\n                                                                _a.label = 1;\n                                                            case 1:\n                                                                _a.trys.push([1, 3, , 4]);\n                                                                return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                                                            case 2:\n                                                                _a.sent();\n                                                                return [3 /*break*/, 4];\n                                                            case 3:\n                                                                cleanUpError_6 = _a.sent();\n                                                                rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_6.message));\n                                                                return [2 /*return*/];\n                                                            case 4:\n                                                                rej(err);\n                                                                return [3 /*break*/, 6];\n                                                            case 5:\n                                                                res(user);\n                                                                _a.label = 6;\n                                                            case 6: return [2 /*return*/];\n                                                            case 7:\n                                                                preferredMFA = data.PreferredMfaSetting || 'NOMFA';\n                                                                attributeList = [];\n                                                                for (i = 0; i < data.UserAttributes.length; i++) {\n                                                                    attribute = {\n                                                                        Name: data.UserAttributes[i].Name,\n                                                                        Value: data.UserAttributes[i].Value,\n                                                                    };\n                                                                    userAttribute = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserAttribute(attribute);\n                                                                    attributeList.push(userAttribute);\n                                                                }\n                                                                attributes = this.attributesToObject(attributeList);\n                                                                Object.assign(user, { attributes: attributes, preferredMFA: preferredMFA });\n                                                                return [2 /*return*/, res(user)];\n                                                        }\n                                                    });\n                                                }); }, { bypassCache: bypassCache, clientMetadata: clientMetadata });\n                                            }\n                                            else {\n                                                logger.debug(\"Unable to get the user data because the \" + USER_ADMIN_SCOPE + \" \" +\n                                                    \"is not in the scopes of the access token\");\n                                                return [2 /*return*/, res(user)];\n                                            }\n                                            return [2 /*return*/];\n                                    }\n                                });\n                            }); }, { clientMetadata: clientMetadata });\n                            return [2 /*return*/];\n                    }\n                });\n            }); })\n                .catch(function (e) {\n                logger.debug('Failed to sync cache info into memory', e);\n                return rej(e);\n            });\n        });\n    };\n    AuthClass.prototype.isOAuthInProgress = function () {\n        return this.oAuthFlowInProgress;\n    };\n    /**\n     * Get current authenticated user\n     * @param {CurrentUserOpts} - options for getting the current user\n     * @return - A promise resolves to current authenticated CognitoUser if success\n     */\n    AuthClass.prototype.currentAuthenticatedUser = function (params) {\n        return __awaiter(this, void 0, void 0, function () {\n            var federatedUser, e_7, federatedInfo, user, e_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        logger.debug('getting current authenticated user');\n                        federatedUser = null;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_7 = _a.sent();\n                        logger.debug('Failed to sync cache info into memory', e_7);\n                        throw e_7;\n                    case 4:\n                        try {\n                            federatedInfo = JSON.parse(this._storage.getItem('aws-amplify-federatedInfo'));\n                            if (federatedInfo) {\n                                federatedUser = __assign(__assign({}, federatedInfo.user), { token: federatedInfo.token });\n                            }\n                        }\n                        catch (e) {\n                            logger.debug('cannot load federated user from auth storage');\n                        }\n                        if (!federatedUser) return [3 /*break*/, 5];\n                        this.user = federatedUser;\n                        logger.debug('get current authenticated federated user', this.user);\n                        return [2 /*return*/, this.user];\n                    case 5:\n                        logger.debug('get current authenticated userpool user');\n                        user = null;\n                        _a.label = 6;\n                    case 6:\n                        _a.trys.push([6, 8, , 9]);\n                        return [4 /*yield*/, this.currentUserPoolUser(params)];\n                    case 7:\n                        user = _a.sent();\n                        return [3 /*break*/, 9];\n                    case 8:\n                        e_8 = _a.sent();\n                        if (e_8 === 'No userPool') {\n                            logger.error('Cannot get the current user because the user pool is missing. ' +\n                                'Please make sure the Auth module is configured with a valid Cognito User Pool ID');\n                        }\n                        logger.debug('The user is not authenticated by the error', e_8);\n                        return [2 /*return*/, Promise.reject('The user is not authenticated')];\n                    case 9:\n                        this.user = user;\n                        return [2 /*return*/, this.user];\n                }\n            });\n        });\n    };\n    /**\n     * Get current user's session\n     * @return - A promise resolves to session object if success\n     */\n    AuthClass.prototype.currentSession = function () {\n        var that = this;\n        logger.debug('Getting current session');\n        // Purposely not calling the reject method here because we don't need a console error\n        if (!this.userPool) {\n            return Promise.reject(new Error('No User Pool in the configuration.'));\n        }\n        return new Promise(function (res, rej) {\n            that\n                .currentUserPoolUser()\n                .then(function (user) {\n                that\n                    .userSession(user)\n                    .then(function (session) {\n                    res(session);\n                    return;\n                })\n                    .catch(function (e) {\n                    logger.debug('Failed to get the current session', e);\n                    rej(e);\n                    return;\n                });\n            })\n                .catch(function (e) {\n                logger.debug('Failed to get the current user', e);\n                rej(e);\n                return;\n            });\n        });\n    };\n    /**\n     * Get the corresponding user session\n     * @param {Object} user - The CognitoUser object\n     * @return - A promise resolves to the session\n     */\n    AuthClass.prototype.userSession = function (user) {\n        var _this = this;\n        if (!user) {\n            logger.debug('the user is null');\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NoUserSession);\n        }\n        var clientMetadata = this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n        return new Promise(function (res, rej) {\n            logger.debug('Getting the session from this user:', user);\n            user.getSession(function (err, session) { return __awaiter(_this, void 0, void 0, function () {\n                var cleanUpError_7;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!err) return [3 /*break*/, 5];\n                            logger.debug('Failed to get the session from user', user);\n                            if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                        case 2:\n                            _a.sent();\n                            return [3 /*break*/, 4];\n                        case 3:\n                            cleanUpError_7 = _a.sent();\n                            rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_7.message));\n                            return [2 /*return*/];\n                        case 4:\n                            rej(err);\n                            return [2 /*return*/];\n                        case 5:\n                            logger.debug('Succeed to get the user session', session);\n                            res(session);\n                            return [2 /*return*/];\n                    }\n                });\n            }); }, { clientMetadata: clientMetadata });\n        });\n    };\n    /**\n     * Get authenticated credentials of current user.\n     * @return - A promise resolves to be current user's credentials\n     */\n    AuthClass.prototype.currentUserCredentials = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_9, federatedInfo;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        logger.debug('Getting current user credentials');\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_9 = _a.sent();\n                        logger.debug('Failed to sync cache info into memory', e_9);\n                        throw e_9;\n                    case 4:\n                        federatedInfo = null;\n                        try {\n                            federatedInfo = JSON.parse(this._storage.getItem('aws-amplify-federatedInfo'));\n                        }\n                        catch (e) {\n                            logger.debug('failed to get or parse item aws-amplify-federatedInfo', e);\n                        }\n                        if (federatedInfo) {\n                            // refresh the jwt token here if necessary\n                            return [2 /*return*/, this.Credentials.refreshFederatedToken(federatedInfo)];\n                        }\n                        else {\n                            return [2 /*return*/, this.currentSession()\n                                    .then(function (session) {\n                                    logger.debug('getting session success', session);\n                                    return _this.Credentials.set(session, 'session');\n                                })\n                                    .catch(function () {\n                                    logger.debug('getting guest credentials');\n                                    return _this.Credentials.set(null, 'guest');\n                                })];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.currentCredentials = function () {\n        logger.debug('getting current credentials');\n        return this.Credentials.get();\n    };\n    /**\n     * Initiate an attribute confirmation request\n     * @param {Object} user - The CognitoUser\n     * @param {Object} attr - The attributes to be verified\n     * @return - A promise resolves to callback data if success\n     */\n    AuthClass.prototype.verifyUserAttribute = function (user, attr, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        return new Promise(function (resolve, reject) {\n            user.getAttributeVerificationCode(attr, {\n                onSuccess: function (success) {\n                    return resolve(success);\n                },\n                onFailure: function (err) {\n                    return reject(err);\n                },\n            }, clientMetadata);\n        });\n    };\n    /**\n     * Confirm an attribute using a confirmation code\n     * @param {Object} user - The CognitoUser\n     * @param {Object} attr - The attribute to be verified\n     * @param {String} code - The confirmation code\n     * @return - A promise resolves to callback data if success\n     */\n    AuthClass.prototype.verifyUserAttributeSubmit = function (user, attr, code) {\n        if (!code) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyCode);\n        }\n        return new Promise(function (resolve, reject) {\n            user.verifyAttribute(attr, code, {\n                onSuccess: function (data) {\n                    resolve(data);\n                    return;\n                },\n                onFailure: function (err) {\n                    reject(err);\n                    return;\n                },\n            });\n        });\n    };\n    AuthClass.prototype.verifyCurrentUserAttribute = function (attr) {\n        var that = this;\n        return that\n            .currentUserPoolUser()\n            .then(function (user) { return that.verifyUserAttribute(user, attr); });\n    };\n    /**\n     * Confirm current user's attribute using a confirmation code\n     * @param {Object} attr - The attribute to be verified\n     * @param {String} code - The confirmation code\n     * @return - A promise resolves to callback data if success\n     */\n    AuthClass.prototype.verifyCurrentUserAttributeSubmit = function (attr, code) {\n        var that = this;\n        return that\n            .currentUserPoolUser()\n            .then(function (user) { return that.verifyUserAttributeSubmit(user, attr, code); });\n    };\n    AuthClass.prototype.cognitoIdentitySignOut = function (opts, user) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_10, isSignedInHostedUI;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_10 = _a.sent();\n                        logger.debug('Failed to sync cache info into memory', e_10);\n                        throw e_10;\n                    case 3:\n                        isSignedInHostedUI = this._oAuthHandler &&\n                            this._storage.getItem('amplify-signin-with-hostedUI') === 'true';\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                if (opts && opts.global) {\n                                    logger.debug('user global sign out', user);\n                                    // in order to use global signout\n                                    // we must validate the user as an authenticated user by using getSession\n                                    var clientMetadata = _this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n                                    user.getSession(function (err, result) { return __awaiter(_this, void 0, void 0, function () {\n                                        var cleanUpError_8;\n                                        var _this = this;\n                                        return __generator(this, function (_a) {\n                                            switch (_a.label) {\n                                                case 0:\n                                                    if (!err) return [3 /*break*/, 5];\n                                                    logger.debug('failed to get the user session', err);\n                                                    if (!this.isSessionInvalid(err)) return [3 /*break*/, 4];\n                                                    _a.label = 1;\n                                                case 1:\n                                                    _a.trys.push([1, 3, , 4]);\n                                                    return [4 /*yield*/, this.cleanUpInvalidSession(user)];\n                                                case 2:\n                                                    _a.sent();\n                                                    return [3 /*break*/, 4];\n                                                case 3:\n                                                    cleanUpError_8 = _a.sent();\n                                                    rej(new Error(\"Session is invalid due to: \" + err.message + \" and failed to clean up invalid session: \" + cleanUpError_8.message));\n                                                    return [2 /*return*/];\n                                                case 4: return [2 /*return*/, rej(err)];\n                                                case 5:\n                                                    user.globalSignOut({\n                                                        onSuccess: function (data) {\n                                                            logger.debug('global sign out success');\n                                                            if (isSignedInHostedUI) {\n                                                                _this.oAuthSignOutRedirect(res, rej);\n                                                            }\n                                                            else {\n                                                                return res();\n                                                            }\n                                                        },\n                                                        onFailure: function (err) {\n                                                            logger.debug('global sign out failed', err);\n                                                            return rej(err);\n                                                        },\n                                                    });\n                                                    return [2 /*return*/];\n                                            }\n                                        });\n                                    }); }, { clientMetadata: clientMetadata });\n                                }\n                                else {\n                                    logger.debug('user sign out', user);\n                                    user.signOut(function () {\n                                        if (isSignedInHostedUI) {\n                                            _this.oAuthSignOutRedirect(res, rej);\n                                        }\n                                        else {\n                                            return res();\n                                        }\n                                    });\n                                }\n                            })];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.oAuthSignOutRedirect = function (resolve, reject) {\n        var isBrowser = (0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_11__.browserOrNode)().isBrowser;\n        if (isBrowser) {\n            this.oAuthSignOutRedirectOrReject(reject);\n        }\n        else {\n            this.oAuthSignOutAndResolve(resolve);\n        }\n    };\n    AuthClass.prototype.oAuthSignOutAndResolve = function (resolve) {\n        this._oAuthHandler.signOut();\n        resolve();\n    };\n    AuthClass.prototype.oAuthSignOutRedirectOrReject = function (reject) {\n        this._oAuthHandler.signOut(); // this method redirects url\n        // App should be redirected to another url otherwise it will reject\n        setTimeout(function () { return reject(Error('Signout timeout fail')); }, 3000);\n    };\n    /**\n     * Sign out method\n     * @\n     * @return - A promise resolved if success\n     */\n    AuthClass.prototype.signOut = function (opts) {\n        return __awaiter(this, void 0, void 0, function () {\n            var e_11, user;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.cleanCachedItems()];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        e_11 = _a.sent();\n                        logger.debug('failed to clear cached items');\n                        return [3 /*break*/, 3];\n                    case 3:\n                        if (!this.userPool) return [3 /*break*/, 7];\n                        user = this.userPool.getCurrentUser();\n                        if (!user) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.cognitoIdentitySignOut(opts, user)];\n                    case 4:\n                        _a.sent();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        logger.debug('no current Cognito user');\n                        _a.label = 6;\n                    case 6: return [3 /*break*/, 8];\n                    case 7:\n                        logger.debug('no Cognito User pool');\n                        _a.label = 8;\n                    case 8:\n                        /**\n                         * Note for future refactor - no reliable way to get username with\n                         * Cognito User Pools vs Identity when federating with Social Providers\n                         * This is why we need a well structured session object that can be inspected\n                         * and information passed back in the message below for Hub dispatch\n                         */\n                        dispatchAuthEvent('signOut', this.user, \"A user has been signed out\");\n                        this.user = null;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.cleanCachedItems = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: \n                    // clear cognito cached item\n                    return [4 /*yield*/, this.Credentials.clear()];\n                    case 1:\n                        // clear cognito cached item\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Change a password for an authenticated user\n     * @param {Object} user - The CognitoUser object\n     * @param {String} oldPassword - the current password\n     * @param {String} newPassword - the requested new password\n     * @return - A promise resolves if success\n     */\n    AuthClass.prototype.changePassword = function (user, oldPassword, newPassword, clientMetadata) {\n        var _this = this;\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        return new Promise(function (resolve, reject) {\n            _this.userSession(user).then(function (session) {\n                user.changePassword(oldPassword, newPassword, function (err, data) {\n                    if (err) {\n                        logger.debug('change password failure', err);\n                        return reject(err);\n                    }\n                    else {\n                        return resolve(data);\n                    }\n                }, clientMetadata);\n            });\n        });\n    };\n    /**\n     * Initiate a forgot password request\n     * @param {String} username - the username to change password\n     * @return - A promise resolves if success\n     */\n    AuthClass.prototype.forgotPassword = function (username, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        var user = this.createCognitoUser(username);\n        return new Promise(function (resolve, reject) {\n            user.forgotPassword({\n                onSuccess: function () {\n                    resolve();\n                    return;\n                },\n                onFailure: function (err) {\n                    logger.debug('forgot password failure', err);\n                    dispatchAuthEvent('forgotPassword_failure', err, username + \" forgotPassword failed\");\n                    reject(err);\n                    return;\n                },\n                inputVerificationCode: function (data) {\n                    dispatchAuthEvent('forgotPassword', user, username + \" has initiated forgot password flow\");\n                    resolve(data);\n                    return;\n                },\n            }, clientMetadata);\n        });\n    };\n    /**\n     * Confirm a new password using a confirmation Code\n     * @param {String} username - The username\n     * @param {String} code - The confirmation code\n     * @param {String} password - The new password\n     * @return - A promise that resolves if success\n     */\n    AuthClass.prototype.forgotPasswordSubmit = function (username, code, password, clientMetadata) {\n        if (clientMetadata === void 0) { clientMetadata = this._config.clientMetadata; }\n        if (!this.userPool) {\n            return this.rejectNoUserPool();\n        }\n        if (!username) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyUsername);\n        }\n        if (!code) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyCode);\n        }\n        if (!password) {\n            return this.rejectAuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.EmptyPassword);\n        }\n        var user = this.createCognitoUser(username);\n        return new Promise(function (resolve, reject) {\n            user.confirmPassword(code, password, {\n                onSuccess: function (success) {\n                    dispatchAuthEvent('forgotPasswordSubmit', user, username + \" forgotPasswordSubmit successful\");\n                    resolve(success);\n                    return;\n                },\n                onFailure: function (err) {\n                    dispatchAuthEvent('forgotPasswordSubmit_failure', err, username + \" forgotPasswordSubmit failed\");\n                    reject(err);\n                    return;\n                },\n            }, clientMetadata);\n        });\n    };\n    /**\n     * Get user information\n     * @async\n     * @return {Object }- current User's information\n     */\n    AuthClass.prototype.currentUserInfo = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var source, user, attributes, userAttrs, credentials, e_12, info, err_1, user;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        source = this.Credentials.getCredSource();\n                        if (!(!source || source === 'aws' || source === 'userPool')) return [3 /*break*/, 9];\n                        return [4 /*yield*/, this.currentUserPoolUser().catch(function (err) {\n                                return logger.error(err);\n                            })];\n                    case 1:\n                        user = _a.sent();\n                        if (!user) {\n                            return [2 /*return*/, null];\n                        }\n                        _a.label = 2;\n                    case 2:\n                        _a.trys.push([2, 8, , 9]);\n                        return [4 /*yield*/, this.userAttributes(user)];\n                    case 3:\n                        attributes = _a.sent();\n                        userAttrs = this.attributesToObject(attributes);\n                        credentials = null;\n                        _a.label = 4;\n                    case 4:\n                        _a.trys.push([4, 6, , 7]);\n                        return [4 /*yield*/, this.currentCredentials()];\n                    case 5:\n                        credentials = _a.sent();\n                        return [3 /*break*/, 7];\n                    case 6:\n                        e_12 = _a.sent();\n                        logger.debug('Failed to retrieve credentials while getting current user info', e_12);\n                        return [3 /*break*/, 7];\n                    case 7:\n                        info = {\n                            id: credentials ? credentials.identityId : undefined,\n                            username: user.getUsername(),\n                            attributes: userAttrs,\n                        };\n                        return [2 /*return*/, info];\n                    case 8:\n                        err_1 = _a.sent();\n                        logger.error('currentUserInfo error', err_1);\n                        return [2 /*return*/, {}];\n                    case 9:\n                        if (source === 'federated') {\n                            user = this.user;\n                            return [2 /*return*/, user ? user : {}];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.federatedSignIn = function (providerOrOptions, response, user) {\n        return __awaiter(this, void 0, void 0, function () {\n            var options, provider, customState, client_id, redirect_uri, provider, loggedInUser, token, identity_id, expires_at, credentials, currentUser;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this._config.identityPoolId && !this._config.userPoolId) {\n                            throw new Error(\"Federation requires either a User Pool or Identity Pool in config\");\n                        }\n                        // Ensure backwards compatability\n                        if (typeof providerOrOptions === 'undefined') {\n                            if (this._config.identityPoolId && !this._config.userPoolId) {\n                                throw new Error(\"Federation with Identity Pools requires tokens passed as arguments\");\n                            }\n                        }\n                        if (!((0,_types__WEBPACK_IMPORTED_MODULE_8__.isFederatedSignInOptions)(providerOrOptions) ||\n                            (0,_types__WEBPACK_IMPORTED_MODULE_8__.isFederatedSignInOptionsCustom)(providerOrOptions) ||\n                            (0,_types__WEBPACK_IMPORTED_MODULE_8__.hasCustomState)(providerOrOptions) ||\n                            typeof providerOrOptions === 'undefined')) return [3 /*break*/, 1];\n                        options = providerOrOptions || {\n                            provider: _types__WEBPACK_IMPORTED_MODULE_8__.CognitoHostedUIIdentityProvider.Cognito,\n                        };\n                        provider = (0,_types__WEBPACK_IMPORTED_MODULE_8__.isFederatedSignInOptions)(options)\n                            ? options.provider\n                            : options.customProvider;\n                        customState = (0,_types__WEBPACK_IMPORTED_MODULE_8__.isFederatedSignInOptions)(options)\n                            ? options.customState\n                            : options.customState;\n                        if (this._config.userPoolId) {\n                            client_id = (0,_types__WEBPACK_IMPORTED_MODULE_8__.isCognitoHostedOpts)(this._config.oauth)\n                                ? this._config.userPoolWebClientId\n                                : this._config.oauth.clientID;\n                            redirect_uri = (0,_types__WEBPACK_IMPORTED_MODULE_8__.isCognitoHostedOpts)(this._config.oauth)\n                                ? this._config.oauth.redirectSignIn\n                                : this._config.oauth.redirectUri;\n                            this._oAuthHandler.oauthSignIn(this._config.oauth.responseType, this._config.oauth.domain, redirect_uri, client_id, provider, customState);\n                        }\n                        return [3 /*break*/, 4];\n                    case 1:\n                        provider = providerOrOptions;\n                        // To check if the user is already logged in\n                        try {\n                            loggedInUser = JSON.stringify(JSON.parse(this._storage.getItem('aws-amplify-federatedInfo')).user);\n                            if (loggedInUser) {\n                                logger.warn(\"There is already a signed in user: \" + loggedInUser + \" in your app.\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tYou should not call Auth.federatedSignIn method again as it may cause unexpected behavior.\");\n                            }\n                        }\n                        catch (e) { }\n                        token = response.token, identity_id = response.identity_id, expires_at = response.expires_at;\n                        return [4 /*yield*/, this.Credentials.set({ provider: provider, token: token, identity_id: identity_id, user: user, expires_at: expires_at }, 'federation')];\n                    case 2:\n                        credentials = _a.sent();\n                        return [4 /*yield*/, this.currentAuthenticatedUser()];\n                    case 3:\n                        currentUser = _a.sent();\n                        dispatchAuthEvent('signIn', currentUser, \"A user \" + currentUser.username + \" has been signed in\");\n                        logger.debug('federated sign in credentials', credentials);\n                        return [2 /*return*/, credentials];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Used to complete the OAuth flow with or without the Cognito Hosted UI\n     * @param {String} URL - optional parameter for customers to pass in the response URL\n     */\n    AuthClass.prototype._handleAuthResponse = function (URL) {\n        return __awaiter(this, void 0, void 0, function () {\n            var currentUrl, hasCodeOrError, hasTokenOrError, _a, accessToken, idToken, refreshToken, state, session, credentials, isCustomStateIncluded, currentUser, customState, err_2;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (this.oAuthFlowInProgress) {\n                            logger.debug(\"Skipping URL \" + URL + \" current flow in progress\");\n                            return [2 /*return*/];\n                        }\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, , 8, 9]);\n                        this.oAuthFlowInProgress = true;\n                        if (!this._config.userPoolId) {\n                            throw new Error(\"OAuth responses require a User Pool defined in config\");\n                        }\n                        dispatchAuthEvent('parsingCallbackUrl', { url: URL }, \"The callback url is being parsed\");\n                        currentUrl = URL || ((0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_11__.browserOrNode)().isBrowser ? window.location.href : '');\n                        hasCodeOrError = !!((0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(currentUrl).query || '')\n                            .split('&')\n                            .map(function (entry) { return entry.split('='); })\n                            .find(function (_a) {\n                            var _b = __read(_a, 1), k = _b[0];\n                            return k === 'code' || k === 'error';\n                        });\n                        hasTokenOrError = !!((0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(currentUrl).hash || '#')\n                            .substr(1)\n                            .split('&')\n                            .map(function (entry) { return entry.split('='); })\n                            .find(function (_a) {\n                            var _b = __read(_a, 1), k = _b[0];\n                            return k === 'access_token' || k === 'error';\n                        });\n                        if (!(hasCodeOrError || hasTokenOrError)) return [3 /*break*/, 7];\n                        this._storage.setItem('amplify-redirected-from-hosted-ui', 'true');\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, 6, , 7]);\n                        return [4 /*yield*/, this._oAuthHandler.handleAuthResponse(currentUrl)];\n                    case 3:\n                        _a = _b.sent(), accessToken = _a.accessToken, idToken = _a.idToken, refreshToken = _a.refreshToken, state = _a.state;\n                        session = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUserSession({\n                            IdToken: new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoIdToken({ IdToken: idToken }),\n                            RefreshToken: new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoRefreshToken({\n                                RefreshToken: refreshToken,\n                            }),\n                            AccessToken: new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoAccessToken({\n                                AccessToken: accessToken,\n                            }),\n                        });\n                        credentials = void 0;\n                        if (!this._config.identityPoolId) return [3 /*break*/, 5];\n                        return [4 /*yield*/, this.Credentials.set(session, 'session')];\n                    case 4:\n                        credentials = _b.sent();\n                        logger.debug('AWS credentials', credentials);\n                        _b.label = 5;\n                    case 5:\n                        isCustomStateIncluded = /-/.test(state);\n                        currentUser = this.createCognitoUser(session.getIdToken().decodePayload()['cognito:username']);\n                        // This calls cacheTokens() in Cognito SDK\n                        currentUser.setSignInUserSession(session);\n                        if (window && typeof window.history !== 'undefined') {\n                            window.history.replaceState({}, null, this._config.oauth.redirectSignIn);\n                        }\n                        dispatchAuthEvent('signIn', currentUser, \"A user \" + currentUser.getUsername() + \" has been signed in\");\n                        dispatchAuthEvent('cognitoHostedUI', currentUser, \"A user \" + currentUser.getUsername() + \" has been signed in via Cognito Hosted UI\");\n                        if (isCustomStateIncluded) {\n                            customState = state.split('-').splice(1).join('-');\n                            dispatchAuthEvent('customOAuthState', (0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_12__.urlSafeDecode)(customState), \"State for user \" + currentUser.getUsername());\n                        }\n                        //#endregion\n                        return [2 /*return*/, credentials];\n                    case 6:\n                        err_2 = _b.sent();\n                        logger.debug('Error in cognito hosted auth response', err_2);\n                        // Just like a successful handling of `?code`, replace the window history to \"dispose\" of the `code`.\n                        // Otherwise, reloading the page will throw errors as the `code` has already been spent.\n                        if (window && typeof window.history !== 'undefined') {\n                            window.history.replaceState({}, null, this._config.oauth.redirectSignIn);\n                        }\n                        dispatchAuthEvent('signIn_failure', err_2, \"The OAuth response flow failed\");\n                        dispatchAuthEvent('cognitoHostedUI_failure', err_2, \"A failure occurred when returning to the Cognito Hosted UI\");\n                        dispatchAuthEvent('customState_failure', err_2, \"A failure occurred when returning state\");\n                        return [3 /*break*/, 7];\n                    case 7: return [3 /*break*/, 9];\n                    case 8:\n                        this.oAuthFlowInProgress = false;\n                        return [7 /*endfinally*/];\n                    case 9: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Compact version of credentials\n     * @param {Object} credentials\n     * @return {Object} - Credentials\n     */\n    AuthClass.prototype.essentialCredentials = function (credentials) {\n        return {\n            accessKeyId: credentials.accessKeyId,\n            sessionToken: credentials.sessionToken,\n            secretAccessKey: credentials.secretAccessKey,\n            identityId: credentials.identityId,\n            authenticated: credentials.authenticated,\n        };\n    };\n    AuthClass.prototype.attributesToObject = function (attributes) {\n        var _this = this;\n        var obj = {};\n        if (attributes) {\n            attributes.map(function (attribute) {\n                if (attribute.Name === 'email_verified' ||\n                    attribute.Name === 'phone_number_verified') {\n                    obj[attribute.Name] =\n                        _this.isTruthyString(attribute.Value) || attribute.Value === true;\n                }\n                else {\n                    obj[attribute.Name] = attribute.Value;\n                }\n            });\n        }\n        return obj;\n    };\n    AuthClass.prototype.isTruthyString = function (value) {\n        return (typeof value.toLowerCase === 'function' && value.toLowerCase() === 'true');\n    };\n    AuthClass.prototype.createCognitoUser = function (username) {\n        var userData = {\n            Username: username,\n            Pool: this.userPool,\n        };\n        userData.Storage = this._storage;\n        var authenticationFlowType = this._config.authenticationFlowType;\n        var user = new amazon_cognito_identity_js__WEBPACK_IMPORTED_MODULE_0__.CognitoUser(userData);\n        if (authenticationFlowType) {\n            user.setAuthenticationFlowType(authenticationFlowType);\n        }\n        return user;\n    };\n    AuthClass.prototype._isValidAuthStorage = function (obj) {\n        // We need to check if the obj has the functions of Storage\n        return (!!obj &&\n            typeof obj.getItem === 'function' &&\n            typeof obj.setItem === 'function' &&\n            typeof obj.removeItem === 'function' &&\n            typeof obj.clear === 'function');\n    };\n    AuthClass.prototype.noUserPoolErrorHandler = function (config) {\n        if (config) {\n            if (!config.userPoolId || !config.identityPoolId) {\n                return _types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.MissingAuthConfig;\n            }\n        }\n        return _types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NoConfig;\n    };\n    AuthClass.prototype.rejectAuthError = function (type) {\n        return Promise.reject(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(type));\n    };\n    AuthClass.prototype.rejectNoUserPool = function () {\n        var type = this.noUserPoolErrorHandler(this._config);\n        return Promise.reject(new _Errors__WEBPACK_IMPORTED_MODULE_13__.NoUserPoolError(type));\n    };\n    AuthClass.prototype.rememberDevice = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var currUser, error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.currentUserPoolUser()];\n                    case 1:\n                        currUser = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_2 = _a.sent();\n                        logger.debug('The user is not authenticated by the error', error_2);\n                        return [2 /*return*/, Promise.reject('The user is not authenticated')];\n                    case 3:\n                        currUser.getCachedDeviceKeyAndPassword();\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                currUser.setDeviceStatusRemembered({\n                                    onSuccess: function (data) {\n                                        res(data);\n                                    },\n                                    onFailure: function (err) {\n                                        if (err.code === 'InvalidParameterException') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.DeviceConfig));\n                                        }\n                                        else if (err.code === 'NetworkError') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NetworkError));\n                                        }\n                                        else {\n                                            rej(err);\n                                        }\n                                    },\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.forgetDevice = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var currUser, error_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.currentUserPoolUser()];\n                    case 1:\n                        currUser = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_3 = _a.sent();\n                        logger.debug('The user is not authenticated by the error', error_3);\n                        return [2 /*return*/, Promise.reject('The user is not authenticated')];\n                    case 3:\n                        currUser.getCachedDeviceKeyAndPassword();\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                currUser.forgetDevice({\n                                    onSuccess: function (data) {\n                                        res(data);\n                                    },\n                                    onFailure: function (err) {\n                                        if (err.code === 'InvalidParameterException') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.DeviceConfig));\n                                        }\n                                        else if (err.code === 'NetworkError') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NetworkError));\n                                        }\n                                        else {\n                                            rej(err);\n                                        }\n                                    },\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    AuthClass.prototype.fetchDevices = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var currUser, error_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.currentUserPoolUser()];\n                    case 1:\n                        currUser = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_4 = _a.sent();\n                        logger.debug('The user is not authenticated by the error', error_4);\n                        throw new Error('The user is not authenticated');\n                    case 3:\n                        currUser.getCachedDeviceKeyAndPassword();\n                        return [2 /*return*/, new Promise(function (res, rej) {\n                                var cb = {\n                                    onSuccess: function (data) {\n                                        var deviceList = data.Devices.map(function (device) {\n                                            var deviceName = device.DeviceAttributes.find(function (_a) {\n                                                var Name = _a.Name;\n                                                return Name === 'device_name';\n                                            }) || {};\n                                            var deviceInfo = {\n                                                id: device.DeviceKey,\n                                                name: deviceName.Value,\n                                            };\n                                            return deviceInfo;\n                                        });\n                                        res(deviceList);\n                                    },\n                                    onFailure: function (err) {\n                                        if (err.code === 'InvalidParameterException') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.DeviceConfig));\n                                        }\n                                        else if (err.code === 'NetworkError') {\n                                            rej(new _Errors__WEBPACK_IMPORTED_MODULE_13__.AuthError(_types__WEBPACK_IMPORTED_MODULE_8__.AuthErrorTypes.NetworkError));\n                                        }\n                                        else {\n                                            rej(err);\n                                        }\n                                    },\n                                };\n                                currUser.listDevices(MAX_DEVICES, null, cb);\n                            })];\n                }\n            });\n        });\n    };\n    return AuthClass;\n}());\n\nvar Auth = new AuthClass(null);\n_aws_amplify_core__WEBPACK_IMPORTED_MODULE_14__.Amplify.register(Auth);\n//# sourceMappingURL=Auth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9BdXRoLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1QjtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0IsNEJBQTRCLCtEQUErRCxpQkFBaUI7QUFDNUc7QUFDQSxvQ0FBb0MsTUFBTSwrQkFBK0IsWUFBWTtBQUNyRixtQ0FBbUMsTUFBTSxtQ0FBbUMsWUFBWTtBQUN4RixnQ0FBZ0M7QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQSxtQkFBbUIsU0FBSSxJQUFJLFNBQUk7QUFDL0IsY0FBYyw2QkFBNkIsMEJBQTBCLGNBQWMscUJBQXFCO0FBQ3hHLGlCQUFpQixvREFBb0QscUVBQXFFLGNBQWM7QUFDeEosdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEMsbUNBQW1DLFNBQVM7QUFDNUMsbUNBQW1DLFdBQVcsVUFBVTtBQUN4RCwwQ0FBMEMsY0FBYztBQUN4RDtBQUNBLDhHQUE4RyxPQUFPO0FBQ3JILGlGQUFpRixpQkFBaUI7QUFDbEcseURBQXlELGdCQUFnQixRQUFRO0FBQ2pGLCtDQUErQyxnQkFBZ0IsZ0JBQWdCO0FBQy9FO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQSxVQUFVLFlBQVksYUFBYSxTQUFTLFVBQVU7QUFDdEQsb0NBQW9DLFNBQVM7QUFDN0M7QUFDQTtBQUNBLGNBQWMsU0FBSSxJQUFJLFNBQUk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ2lKO0FBQ2M7QUFDcUQ7QUFDeEw7QUFDTTtBQUNxQjtBQUNEO0FBQzBCO0FBQ2hGLGlCQUFpQiw0REFBTTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksa0RBQUcsb0JBQW9CLDRDQUE0QztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMERBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGtEQUFHO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGdCQUFnQixxREFBTTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHFFQUFhO0FBQ2pEO0FBQ0E7QUFDQSwwQkFBMEIsK0RBQWdCO0FBQzFDLDBCQUEwQiw0REFBYTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHVFQUFlO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsY0FBYywyREFBbUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLHFDQUFxQyxvREFBSztBQUMxQztBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsa0RBQWM7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUJBQWlCO0FBQ2hDLGVBQWUsVUFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsNEVBQW9CLEdBQUcsNkJBQTZCO0FBQ3hGO0FBQ0Esb0NBQW9DLDRFQUFvQjtBQUN4RDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLDRFQUFvQixHQUFHLGdDQUFnQztBQUMvRixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyw0RUFBb0I7QUFDaEU7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQSxxRkFBcUY7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQWM7QUFDdEQ7QUFDQTtBQUNBLHdDQUF3QyxrREFBYztBQUN0RDtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsNkVBQXFCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsa0RBQUc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxrREFBRztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxzQkFBc0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxrREFBYztBQUN0RDtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxrREFBYztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLHFCQUFxQjtBQUNwQyxlQUFlLFFBQVE7QUFDdkIsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsOERBQXNCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQWM7QUFDdEQ7QUFDQTtBQUNBLHdDQUF3QyxrREFBYztBQUN0RDtBQUNBLDhCQUE4Qiw2RUFBcUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxhQUFhO0FBQzVCLGlCQUFpQjtBQUNqQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhLElBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsdUJBQXVCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx1QkFBdUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixlQUFlLHFCQUFxQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStEO0FBQy9EO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhLElBQUksSUFBSSwwREFBMEQ7QUFDL0UsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYSxJQUFJO0FBQ2pCLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFDNUIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGtEQUFjO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxrREFBYztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QyxxQ0FBcUMsSUFBSTtBQUN6QztBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDLGlDQUFpQztBQUNqQyw2QkFBNkI7QUFDN0I7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxhQUFhO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBZSxhQUFhO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUIsSUFBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0MseUNBQXlDO0FBQ3pDO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUIsSUFBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsYUFBYTtBQUM1QixnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRjtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdGQUF3RjtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrR0FBa0c7QUFDbEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pELDZDQUE2QyxJQUFJO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLDZCQUE2QixJQUFJO0FBQ2pDO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFDNUIsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQUc7QUFDM0M7QUFDQSxxQ0FBcUM7QUFDckMsb0NBQW9DLGtEQUFHO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGtEQUFHO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0U7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLGdDQUFnQztBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdGQUF3Riw0RUFBb0I7QUFDNUc7QUFDQTtBQUNBO0FBQ0Esc0ZBQXNGLG9EQUFvRDtBQUMxSTtBQUNBO0FBQ0EscURBQXFEO0FBQ3JELGlEQUFpRCxJQUFJLElBQUksMERBQTBEO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsNkJBQTZCLElBQUksSUFBSSxnQ0FBZ0M7QUFDckU7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhLElBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGlCQUFpQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSx5QkFBeUIsNEJBQTRCO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0EsMERBQTBEO0FBQzFEO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhLElBQUksSUFBSSxnQ0FBZ0M7QUFDckQsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQWM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsOENBQThDO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLDBEQUEwRDtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVGQUF1RjtBQUN2Riw2RUFBNkU7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlEO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RDtBQUN6RCxxREFBcUQ7QUFDckQ7QUFDQTtBQUNBLHlDQUF5QztBQUN6QyxxQ0FBcUMsSUFBSSxJQUFJLGdDQUFnQztBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHdCQUF3QixpRUFBYTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQSxpQ0FBaUMsK0NBQStDO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQWM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxrREFBYztBQUN0RDtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFjO0FBQ3REO0FBQ0E7QUFDQSx3Q0FBd0Msa0RBQWM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQSxrRUFBa0U7QUFDbEU7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixnRUFBd0I7QUFDdEQsNEJBQTRCLHNFQUE4QjtBQUMxRCw0QkFBNEIsc0RBQWM7QUFDMUM7QUFDQTtBQUNBLHNDQUFzQyxtRUFBK0I7QUFDckU7QUFDQSxtQ0FBbUMsZ0VBQXdCO0FBQzNEO0FBQ0E7QUFDQSxzQ0FBc0MsZ0VBQXdCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QywyREFBbUI7QUFDM0Q7QUFDQTtBQUNBLDJDQUEyQywyREFBbUI7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsZ0dBQWdHO0FBQ3BLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLFVBQVU7QUFDNUUsNkNBQTZDLGlFQUFhO0FBQzFELDRDQUE0QywwQ0FBSztBQUNqRDtBQUNBLG9EQUFvRCwwQkFBMEI7QUFDOUU7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLDZDQUE2QywwQ0FBSztBQUNsRDtBQUNBO0FBQ0Esb0RBQW9ELDBCQUEwQjtBQUM5RTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywwRUFBa0I7QUFDeEQseUNBQXlDLHNFQUFjLEdBQUcsa0JBQWtCO0FBQzVFLDhDQUE4QywyRUFBbUI7QUFDakU7QUFDQSw2QkFBNkI7QUFDN0IsNkNBQTZDLDBFQUFrQjtBQUMvRDtBQUNBLDZCQUE2QjtBQUM3Qix5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxpRUFBYTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsbUVBQVc7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsa0RBQWM7QUFDckM7QUFDQTtBQUNBLGVBQWUsa0RBQWM7QUFDN0I7QUFDQTtBQUNBLGtDQUFrQywrQ0FBUztBQUMzQztBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MscURBQWU7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLG9EQUFvRCwrQ0FBUyxDQUFDLGtEQUFjO0FBQzVFO0FBQ0E7QUFDQSxvREFBb0QsK0NBQVMsQ0FBQyxrREFBYztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQyxpQ0FBaUM7QUFDakMsNkJBQTZCO0FBQzdCO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0Esb0RBQW9ELCtDQUFTLENBQUMsa0RBQWM7QUFDNUU7QUFDQTtBQUNBLG9EQUFvRCwrQ0FBUyxDQUFDLGtEQUFjO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDLGlDQUFpQztBQUNqQyw2QkFBNkI7QUFDN0I7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLG9EQUFvRCwrQ0FBUyxDQUFDLGtEQUFjO0FBQzVFO0FBQ0E7QUFDQSxvREFBb0QsK0NBQVMsQ0FBQyxrREFBYztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNvQjtBQUNkO0FBQ1AsdURBQU87QUFDUCIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9BdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE5IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKlx0IGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG52YXIgX19yZWFkID0gKHRoaXMgJiYgdGhpcy5fX3JlYWQpIHx8IGZ1bmN0aW9uIChvLCBuKSB7XG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICAgIGlmICghbSkgcmV0dXJuIG87XG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XG4gICAgdHJ5IHtcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XG4gICAgfVxuICAgIHJldHVybiBhcjtcbn07XG5pbXBvcnQgeyBpc1VzZXJuYW1lUGFzc3dvcmRPcHRzLCBpc0NvZ25pdG9Ib3N0ZWRPcHRzLCBpc0ZlZGVyYXRlZFNpZ25Jbk9wdGlvbnMsIGlzRmVkZXJhdGVkU2lnbkluT3B0aW9uc0N1c3RvbSwgaGFzQ3VzdG9tU3RhdGUsIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBBbXBsaWZ5LCBDb25zb2xlTG9nZ2VyIGFzIExvZ2dlciwgQ3JlZGVudGlhbHMsIEh1YiwgU3RvcmFnZUhlbHBlciwgUGFyc2VyLCBicm93c2VyT3JOb2RlLCBVbml2ZXJzYWxTdG9yYWdlLCB1cmxTYWZlRGVjb2RlLCB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9jb3JlJztcbmltcG9ydCB7IENvb2tpZVN0b3JhZ2UsIENvZ25pdG9Vc2VyUG9vbCwgQXV0aGVudGljYXRpb25EZXRhaWxzLCBDb2duaXRvVXNlciwgQ29nbml0b1VzZXJTZXNzaW9uLCBDb2duaXRvVXNlckF0dHJpYnV0ZSwgQ29nbml0b0lkVG9rZW4sIENvZ25pdG9SZWZyZXNoVG9rZW4sIENvZ25pdG9BY2Nlc3NUb2tlbiwgfSBmcm9tICdhbWF6b24tY29nbml0by1pZGVudGl0eS1qcyc7XG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ3VybCc7XG5pbXBvcnQgT0F1dGggZnJvbSAnLi9PQXV0aC9PQXV0aCc7XG5pbXBvcnQgeyBkZWZhdWx0IGFzIHVybExpc3RlbmVyIH0gZnJvbSAnLi91cmxMaXN0ZW5lcic7XG5pbXBvcnQgeyBBdXRoRXJyb3IsIE5vVXNlclBvb2xFcnJvciB9IGZyb20gJy4vRXJyb3JzJztcbmltcG9ydCB7IEF1dGhFcnJvclR5cGVzLCBDb2duaXRvSG9zdGVkVUlJZGVudGl0eVByb3ZpZGVyLCB9IGZyb20gJy4vdHlwZXMvQXV0aCc7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignQXV0aENsYXNzJyk7XG52YXIgVVNFUl9BRE1JTl9TQ09QRSA9ICdhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbic7XG4vLyAxMCBzZWMsIGZvbGxvd2luZyB0aGlzIGd1aWRlIGh0dHBzOi8vd3d3Lm5uZ3JvdXAuY29tL2FydGljbGVzL3Jlc3BvbnNlLXRpbWVzLTMtaW1wb3J0YW50LWxpbWl0cy9cbnZhciBPQVVUSF9GTE9XX01TX1RJTUVPVVQgPSAxMCAqIDEwMDA7XG52YXIgQU1QTElGWV9TWU1CT0wgPSAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIFN5bWJvbC5mb3IgPT09ICdmdW5jdGlvbidcbiAgICA/IFN5bWJvbC5mb3IoJ2FtcGxpZnlfZGVmYXVsdCcpXG4gICAgOiAnQEBhbXBsaWZ5X2RlZmF1bHQnKTtcbnZhciBkaXNwYXRjaEF1dGhFdmVudCA9IGZ1bmN0aW9uIChldmVudCwgZGF0YSwgbWVzc2FnZSkge1xuICAgIEh1Yi5kaXNwYXRjaCgnYXV0aCcsIHsgZXZlbnQ6IGV2ZW50LCBkYXRhOiBkYXRhLCBtZXNzYWdlOiBtZXNzYWdlIH0sICdBdXRoJywgQU1QTElGWV9TWU1CT0wpO1xufTtcbi8vIENvZ25pdG8gRG9jdW1lbnRhdGlvbiBmb3IgbWF4IGRldmljZVxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuLy8gaHR0cHM6Ly9kb2NzLmF3cy5hbWF6b24uY29tL2NvZ25pdG8tdXNlci1pZGVudGl0eS1wb29scy9sYXRlc3QvQVBJUmVmZXJlbmNlL0FQSV9MaXN0RGV2aWNlcy5odG1sI0FQSV9MaXN0RGV2aWNlc19SZXF1ZXN0U3ludGF4XG52YXIgTUFYX0RFVklDRVMgPSA2MDtcbnZhciBNQVhfQVVUT1NJR05JTl9QT0xMSU5HX01TID0gMyAqIDYwICogMTAwMDtcbi8qKlxuICogUHJvdmlkZSBhdXRoZW50aWNhdGlvbiBzdGVwc1xuICovXG52YXIgQXV0aENsYXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemUgQXV0aCB3aXRoIEFXUyBjb25maWd1cmF0aW9uc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBDb25maWd1cmF0aW9uIG9mIHRoZSBBdXRoXG4gICAgICovXG4gICAgZnVuY3Rpb24gQXV0aENsYXNzKGNvbmZpZykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnVzZXJQb29sID0gbnVsbDtcbiAgICAgICAgdGhpcy51c2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy5vQXV0aEZsb3dJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYXV0b1NpZ25JbkluaXRpYXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLkNyZWRlbnRpYWxzID0gQ3JlZGVudGlhbHM7XG4gICAgICAgIHRoaXMud3JhcFJlZnJlc2hTZXNzaW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciB3cmFwcGVkID0gZnVuY3Rpb24gKGVycm9yLCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3Rva2VuUmVmcmVzaCcsIHVuZGVmaW5lZCwgXCJOZXcgdG9rZW4gcmV0cmlldmVkXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3Rva2VuUmVmcmVzaF9mYWlsdXJlJywgZXJyb3IsIFwiRmFpbGVkIHRvIHJldHJpZXZlIG5ldyB0b2tlblwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycm9yLCBkYXRhKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gd3JhcHBlZDtcbiAgICAgICAgfTsgLy8gcHJldHRpZXItaWdub3JlXG4gICAgICAgIHRoaXMuY29uZmlndXJlKGNvbmZpZyk7XG4gICAgICAgIHRoaXMuY3VycmVudENyZWRlbnRpYWxzID0gdGhpcy5jdXJyZW50Q3JlZGVudGlhbHMuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlckNyZWRlbnRpYWxzID0gdGhpcy5jdXJyZW50VXNlckNyZWRlbnRpYWxzLmJpbmQodGhpcyk7XG4gICAgICAgIEh1Yi5saXN0ZW4oJ2F1dGgnLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gX2EucGF5bG9hZDtcbiAgICAgICAgICAgIHZhciBldmVudCA9IHBheWxvYWQuZXZlbnQ7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2lnbkluJzpcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0b3JhZ2Uuc2V0SXRlbSgnYW1wbGlmeS1zaWduaW4td2l0aC1ob3N0ZWRVSScsICdmYWxzZScpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzaWduT3V0JzpcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0b3JhZ2UucmVtb3ZlSXRlbSgnYW1wbGlmeS1zaWduaW4td2l0aC1ob3N0ZWRVSScpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjb2duaXRvSG9zdGVkVUknOlxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fc3RvcmFnZS5zZXRJdGVtKCdhbXBsaWZ5LXNpZ25pbi13aXRoLWhvc3RlZFVJJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnQXV0aCc7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCFjb25maWcpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnIHx8IHt9O1xuICAgICAgICBsb2dnZXIuZGVidWcoJ2NvbmZpZ3VyZSBBdXRoJyk7XG4gICAgICAgIHZhciBjb25mID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fY29uZmlnLCBQYXJzZXIucGFyc2VNb2JpbGVodWJDb25maWcoY29uZmlnKS5BdXRoLCBjb25maWcpO1xuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25mO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLl9jb25maWcsIHVzZXJQb29sSWQgPSBfYS51c2VyUG9vbElkLCB1c2VyUG9vbFdlYkNsaWVudElkID0gX2EudXNlclBvb2xXZWJDbGllbnRJZCwgY29va2llU3RvcmFnZSA9IF9hLmNvb2tpZVN0b3JhZ2UsIG9hdXRoID0gX2Eub2F1dGgsIHJlZ2lvbiA9IF9hLnJlZ2lvbiwgaWRlbnRpdHlQb29sSWQgPSBfYS5pZGVudGl0eVBvb2xJZCwgbWFuZGF0b3J5U2lnbkluID0gX2EubWFuZGF0b3J5U2lnbkluLCByZWZyZXNoSGFuZGxlcnMgPSBfYS5yZWZyZXNoSGFuZGxlcnMsIGlkZW50aXR5UG9vbFJlZ2lvbiA9IF9hLmlkZW50aXR5UG9vbFJlZ2lvbiwgY2xpZW50TWV0YWRhdGEgPSBfYS5jbGllbnRNZXRhZGF0YSwgZW5kcG9pbnQgPSBfYS5lbmRwb2ludDtcbiAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuc3RvcmFnZSkge1xuICAgICAgICAgICAgLy8gYmFja3dhcmQgY29tcGF0YWJpbGl0eVxuICAgICAgICAgICAgaWYgKGNvb2tpZVN0b3JhZ2UpXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RvcmFnZSA9IG5ldyBDb29raWVTdG9yYWdlKGNvb2tpZVN0b3JhZ2UpO1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RvcmFnZSA9IGNvbmZpZy5zc3JcbiAgICAgICAgICAgICAgICAgICAgPyBuZXcgVW5pdmVyc2FsU3RvcmFnZSgpXG4gICAgICAgICAgICAgICAgICAgIDogbmV3IFN0b3JhZ2VIZWxwZXIoKS5nZXRTdG9yYWdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRBdXRoU3RvcmFnZSh0aGlzLl9jb25maWcuc3RvcmFnZSkpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ1RoZSBzdG9yYWdlIGluIHRoZSBBdXRoIGNvbmZpZyBpcyBub3QgdmFsaWQhJyk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbXB0eSBzdG9yYWdlIG9iamVjdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3RvcmFnZSA9IHRoaXMuX2NvbmZpZy5zdG9yYWdlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N0b3JhZ2VTeW5jID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5fc3RvcmFnZVsnc3luYyddID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLl9zdG9yYWdlU3luYyA9IHRoaXMuX3N0b3JhZ2VbJ3N5bmMnXSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VyUG9vbElkKSB7XG4gICAgICAgICAgICB2YXIgdXNlclBvb2xEYXRhID0ge1xuICAgICAgICAgICAgICAgIFVzZXJQb29sSWQ6IHVzZXJQb29sSWQsXG4gICAgICAgICAgICAgICAgQ2xpZW50SWQ6IHVzZXJQb29sV2ViQ2xpZW50SWQsXG4gICAgICAgICAgICAgICAgZW5kcG9pbnQ6IGVuZHBvaW50LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHVzZXJQb29sRGF0YS5TdG9yYWdlID0gdGhpcy5fc3RvcmFnZTtcbiAgICAgICAgICAgIHRoaXMudXNlclBvb2wgPSBuZXcgQ29nbml0b1VzZXJQb29sKHVzZXJQb29sRGF0YSwgdGhpcy53cmFwUmVmcmVzaFNlc3Npb25DYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5DcmVkZW50aWFscy5jb25maWd1cmUoe1xuICAgICAgICAgICAgbWFuZGF0b3J5U2lnbkluOiBtYW5kYXRvcnlTaWduSW4sXG4gICAgICAgICAgICByZWdpb246IGlkZW50aXR5UG9vbFJlZ2lvbiB8fCByZWdpb24sXG4gICAgICAgICAgICB1c2VyUG9vbElkOiB1c2VyUG9vbElkLFxuICAgICAgICAgICAgaWRlbnRpdHlQb29sSWQ6IGlkZW50aXR5UG9vbElkLFxuICAgICAgICAgICAgcmVmcmVzaEhhbmRsZXJzOiByZWZyZXNoSGFuZGxlcnMsXG4gICAgICAgICAgICBzdG9yYWdlOiB0aGlzLl9zdG9yYWdlLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gaW5pdGlhbGl6ZSBjb2duaXRvYXV0aCBjbGllbnQgaWYgaG9zdGVkIHVpIG9wdGlvbnMgcHJvdmlkZWRcbiAgICAgICAgLy8gdG8ga2VlcCBiYWNrd2FyZCBjb21wYXRpYmlsaXR5OlxuICAgICAgICB2YXIgY29nbml0b0hvc3RlZFVJQ29uZmlnID0gb2F1dGhcbiAgICAgICAgICAgID8gaXNDb2duaXRvSG9zdGVkT3B0cyh0aGlzLl9jb25maWcub2F1dGgpXG4gICAgICAgICAgICAgICAgPyBvYXV0aFxuICAgICAgICAgICAgICAgIDogb2F1dGguYXdzQ29nbml0b1xuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChjb2duaXRvSG9zdGVkVUlDb25maWcpIHtcbiAgICAgICAgICAgIHZhciBjb2duaXRvQXV0aFBhcmFtcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgIGNvZ25pdG9DbGllbnRJZDogdXNlclBvb2xXZWJDbGllbnRJZCxcbiAgICAgICAgICAgICAgICBVc2VyUG9vbElkOiB1c2VyUG9vbElkLFxuICAgICAgICAgICAgICAgIGRvbWFpbjogY29nbml0b0hvc3RlZFVJQ29uZmlnWydkb21haW4nXSxcbiAgICAgICAgICAgICAgICBzY29wZXM6IGNvZ25pdG9Ib3N0ZWRVSUNvbmZpZ1snc2NvcGUnXSxcbiAgICAgICAgICAgICAgICByZWRpcmVjdFNpZ25JbjogY29nbml0b0hvc3RlZFVJQ29uZmlnWydyZWRpcmVjdFNpZ25JbiddLFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0U2lnbk91dDogY29nbml0b0hvc3RlZFVJQ29uZmlnWydyZWRpcmVjdFNpZ25PdXQnXSxcbiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6IGNvZ25pdG9Ib3N0ZWRVSUNvbmZpZ1sncmVzcG9uc2VUeXBlJ10sXG4gICAgICAgICAgICAgICAgU3RvcmFnZTogdGhpcy5fc3RvcmFnZSxcbiAgICAgICAgICAgICAgICB1cmxPcGVuZXI6IGNvZ25pdG9Ib3N0ZWRVSUNvbmZpZ1sndXJsT3BlbmVyJ10sXG4gICAgICAgICAgICAgICAgY2xpZW50TWV0YWRhdGE6IGNsaWVudE1ldGFkYXRhLFxuICAgICAgICAgICAgfSwgY29nbml0b0hvc3RlZFVJQ29uZmlnWydvcHRpb25zJ10pO1xuICAgICAgICAgICAgdGhpcy5fb0F1dGhIYW5kbGVyID0gbmV3IE9BdXRoKHtcbiAgICAgICAgICAgICAgICBzY29wZXM6IGNvZ25pdG9BdXRoUGFyYW1zLnNjb3BlcyxcbiAgICAgICAgICAgICAgICBjb25maWc6IGNvZ25pdG9BdXRoUGFyYW1zLFxuICAgICAgICAgICAgICAgIGNvZ25pdG9DbGllbnRJZDogY29nbml0b0F1dGhQYXJhbXMuY29nbml0b0NsaWVudElkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyAqKk5PVEUqKiAtIFJlbW92ZSB0aGlzIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UgYXMgaXQgaXMgYSBicmVha2luZyBjaGFuZ2VcbiAgICAgICAgICAgIC8vIFByZXZlbnRzIF9oYW5kbGVBdXRoUmVzcG9uc2UgZnJvbSBiZWluZyBjYWxsZWQgbXVsdGlwbGUgdGltZXMgaW4gRXhwb1xuICAgICAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hd3MtYW1wbGlmeS9hbXBsaWZ5LWpzL2lzc3Vlcy80Mzg4XG4gICAgICAgICAgICB2YXIgdXNlZFJlc3BvbnNlVXJsc18xID0ge307XG4gICAgICAgICAgICB1cmxMaXN0ZW5lcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gX2EudXJsO1xuICAgICAgICAgICAgICAgIGlmICh1c2VkUmVzcG9uc2VVcmxzXzFbdXJsXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHVzZWRSZXNwb25zZVVybHNfMVt1cmxdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5faGFuZGxlQXV0aFJlc3BvbnNlKHVybCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnY29uZmlndXJlZCcsIG51bGwsIFwiVGhlIEF1dGggY2F0ZWdvcnkgaGFzIGJlZW4gY29uZmlndXJlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgIGlmICghdGhpcy5hdXRvU2lnbkluSW5pdGlhdGVkICYmXG4gICAgICAgICAgICB0eXBlb2YgdGhpcy5fc3RvcmFnZVsnZ2V0SXRlbSddID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB2YXIgcG9sbGluZ0luaXRpYXRlZCA9IHRoaXMuaXNUcnVlU3RvcmFnZVZhbHVlKCdhbXBsaWZ5LXBvbGxpbmctc3RhcnRlZCcpO1xuICAgICAgICAgICAgaWYgKHBvbGxpbmdJbml0aWF0ZWQpIHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnYXV0b1NpZ25Jbl9mYWlsdXJlJywgbnVsbCwgQXV0aEVycm9yVHlwZXMuQXV0b1NpZ25JbkVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oJ2FtcGxpZnktYXV0by1zaWduLWluJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oJ2FtcGxpZnktcG9sbGluZy1zdGFydGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNpZ24gdXAgd2l0aCB1c2VybmFtZSwgcGFzc3dvcmQgYW5kIG90aGVyIGF0dHJpYnV0ZXMgbGlrZSBwaG9uZSwgZW1haWxcbiAgICAgKiBAcGFyYW0ge1N0cmluZyB8IG9iamVjdH0gcGFyYW1zIC0gVGhlIHVzZXIgYXR0cmlidXRlcyB1c2VkIGZvciBzaWduaW5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ1tdfSByZXN0T2ZBdHRycyAtIGZvciB0aGUgYmFja3dhcmQgY29tcGF0YWJpbGl0eVxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgY2FsbGJhY2sgZGF0YSBpZiBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5zaWduVXAgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciByZXN0T2ZBdHRycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgcmVzdE9mQXR0cnNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGlmICghdGhpcy51c2VyUG9vbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0Tm9Vc2VyUG9vbCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1c2VybmFtZSA9IG51bGw7XG4gICAgICAgIHZhciBwYXNzd29yZCA9IG51bGw7XG4gICAgICAgIHZhciBhdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHZhciB2YWxpZGF0aW9uRGF0YSA9IG51bGw7XG4gICAgICAgIHZhciBjbGllbnRNZXRhZGF0YTtcbiAgICAgICAgdmFyIGF1dG9TaWduSW4gPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG4gICAgICAgIHZhciBhdXRvU2lnbkluVmFsaWRhdGlvbkRhdGEgPSB7fTtcbiAgICAgICAgdmFyIGF1dG9TaWduSW5DbGllbnRNZXRhRGF0YSA9IHt9O1xuICAgICAgICBpZiAocGFyYW1zICYmIHR5cGVvZiBwYXJhbXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB1c2VybmFtZSA9IHBhcmFtcztcbiAgICAgICAgICAgIHBhc3N3b3JkID0gcmVzdE9mQXR0cnMgPyByZXN0T2ZBdHRyc1swXSA6IG51bGw7XG4gICAgICAgICAgICB2YXIgZW1haWwgPSByZXN0T2ZBdHRycyA/IHJlc3RPZkF0dHJzWzFdIDogbnVsbDtcbiAgICAgICAgICAgIHZhciBwaG9uZV9udW1iZXIgPSByZXN0T2ZBdHRycyA/IHJlc3RPZkF0dHJzWzJdIDogbnVsbDtcbiAgICAgICAgICAgIGlmIChlbWFpbClcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2gobmV3IENvZ25pdG9Vc2VyQXR0cmlidXRlKHsgTmFtZTogJ2VtYWlsJywgVmFsdWU6IGVtYWlsIH0pKTtcbiAgICAgICAgICAgIGlmIChwaG9uZV9udW1iZXIpXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKG5ldyBDb2duaXRvVXNlckF0dHJpYnV0ZSh7XG4gICAgICAgICAgICAgICAgICAgIE5hbWU6ICdwaG9uZV9udW1iZXInLFxuICAgICAgICAgICAgICAgICAgICBWYWx1ZTogcGhvbmVfbnVtYmVyLFxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHVzZXJuYW1lID0gcGFyYW1zWyd1c2VybmFtZSddO1xuICAgICAgICAgICAgcGFzc3dvcmQgPSBwYXJhbXNbJ3Bhc3N3b3JkJ107XG4gICAgICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy5jbGllbnRNZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIGNsaWVudE1ldGFkYXRhID0gcGFyYW1zLmNsaWVudE1ldGFkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fY29uZmlnLmNsaWVudE1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYXR0cnNfMSA9IHBhcmFtc1snYXR0cmlidXRlcyddO1xuICAgICAgICAgICAgaWYgKGF0dHJzXzEpIHtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhhdHRyc18xKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2gobmV3IENvZ25pdG9Vc2VyQXR0cmlidXRlKHsgTmFtZToga2V5LCBWYWx1ZTogYXR0cnNfMVtrZXldIH0pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWxpZGF0aW9uRGF0YU9iamVjdF8xID0gcGFyYW1zWyd2YWxpZGF0aW9uRGF0YSddO1xuICAgICAgICAgICAgaWYgKHZhbGlkYXRpb25EYXRhT2JqZWN0XzEpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uRGF0YSA9IFtdO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbGlkYXRpb25EYXRhT2JqZWN0XzEpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25EYXRhLnB1c2gobmV3IENvZ25pdG9Vc2VyQXR0cmlidXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE5hbWU6IGtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlOiB2YWxpZGF0aW9uRGF0YU9iamVjdF8xW2tleV0sXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF1dG9TaWduSW4gPSAoX2EgPSBwYXJhbXMuYXV0b1NpZ25JbikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogeyBlbmFibGVkOiBmYWxzZSB9O1xuICAgICAgICAgICAgaWYgKGF1dG9TaWduSW4uZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JhZ2Uuc2V0SXRlbSgnYW1wbGlmeS1hdXRvLXNpZ24taW4nLCAndHJ1ZScpO1xuICAgICAgICAgICAgICAgIGF1dG9TaWduSW5WYWxpZGF0aW9uRGF0YSA9IChfYiA9IGF1dG9TaWduSW4udmFsaWRhdGlvbkRhdGEpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHt9O1xuICAgICAgICAgICAgICAgIGF1dG9TaWduSW5DbGllbnRNZXRhRGF0YSA9IChfYyA9IGF1dG9TaWduSW4uY2xpZW50TWV0YURhdGEpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLlNpZ25VcEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXVzZXJuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3RBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuRW1wdHlVc2VybmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXNzd29yZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5UGFzc3dvcmQpO1xuICAgICAgICB9XG4gICAgICAgIGxvZ2dlci5kZWJ1Zygnc2lnblVwIGF0dHJzOicsIGF0dHJpYnV0ZXMpO1xuICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25VcCB2YWxpZGF0aW9uIGRhdGE6JywgdmFsaWRhdGlvbkRhdGEpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXMudXNlclBvb2wuc2lnblVwKHVzZXJuYW1lLCBwYXNzd29yZCwgYXR0cmlidXRlcywgdmFsaWRhdGlvbkRhdGEsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdzaWduVXBfZmFpbHVyZScsIGVyciwgdXNlcm5hbWUgKyBcIiBmYWlsZWQgdG8gc2lnbnVwXCIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdzaWduVXAnLCBkYXRhLCB1c2VybmFtZSArIFwiIGhhcyBzaWduZWQgdXAgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b1NpZ25Jbi5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVBdXRvU2lnbkluKHVzZXJuYW1lLCBwYXNzd29yZCwgYXV0b1NpZ25JblZhbGlkYXRpb25EYXRhLCBhdXRvU2lnbkluQ2xpZW50TWV0YURhdGEsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgY2xpZW50TWV0YWRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuaGFuZGxlQXV0b1NpZ25JbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHZhbGlkYXRpb25EYXRhLCBjbGllbnRNZXRhZGF0YSwgZGF0YSkge1xuICAgICAgICB0aGlzLmF1dG9TaWduSW5Jbml0aWF0ZWQgPSB0cnVlO1xuICAgICAgICB2YXIgYXV0aERldGFpbHMgPSBuZXcgQXV0aGVudGljYXRpb25EZXRhaWxzKHtcbiAgICAgICAgICAgIFVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgIFBhc3N3b3JkOiBwYXNzd29yZCxcbiAgICAgICAgICAgIFZhbGlkYXRpb25EYXRhOiB2YWxpZGF0aW9uRGF0YSxcbiAgICAgICAgICAgIENsaWVudE1ldGFkYXRhOiBjbGllbnRNZXRhZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChkYXRhLnVzZXJDb25maXJtZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2lnbkluQWZ0ZXJVc2VyQ29uZmlybWVkKGF1dGhEZXRhaWxzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9jb25maWcuc2lnblVwVmVyaWZpY2F0aW9uTWV0aG9kID09PSAnbGluaycpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlTGlua0F1dG9TaWduSW4oYXV0aERldGFpbHMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDb2RlQXV0b1NpZ25JbihhdXRoRGV0YWlscyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuaGFuZGxlQ29kZUF1dG9TaWduSW4gPSBmdW5jdGlvbiAoYXV0aERldGFpbHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGxpc3RlbkV2ZW50ID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgcGF5bG9hZCA9IF9hLnBheWxvYWQ7XG4gICAgICAgICAgICBpZiAocGF5bG9hZC5ldmVudCA9PT0gJ2NvbmZpcm1TaWduVXAnKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2lnbkluQWZ0ZXJVc2VyQ29uZmlybWVkKGF1dGhEZXRhaWxzLCBsaXN0ZW5FdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEh1Yi5saXN0ZW4oJ2F1dGgnLCBsaXN0ZW5FdmVudCk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmhhbmRsZUxpbmtBdXRvU2lnbkluID0gZnVuY3Rpb24gKGF1dGhEZXRhaWxzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3N0b3JhZ2Uuc2V0SXRlbSgnYW1wbGlmeS1wb2xsaW5nLXN0YXJ0ZWQnLCAndHJ1ZScpO1xuICAgICAgICB2YXIgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgICB2YXIgYXV0b1NpZ25JblBvbGxpbmdJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+IE1BWF9BVVRPU0lHTklOX1BPTExJTkdfTVMpIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9TaWduSW5Qb2xsaW5nSW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2F1dG9TaWduSW5fZmFpbHVyZScsIG51bGwsICdQbGVhc2UgY29uZmlybSB5b3VyIGFjY291bnQgYW5kIHVzZSB5b3VyIGNyZWRlbnRpYWxzIHRvIHNpZ24gaW4uJyk7XG4gICAgICAgICAgICAgICAgX3RoaXMuX3N0b3JhZ2UucmVtb3ZlSXRlbSgnYW1wbGlmeS1hdXRvLXNpZ24taW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLnNpZ25JbkFmdGVyVXNlckNvbmZpcm1lZChhdXRoRGV0YWlscywgbnVsbCwgYXV0b1NpZ25JblBvbGxpbmdJbnRlcnZhbElkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgNTAwMCk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnNpZ25JbkFmdGVyVXNlckNvbmZpcm1lZCA9IGZ1bmN0aW9uIChhdXRoRGV0YWlscywgbGlzdGVuRXZlbnQsIGF1dG9TaWduSW5Qb2xsaW5nSW50ZXJ2YWxJZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlciwgZXJyb3JfMTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gdGhpcy5jcmVhdGVDb2duaXRvVXNlcihhdXRoRGV0YWlscy5nZXRVc2VybmFtZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHVzZXIuYXV0aGVudGljYXRlVXNlcihhdXRoRGV0YWlscywgdGhpcy5hdXRoQ2FsbGJhY2tzKHVzZXIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnYXV0b1NpZ25JbicsIHZhbHVlLCBhdXRoRGV0YWlscy5nZXRVc2VybmFtZSgpICsgXCIgaGFzIHNpZ25lZCBpbiBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5FdmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSHViLnJlbW92ZSgnYXV0aCcsIGxpc3RlbkV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b1NpZ25JblBvbGxpbmdJbnRlcnZhbElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9TaWduSW5Qb2xsaW5nSW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fc3RvcmFnZS5yZW1vdmVJdGVtKCdhbXBsaWZ5LXBvbGxpbmctc3RhcnRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oJ2FtcGxpZnktYXV0by1zaWduLWluJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oJ2FtcGxpZnktYXV0by1zaWduLWluJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3JfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VuZCB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgdG8gY29uZmlybSBzaWduIHVwXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHVzZXJuYW1lIC0gVGhlIHVzZXJuYW1lIHRvIGJlIGNvbmZpcm1lZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb2RlIC0gVGhlIHZlcmlmaWNhdGlvbiBjb2RlXG4gICAgICogQHBhcmFtIHtDb25maXJtU2lnblVwT3B0aW9uc30gb3B0aW9ucyAtIG90aGVyIG9wdGlvbnMgZm9yIGNvbmZpcm0gc2lnbnVwXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyBjYWxsYmFjayBkYXRhIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmNvbmZpcm1TaWduVXAgPSBmdW5jdGlvbiAodXNlcm5hbWUsIGNvZGUsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLnVzZXJQb29sKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3ROb1VzZXJQb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VybmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5VXNlcm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5Q29kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVzZXIgPSB0aGlzLmNyZWF0ZUNvZ25pdG9Vc2VyKHVzZXJuYW1lKTtcbiAgICAgICAgdmFyIGZvcmNlQWxpYXNDcmVhdGlvbiA9IG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMuZm9yY2VBbGlhc0NyZWF0aW9uID09PSAnYm9vbGVhbidcbiAgICAgICAgICAgID8gb3B0aW9ucy5mb3JjZUFsaWFzQ3JlYXRpb25cbiAgICAgICAgICAgIDogdHJ1ZTtcbiAgICAgICAgdmFyIGNsaWVudE1ldGFkYXRhO1xuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNsaWVudE1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjbGllbnRNZXRhZGF0YSA9IG9wdGlvbnMuY2xpZW50TWV0YWRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY29uZmlnLmNsaWVudE1ldGFkYXRhKSB7XG4gICAgICAgICAgICBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdXNlci5jb25maXJtUmVnaXN0cmF0aW9uKGNvZGUsIGZvcmNlQWxpYXNDcmVhdGlvbiwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnY29uZmlybVNpZ25VcCcsIGRhdGEsIHVzZXJuYW1lICsgXCIgaGFzIGJlZW4gY29uZmlybWVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF1dG9TaWduSW4gPSBfdGhpcy5pc1RydWVTdG9yYWdlVmFsdWUoJ2FtcGxpZnktYXV0by1zaWduLWluJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdXRvU2lnbkluICYmICFfdGhpcy5hdXRvU2lnbkluSW5pdGlhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnYXV0b1NpZ25Jbl9mYWlsdXJlJywgbnVsbCwgQXV0aEVycm9yVHlwZXMuQXV0b1NpZ25JbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0oJ2FtcGxpZnktYXV0by1zaWduLWluJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBjbGllbnRNZXRhZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc1RydWVTdG9yYWdlVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLl9zdG9yYWdlLmdldEl0ZW0odmFsdWUpO1xuICAgICAgICByZXR1cm4gaXRlbSA/IGl0ZW0gPT09ICd0cnVlJyA6IGZhbHNlO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVzZW5kIHRoZSB2ZXJpZmljYXRpb24gY29kZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1c2VybmFtZSAtIFRoZSB1c2VybmFtZSB0byBiZSBjb25maXJtZWRcbiAgICAgKiBAcGFyYW0ge0NsaWVudE1ldGFkYXRhfSBjbGllbnRNZXRhZGF0YSAtIE1ldGFkYXRhIHRvIGJlIHBhc3NlZCB0byBDb2duaXRvIExhbWJkYSB0cmlnZ2Vyc1xuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgY29kZSBkZWxpdmVyeSBkZXRhaWxzIGlmIHN1Y2Nlc3NmdWxcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnJlc2VuZFNpZ25VcCA9IGZ1bmN0aW9uICh1c2VybmFtZSwgY2xpZW50TWV0YWRhdGEpIHtcbiAgICAgICAgaWYgKGNsaWVudE1ldGFkYXRhID09PSB2b2lkIDApIHsgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7IH1cbiAgICAgICAgaWYgKCF0aGlzLnVzZXJQb29sKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3ROb1VzZXJQb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VybmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5VXNlcm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1c2VyID0gdGhpcy5jcmVhdGVDb2duaXRvVXNlcih1c2VybmFtZSk7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB1c2VyLnJlc2VuZENvbmZpcm1hdGlvbkNvZGUoZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGNsaWVudE1ldGFkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTaWduIGluXG4gICAgICogQHBhcmFtIHtTdHJpbmcgfCBTaWduSW5PcHRzfSB1c2VybmFtZU9yU2lnbkluT3B0cyAtIFRoZSB1c2VybmFtZSB0byBiZSBzaWduZWQgaW4gb3IgdGhlIHNpZ24gaW4gb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwdyAtIFRoZSBwYXNzd29yZCBvZiB0aGUgdXNlcm5hbWVcbiAgICAgKiBAcGFyYW0ge0NsaWVudE1ldGFEYXRhfSBjbGllbnRNZXRhZGF0YSAtIENsaWVudCBtZXRhZGF0YSBmb3IgY3VzdG9tIHdvcmtmbG93c1xuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdGhlIENvZ25pdG9Vc2VyXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5zaWduSW4gPSBmdW5jdGlvbiAodXNlcm5hbWVPclNpZ25Jbk9wdHMsIHB3LCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICBpZiAoY2xpZW50TWV0YWRhdGEgPT09IHZvaWQgMCkgeyBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgfVxuICAgICAgICBpZiAoIXRoaXMudXNlclBvb2wpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlamVjdE5vVXNlclBvb2woKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdXNlcm5hbWUgPSBudWxsO1xuICAgICAgICB2YXIgcGFzc3dvcmQgPSBudWxsO1xuICAgICAgICB2YXIgdmFsaWRhdGlvbkRhdGEgPSB7fTtcbiAgICAgICAgLy8gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgICAgICAgaWYgKHR5cGVvZiB1c2VybmFtZU9yU2lnbkluT3B0cyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHVzZXJuYW1lID0gdXNlcm5hbWVPclNpZ25Jbk9wdHM7XG4gICAgICAgICAgICBwYXNzd29yZCA9IHB3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzVXNlcm5hbWVQYXNzd29yZE9wdHModXNlcm5hbWVPclNpZ25Jbk9wdHMpKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHB3ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKCdUaGUgcGFzc3dvcmQgc2hvdWxkIGJlIGRlZmluZWQgdW5kZXIgdGhlIGZpcnN0IHBhcmFtZXRlciBvYmplY3QhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1c2VybmFtZSA9IHVzZXJuYW1lT3JTaWduSW5PcHRzLnVzZXJuYW1lO1xuICAgICAgICAgICAgcGFzc3dvcmQgPSB1c2VybmFtZU9yU2lnbkluT3B0cy5wYXNzd29yZDtcbiAgICAgICAgICAgIHZhbGlkYXRpb25EYXRhID0gdXNlcm5hbWVPclNpZ25Jbk9wdHMudmFsaWRhdGlvbkRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3RBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuSW52YWxpZFVzZXJuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXVzZXJuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3RBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuRW1wdHlVc2VybmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF1dGhEZXRhaWxzID0gbmV3IEF1dGhlbnRpY2F0aW9uRGV0YWlscyh7XG4gICAgICAgICAgICBVc2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBQYXNzd29yZDogcGFzc3dvcmQsXG4gICAgICAgICAgICBWYWxpZGF0aW9uRGF0YTogdmFsaWRhdGlvbkRhdGEsXG4gICAgICAgICAgICBDbGllbnRNZXRhZGF0YTogY2xpZW50TWV0YWRhdGEsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocGFzc3dvcmQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNpZ25JbldpdGhQYXNzd29yZChhdXRoRGV0YWlscyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zaWduSW5XaXRob3V0UGFzc3dvcmQoYXV0aERldGFpbHMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gb2JqZWN0IHdpdGggdGhlIGF1dGhlbnRpY2F0aW9uIGNhbGxiYWNrc1xuICAgICAqIEBwYXJhbSB7Q29nbml0b1VzZXJ9IHVzZXIgLSB0aGUgY29nbml0byB1c2VyIG9iamVjdFxuICAgICAqIEBwYXJhbSB7fSByZXNvbHZlIC0gZnVuY3Rpb24gY2FsbGVkIHdoZW4gcmVzb2x2aW5nIHRoZSBjdXJyZW50IHN0ZXBcbiAgICAgKiBAcGFyYW0ge30gcmVqZWN0IC0gZnVuY3Rpb24gY2FsbGVkIHdoZW4gcmVqZWN0aW5nIHRoZSBjdXJyZW50IHN0ZXBcbiAgICAgKiBAcmV0dXJuIC0gYW4gb2JqZWN0IHdpdGggdGhlIGNhbGxiYWNrIG1ldGhvZHMgZm9yIHVzZXIgYXV0aGVudGljYXRpb25cbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmF1dGhDYWxsYmFja3MgPSBmdW5jdGlvbiAodXNlciwgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gKHNlc3Npb24pIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3JlZCwgZV8xLCBjdXJyZW50VXNlciwgZV8yO1xuICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhzZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdXNlclsnY2hhbGxlbmdlTmFtZSddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VyWydjaGFsbGVuZ2VQYXJhbSddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDQsIDUsIDldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLmNsZWFyKCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLnNldChzZXNzaW9uLCAnc2Vzc2lvbicpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnc3VjY2VlZCB0byBnZXQgY29nbml0byBjcmVkZW50aWFscycsIGNyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2Nhbm5vdCBnZXQgY29nbml0byBjcmVkZW50aWFscycsIGVfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFs1LCA3LCAsIDhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmN1cnJlbnRVc2VyUG9vbFVzZXIoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC51c2VyID0gY3VycmVudFVzZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3NpZ25JbicsIGN1cnJlbnRVc2VyLCBcIkEgdXNlciBcIiArIHVzZXIuZ2V0VXNlcm5hbWUoKSArIFwiIGhhcyBiZWVuIHNpZ25lZCBpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHRoZSBzaWduZWQgaW4gdXNlcicsIGVfMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVfMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7IH0sXG4gICAgICAgICAgICBvbkZhaWx1cmU6IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25JbiBmYWlsdXJlJywgZXJyKTtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnc2lnbkluX2ZhaWx1cmUnLCBlcnIsIHVzZXIuZ2V0VXNlcm5hbWUoKSArIFwiIGZhaWxlZCB0byBzaWduaW5cIik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VzdG9tQ2hhbGxlbmdlOiBmdW5jdGlvbiAoY2hhbGxlbmdlUGFyYW0pIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25JbiBjdXN0b20gY2hhbGxlbmdlIGFuc3dlciByZXF1aXJlZCcpO1xuICAgICAgICAgICAgICAgIHVzZXJbJ2NoYWxsZW5nZU5hbWUnXSA9ICdDVVNUT01fQ0hBTExFTkdFJztcbiAgICAgICAgICAgICAgICB1c2VyWydjaGFsbGVuZ2VQYXJhbSddID0gY2hhbGxlbmdlUGFyYW07XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZmFSZXF1aXJlZDogZnVuY3Rpb24gKGNoYWxsZW5nZU5hbWUsIGNoYWxsZW5nZVBhcmFtKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdzaWduSW4gTUZBIHJlcXVpcmVkJyk7XG4gICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICB1c2VyWydjaGFsbGVuZ2VQYXJhbSddID0gY2hhbGxlbmdlUGFyYW07XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZmFTZXR1cDogZnVuY3Rpb24gKGNoYWxsZW5nZU5hbWUsIGNoYWxsZW5nZVBhcmFtKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdzaWduSW4gbWZhIHNldHVwJywgY2hhbGxlbmdlTmFtZSk7XG4gICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICB1c2VyWydjaGFsbGVuZ2VQYXJhbSddID0gY2hhbGxlbmdlUGFyYW07XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBuZXdQYXNzd29yZFJlcXVpcmVkOiBmdW5jdGlvbiAodXNlckF0dHJpYnV0ZXMsIHJlcXVpcmVkQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnc2lnbkluIG5ldyBwYXNzd29yZCcpO1xuICAgICAgICAgICAgICAgIHVzZXJbJ2NoYWxsZW5nZU5hbWUnXSA9ICdORVdfUEFTU1dPUkRfUkVRVUlSRUQnO1xuICAgICAgICAgICAgICAgIHVzZXJbJ2NoYWxsZW5nZVBhcmFtJ10gPSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJBdHRyaWJ1dGVzOiB1c2VyQXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRBdHRyaWJ1dGVzOiByZXF1aXJlZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvdHBSZXF1aXJlZDogZnVuY3Rpb24gKGNoYWxsZW5nZU5hbWUsIGNoYWxsZW5nZVBhcmFtKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdzaWduSW4gdG90cFJlcXVpcmVkJyk7XG4gICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICB1c2VyWydjaGFsbGVuZ2VQYXJhbSddID0gY2hhbGxlbmdlUGFyYW07XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZWxlY3RNRkFUeXBlOiBmdW5jdGlvbiAoY2hhbGxlbmdlTmFtZSwgY2hhbGxlbmdlUGFyYW0pIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25JbiBzZWxlY3RNRkFUeXBlJywgY2hhbGxlbmdlTmFtZSk7XG4gICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICB1c2VyWydjaGFsbGVuZ2VQYXJhbSddID0gY2hhbGxlbmdlUGFyYW07XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTaWduIGluIHdpdGggYSBwYXNzd29yZFxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBdXRoZW50aWNhdGlvbkRldGFpbHN9IGF1dGhEZXRhaWxzIC0gdGhlIHVzZXIgc2lnbiBpbiBkYXRhXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyB0aGUgQ29nbml0b1VzZXIgb2JqZWN0IGlmIHN1Y2Nlc3Mgb3IgbWZhIHJlcXVpcmVkXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5zaWduSW5XaXRoUGFzc3dvcmQgPSBmdW5jdGlvbiAoYXV0aERldGFpbHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ1NpZ25Jbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQZW5kaW5nIHNpZ24taW4gYXR0ZW1wdCBhbHJlYWR5IGluIHByb2dyZXNzJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVzZXIgPSB0aGlzLmNyZWF0ZUNvZ25pdG9Vc2VyKGF1dGhEZXRhaWxzLmdldFVzZXJuYW1lKCkpO1xuICAgICAgICB0aGlzLnBlbmRpbmdTaWduSW4gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB1c2VyLmF1dGhlbnRpY2F0ZVVzZXIoYXV0aERldGFpbHMsIF90aGlzLmF1dGhDYWxsYmFja3ModXNlciwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMucGVuZGluZ1NpZ25JbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wZW5kaW5nU2lnbkluID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVuZGluZ1NpZ25JbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNpZ24gaW4gd2l0aG91dCBhIHBhc3N3b3JkXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0F1dGhlbnRpY2F0aW9uRGV0YWlsc30gYXV0aERldGFpbHMgLSB0aGUgdXNlciBzaWduIGluIGRhdGFcbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIHRoZSBDb2duaXRvVXNlciBvYmplY3QgaWYgc3VjY2VzcyBvciBtZmEgcmVxdWlyZWRcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnNpZ25JbldpdGhvdXRQYXNzd29yZCA9IGZ1bmN0aW9uIChhdXRoRGV0YWlscykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdXNlciA9IHRoaXMuY3JlYXRlQ29nbml0b1VzZXIoYXV0aERldGFpbHMuZ2V0VXNlcm5hbWUoKSk7XG4gICAgICAgIHVzZXIuc2V0QXV0aGVudGljYXRpb25GbG93VHlwZSgnQ1VTVE9NX0FVVEgnKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHVzZXIuaW5pdGlhdGVBdXRoKGF1dGhEZXRhaWxzLCBfdGhpcy5hdXRoQ2FsbGJhY2tzKHVzZXIsIHJlc29sdmUsIHJlamVjdCkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgd2FzIHByZXZpb3VzbHkgdXNlZCBieSBhbiBhdXRoZW50aWNhdGVkIHVzZXIgdG8gZ2V0IE1GQU9wdGlvbnMsXG4gICAgICogYnV0IG5vIGxvbmdlciByZXR1cm5zIGEgbWVhbmluZ2Z1bCByZXNwb25zZS4gUmVmZXIgdG8gdGhlIGRvY3VtZW50YXRpb24gZm9yXG4gICAgICogaG93IHRvIHNldHVwIGFuZCB1c2UgTUZBOiBodHRwczovL2RvY3MuYW1wbGlmeS5hd3MvbGliL2F1dGgvbWZhL3EvcGxhdGZvcm0vanNcbiAgICAgKiBAZGVwcmVjYXRlZFxuICAgICAqIEBwYXJhbSB7Q29nbml0b1VzZXJ9IHVzZXIgLSB0aGUgY3VycmVudCB1c2VyXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyB0aGUgY3VycmVudCBwcmVmZXJyZWQgbWZhIG9wdGlvbiBpZiBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5nZXRNRkFPcHRpb25zID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgdXNlci5nZXRNRkFPcHRpb25zKGZ1bmN0aW9uIChlcnIsIG1mYU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZ2V0IE1GQSBPcHRpb25zIGZhaWxlZCcsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZ2V0IE1GQSBvcHRpb25zIHN1Y2Nlc3MnLCBtZmFPcHRpb25zKTtcbiAgICAgICAgICAgICAgICByZXMobWZhT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogZ2V0IHByZWZlcnJlZCBtZmEgbWV0aG9kXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gdXNlciAtIHRoZSBjdXJyZW50IGNvZ25pdG8gdXNlclxuICAgICAqIEBwYXJhbSB7R2V0UHJlZmVycmVkTUZBT3B0c30gcGFyYW1zIC0gb3B0aW9ucyBmb3IgZ2V0dGluZyB0aGUgY3VycmVudCB1c2VyIHByZWZlcnJlZCBNRkFcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmdldFByZWZlcnJlZE1GQSA9IGZ1bmN0aW9uICh1c2VyLCBwYXJhbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICB2YXIgY2xpZW50TWV0YWRhdGEgPSBfdGhpcy5fY29uZmlnLmNsaWVudE1ldGFkYXRhOyAvLyBUT0RPOiB2ZXJpZnkgYmVoYXZpb3IgaWYgdGhpcyBpcyBvdmVycmlkZSBkdXJpbmcgc2lnbkluXG4gICAgICAgICAgICB2YXIgYnlwYXNzQ2FjaGUgPSBwYXJhbXMgPyBwYXJhbXMuYnlwYXNzQ2FjaGUgOiBmYWxzZTtcbiAgICAgICAgICAgIHVzZXIuZ2V0VXNlckRhdGEoZnVuY3Rpb24gKGVyciwgZGF0YSkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjbGVhblVwRXJyb3JfMSwgbWZhVHlwZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycikgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXR0aW5nIHByZWZlcnJlZCBtZmEgZmFpbGVkJywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTZXNzaW9uSW52YWxpZChlcnIpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsZWFuVXBJbnZhbGlkU2Vzc2lvbih1c2VyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXBFcnJvcl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgRXJyb3IoXCJTZXNzaW9uIGlzIGludmFsaWQgZHVlIHRvOiBcIiArIGVyci5tZXNzYWdlICsgXCIgYW5kIGZhaWxlZCB0byBjbGVhbiB1cCBpbnZhbGlkIHNlc3Npb246IFwiICsgY2xlYW5VcEVycm9yXzEubWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWZhVHlwZSA9IHRoYXQuX2dldE1mYVR5cGVGcm9tVXNlckRhdGEoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtZmFUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaignaW52YWxpZCBNRkEgVHlwZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMobWZhVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSwgeyBieXBhc3NDYWNoZTogYnlwYXNzQ2FjaGUsIGNsaWVudE1ldGFkYXRhOiBjbGllbnRNZXRhZGF0YSB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLl9nZXRNZmFUeXBlRnJvbVVzZXJEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIHJldCA9IG51bGw7XG4gICAgICAgIHZhciBwcmVmZXJyZWRNRkEgPSBkYXRhLlByZWZlcnJlZE1mYVNldHRpbmc7XG4gICAgICAgIC8vIGlmIHRoZSB1c2VyIGhhcyB1c2VkIEF1dGguc2V0UHJlZmVycmVkTUZBKCkgdG8gc2V0dXAgdGhlIG1mYSB0eXBlXG4gICAgICAgIC8vIHRoZW4gdGhlIFwiUHJlZmVycmVkTWZhU2V0dGluZ1wiIHdvdWxkIGV4aXN0IGluIHRoZSByZXNwb25zZVxuICAgICAgICBpZiAocHJlZmVycmVkTUZBKSB7XG4gICAgICAgICAgICByZXQgPSBwcmVmZXJyZWRNRkE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiBtZmFMaXN0IGV4aXN0cyBidXQgZW1wdHksIHRoZW4gaXRzIG5vTUZBXG4gICAgICAgICAgICB2YXIgbWZhTGlzdCA9IGRhdGEuVXNlck1GQVNldHRpbmdMaXN0O1xuICAgICAgICAgICAgaWYgKCFtZmFMaXN0KSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgU01TIHdhcyBlbmFibGVkIGJ5IHVzaW5nIEF1dGguZW5hYmxlU01TKCksXG4gICAgICAgICAgICAgICAgLy8gdGhlIHJlc3BvbnNlIHdvdWxkIGNvbnRhaW4gTUZBT3B0aW9uc1xuICAgICAgICAgICAgICAgIC8vIGFzIGZvciBub3cgQ29nbml0byBvbmx5IHN1cHBvcnRzIGZvciBTTVMsIHNvIHdlIHdpbGwgc2F5IGl0IGlzICdTTVNfTUZBJ1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGRvZXMgbm90IGV4aXN0LCB0aGVuIGl0IHNob3VsZCBiZSBOT01GQVxuICAgICAgICAgICAgICAgIHZhciBNRkFPcHRpb25zID0gZGF0YS5NRkFPcHRpb25zO1xuICAgICAgICAgICAgICAgIGlmIChNRkFPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldCA9ICdTTVNfTUZBJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldCA9ICdOT01GQSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWZhTGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXQgPSAnTk9NRkEnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdpbnZhbGlkIGNhc2UgZm9yIGdldFByZWZlcnJlZE1GQScsIGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLl9nZXRVc2VyRGF0YSA9IGZ1bmN0aW9uICh1c2VyLCBwYXJhbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgdXNlci5nZXRVc2VyRGF0YShmdW5jdGlvbiAoZXJyLCBkYXRhKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsZWFuVXBFcnJvcl8yO1xuICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2dldHRpbmcgdXNlciBkYXRhIGZhaWxlZCcsIGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU2Vzc2lvbkludmFsaWQoZXJyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGVhblVwSW52YWxpZFNlc3Npb24odXNlcildO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhblVwRXJyb3JfMiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IEVycm9yKFwiU2Vzc2lvbiBpcyBpbnZhbGlkIGR1ZSB0bzogXCIgKyBlcnIubWVzc2FnZSArIFwiIGFuZCBmYWlsZWQgdG8gY2xlYW4gdXAgaW52YWxpZCBzZXNzaW9uOiBcIiArIGNsZWFuVXBFcnJvcl8yLm1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7IH0sIHBhcmFtcyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogc2V0IHByZWZlcnJlZCBNRkEgbWV0aG9kXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gdXNlciAtIHRoZSBjdXJyZW50IENvZ25pdG8gdXNlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtZmFNZXRob2QgLSBwcmVmZXJyZWQgbWZhIG1ldGhvZFxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZSBpZiBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5zZXRQcmVmZXJyZWRNRkEgPSBmdW5jdGlvbiAodXNlciwgbWZhTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjbGllbnRNZXRhZGF0YSwgdXNlckRhdGEsIHNtc01mYVNldHRpbmdzLCB0b3RwTWZhU2V0dGluZ3MsIF9hLCBtZmFMaXN0LCBjdXJyZW50TUZBVHlwZSwgdGhhdDtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2dldFVzZXJEYXRhKHVzZXIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnlwYXNzQ2FjaGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudE1ldGFkYXRhOiBjbGllbnRNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJEYXRhID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc21zTWZhU2V0dGluZ3MgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG90cE1mYVNldHRpbmdzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gbWZhTWV0aG9kO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1RPVFAnOiByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdTT0ZUV0FSRV9UT0tFTl9NRkEnOiByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdTTVMnOiByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdTTVNfTUZBJzogcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnTk9NRkEnOiByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RwTWZhU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJlZmVycmVkTWZhOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNtc01mYVNldHRpbmdzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByZWZlcnJlZE1mYTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBFbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBtZmFMaXN0ID0gdXNlckRhdGFbJ1VzZXJNRkFTZXR0aW5nTGlzdCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fZ2V0TWZhVHlwZUZyb21Vc2VyRGF0YSh1c2VyRGF0YSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TUZBVHlwZSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TUZBVHlwZSA9PT0gJ05PTUZBJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBQcm9taXNlLnJlc29sdmUoJ05vIGNoYW5nZSBmb3IgbWZhIHR5cGUnKV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50TUZBVHlwZSA9PT0gJ1NNU19NRkEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc21zTWZhU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByZWZlcnJlZE1mYTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50TUZBVHlwZSA9PT0gJ1NPRlRXQVJFX1RPS0VOX01GQScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RwTWZhU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByZWZlcnJlZE1mYTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5yZWplY3RBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuSW52YWxpZE1GQSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSBVc2VyTUZBU2V0dGluZ0xpc3QgaW4gdGhlIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGRpc2FibGUgZXZlcnkgbWZhIHR5cGUgaW4gdGhhdCBsaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWZhTGlzdCAmJiBtZmFMaXN0Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIGRpc2FibGUgU01TIG9yIFRPVFAgaWYgZXhpc3RzIGluIHRoYXQgbGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1mYUxpc3QuZm9yRWFjaChmdW5jdGlvbiAobWZhVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWZhVHlwZSA9PT0gJ1NNU19NRkEnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbXNNZmFTZXR0aW5ncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcmVmZXJyZWRNZmE6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChtZmFUeXBlID09PSAnU09GVFdBUkVfVE9LRU5fTUZBJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90cE1mYVNldHRpbmdzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByZWZlcnJlZE1mYTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdubyB2YWxpZG1mYSBtZXRob2QgcHJvdmlkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnJlamVjdEF1dGhFcnJvcihBdXRoRXJyb3JUeXBlcy5Ob01GQSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5zZXRVc2VyTWZhUHJlZmVyZW5jZShzbXNNZmFTZXR0aW5ncywgdG90cE1mYVNldHRpbmdzLCBmdW5jdGlvbiAoZXJyLCByZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1NldCB1c2VyIG1mYSBwcmVmZXJlbmNlIGVycm9yJywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1NldCB1c2VyIG1mYSBzdWNjZXNzJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnQ2FjaGluZyB0aGUgbGF0ZXN0IHVzZXIgZGF0YSBpbnRvIGxvY2FsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWNoZSB0aGUgbGF0ZXN0IHJlc3VsdCBpbnRvIHVzZXIgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5nZXRVc2VyRGF0YShmdW5jdGlvbiAoZXJyLCBkYXRhKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsZWFuVXBFcnJvcl8zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2dldHRpbmcgdXNlciBkYXRhIGZhaWxlZCcsIGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU2Vzc2lvbkludmFsaWQoZXJyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGVhblVwSW52YWxpZFNlc3Npb24odXNlcildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhblVwRXJyb3JfMyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IEVycm9yKFwiU2Vzc2lvbiBpcyBpbnZhbGlkIGR1ZSB0bzogXCIgKyBlcnIubWVzc2FnZSArIFwiIGFuZCBmYWlsZWQgdG8gY2xlYW4gdXAgaW52YWxpZCBzZXNzaW9uOiBcIiArIGNsZWFuVXBFcnJvcl8zLm1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCByZWooZXJyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovLCByZXMocmVzdWx0KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnlwYXNzQ2FjaGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50TWV0YWRhdGE6IGNsaWVudE1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBkaXNhYmxlIFNNU1xuICAgICAqIEBkZXByZWNhdGVkXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gdXNlciAtIHRoZSBjdXJyZW50IHVzZXJcbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIGlzIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmRpc2FibGVTTVMgPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICB1c2VyLmRpc2FibGVNRkEoZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdkaXNhYmxlIG1mYSBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2Rpc2FibGUgbWZhIHN1Y2NlZWQnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICByZXMoZGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogZW5hYmxlIFNNU1xuICAgICAqIEBkZXByZWNhdGVkXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gdXNlciAtIHRoZSBjdXJyZW50IHVzZXJcbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIGlzIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmVuYWJsZVNNUyA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICAgICAgICAgIHVzZXIuZW5hYmxlTUZBKGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZW5hYmxlIG1mYSBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2VuYWJsZSBtZmEgc3VjY2VlZCcsIGRhdGEpO1xuICAgICAgICAgICAgICAgIHJlcyhkYXRhKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZXR1cCBUT1RQXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gdXNlciAtIHRoZSBjdXJyZW50IHVzZXJcbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIHdpdGggdGhlIHNlY3JldCBjb2RlIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnNldHVwVE9UUCA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICAgICAgICAgIHVzZXIuYXNzb2NpYXRlU29mdHdhcmVUb2tlbih7XG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnYXNzb2NpYXRlU29mdHdhcmVUb2tlbiBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYXNzb2NpYXRlU2VjcmV0Q29kZTogZnVuY3Rpb24gKHNlY3JldENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdhc3NvY2lhdGVTb2Z0d2FyZVRva2VuIHN1Y2VzcycsIHNlY3JldENvZGUpO1xuICAgICAgICAgICAgICAgICAgICByZXMoc2VjcmV0Q29kZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogdmVyaWZ5IFRPVFAgc2V0dXBcbiAgICAgKiBAcGFyYW0ge0NvZ25pdG9Vc2VyfSB1c2VyIC0gdGhlIGN1cnJlbnQgdXNlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFsbGVuZ2VBbnN3ZXIgLSBjaGFsbGVuZ2UgYW5zd2VyXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyBpcyBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS52ZXJpZnlUb3RwVG9rZW4gPSBmdW5jdGlvbiAodXNlciwgY2hhbGxlbmdlQW5zd2VyKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygndmVyaWZpY2F0aW9uIHRvdHAgdG9rZW4nLCB1c2VyLCBjaGFsbGVuZ2VBbnN3ZXIpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICB1c2VyLnZlcmlmeVNvZnR3YXJlVG9rZW4oY2hhbGxlbmdlQW5zd2VyLCAnTXkgVE9UUCBkZXZpY2UnLCB7XG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygndmVyaWZ5VG90cFRva2VuIGZhaWxlZCcsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdzaWduSW4nLCB1c2VyLCBcIkEgdXNlciBcIiArIHVzZXIuZ2V0VXNlcm5hbWUoKSArIFwiIGhhcyBiZWVuIHNpZ25lZCBpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCd2ZXJpZnlUb3RwVG9rZW4gc3VjY2VzcycsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZXMoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2VuZCBNRkEgY29kZSB0byBjb25maXJtIHNpZ24gaW5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdXNlciAtIFRoZSBDb2duaXRvVXNlciBvYmplY3RcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29kZSAtIFRoZSBjb25maXJtYXRpb24gY29kZVxuICAgICAqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuY29uZmlybVNpZ25JbiA9IGZ1bmN0aW9uICh1c2VyLCBjb2RlLCBtZmFUeXBlLCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoY2xpZW50TWV0YWRhdGEgPT09IHZvaWQgMCkgeyBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgfVxuICAgICAgICBpZiAoIWNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlamVjdEF1dGhFcnJvcihBdXRoRXJyb3JUeXBlcy5FbXB0eUNvZGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHVzZXIuc2VuZE1GQUNvZGUoY29kZSwge1xuICAgICAgICAgICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gKHNlc3Npb24pIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNyZWQsIGVfMztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHNlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDQsIDUsIDZdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5DcmVkZW50aWFscy5jbGVhcigpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5DcmVkZW50aWFscy5zZXQoc2Vzc2lvbiwgJ3Nlc3Npb24nKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3N1Y2NlZWQgdG8gZ2V0IGNvZ25pdG8gY3JlZGVudGlhbHMnLCBjcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzMgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY2Fubm90IGdldCBjb2duaXRvIGNyZWRlbnRpYWxzJywgZV8zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnc2lnbkluJywgdXNlciwgXCJBIHVzZXIgXCIgKyB1c2VyLmdldFVzZXJuYW1lKCkgKyBcIiBoYXMgYmVlbiBzaWduZWQgaW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pOyB9LFxuICAgICAgICAgICAgICAgIG9uRmFpbHVyZTogZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2NvbmZpcm0gc2lnbkluIGZhaWx1cmUnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSwgbWZhVHlwZSwgY2xpZW50TWV0YWRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuY29tcGxldGVOZXdQYXNzd29yZCA9IGZ1bmN0aW9uICh1c2VyLCBwYXNzd29yZCwgcmVxdWlyZWRBdHRyaWJ1dGVzLCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAocmVxdWlyZWRBdHRyaWJ1dGVzID09PSB2b2lkIDApIHsgcmVxdWlyZWRBdHRyaWJ1dGVzID0ge307IH1cbiAgICAgICAgaWYgKGNsaWVudE1ldGFkYXRhID09PSB2b2lkIDApIHsgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7IH1cbiAgICAgICAgaWYgKCFwYXNzd29yZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5UGFzc3dvcmQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHVzZXIuY29tcGxldGVOZXdQYXNzd29yZENoYWxsZW5nZShwYXNzd29yZCwgcmVxdWlyZWRBdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAoc2Vzc2lvbikgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3JlZCwgZV80O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoc2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNCwgNSwgNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLmNsZWFyKCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLnNldChzZXNzaW9uLCAnc2Vzc2lvbicpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnc3VjY2VlZCB0byBnZXQgY29nbml0byBjcmVkZW50aWFscycsIGNyZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfNCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdjYW5ub3QgZ2V0IGNvZ25pdG8gY3JlZGVudGlhbHMnLCBlXzQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQudXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdzaWduSW4nLCB1c2VyLCBcIkEgdXNlciBcIiArIHVzZXIuZ2V0VXNlcm5hbWUoKSArIFwiIGhhcyBiZWVuIHNpZ25lZCBpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7IH0sXG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY29tcGxldGVOZXdQYXNzd29yZCBmYWlsdXJlJywgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2NvbXBsZXRlTmV3UGFzc3dvcmRfZmFpbHVyZScsIGVyciwgX3RoaXMudXNlciArIFwiIGZhaWxlZCB0byBjb21wbGV0ZSB0aGUgbmV3IHBhc3N3b3JkIGZsb3dcIik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWZhUmVxdWlyZWQ6IGZ1bmN0aW9uIChjaGFsbGVuZ2VOYW1lLCBjaGFsbGVuZ2VQYXJhbSkge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25JbiBNRkEgcmVxdWlyZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlUGFyYW0nXSA9IGNoYWxsZW5nZVBhcmFtO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWZhU2V0dXA6IGZ1bmN0aW9uIChjaGFsbGVuZ2VOYW1lLCBjaGFsbGVuZ2VQYXJhbSkge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3NpZ25JbiBtZmEgc2V0dXAnLCBjaGFsbGVuZ2VOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlTmFtZSddID0gY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdXNlclsnY2hhbGxlbmdlUGFyYW0nXSA9IGNoYWxsZW5nZVBhcmFtO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdG90cFJlcXVpcmVkOiBmdW5jdGlvbiAoY2hhbGxlbmdlTmFtZSwgY2hhbGxlbmdlUGFyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdzaWduSW4gbWZhIHNldHVwJywgY2hhbGxlbmdlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJbJ2NoYWxsZW5nZU5hbWUnXSA9IGNoYWxsZW5nZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJbJ2NoYWxsZW5nZVBhcmFtJ10gPSBjaGFsbGVuZ2VQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSwgY2xpZW50TWV0YWRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNlbmQgdGhlIGFuc3dlciB0byBhIGN1c3RvbSBjaGFsbGVuZ2VcbiAgICAgKiBAcGFyYW0ge0NvZ25pdG9Vc2VyfSB1c2VyIC0gVGhlIENvZ25pdG9Vc2VyIG9iamVjdFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFsbGVuZ2VSZXNwb25zZXMgLSBUaGUgY29uZmlybWF0aW9uIGNvZGVcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnNlbmRDdXN0b21DaGFsbGVuZ2VBbnN3ZXIgPSBmdW5jdGlvbiAodXNlciwgY2hhbGxlbmdlUmVzcG9uc2VzLCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoY2xpZW50TWV0YWRhdGEgPT09IHZvaWQgMCkgeyBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgfVxuICAgICAgICBpZiAoIXRoaXMudXNlclBvb2wpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlamVjdE5vVXNlclBvb2woKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNoYWxsZW5nZVJlc3BvbnNlcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5Q2hhbGxlbmdlUmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHVzZXIuc2VuZEN1c3RvbUNoYWxsZW5nZUFuc3dlcihjaGFsbGVuZ2VSZXNwb25zZXMsIF90aGlzLmF1dGhDYWxsYmFja3ModXNlciwgcmVzb2x2ZSwgcmVqZWN0KSwgY2xpZW50TWV0YWRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIERlbGV0ZSBhbiBhdXRoZW50aWNhdGVkIHVzZXJzJyBhdHRyaWJ1dGVzXG4gICAgICogQHBhcmFtIHtDb2duaXRvVXNlcn0gLSBUaGUgY3VycmVudGx5IGxvZ2dlZCBpbiB1c2VyIG9iamVjdFxuICAgICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAgICoqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuZGVsZXRlVXNlckF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAodXNlciwgYXR0cmlidXRlTmFtZXMpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdGhhdC51c2VyU2Vzc2lvbih1c2VyKS50aGVuKGZ1bmN0aW9uIChzZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgdXNlci5kZWxldGVBdHRyaWJ1dGVzKGF0dHJpYnV0ZU5hbWVzLCBmdW5jdGlvbiAoZXJyLCByZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSBjdXJyZW50IGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAgICoqL1xuICAgIC8vIFRPRE86IENoZWNrIHJldHVybiB0eXBlIHZvaWRcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmRlbGV0ZVVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlXzUsIGlzU2lnbmVkSW5Ib3N0ZWRVSTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc3RvcmFnZVN5bmNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgZV81ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gc3luYyBjYWNoZSBpbmZvIGludG8gbWVtb3J5JywgZV81KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlXzUpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1NpZ25lZEluSG9zdGVkVUkgPSB0aGlzLl9vQXV0aEhhbmRsZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdG9yYWdlLmdldEl0ZW0oJ2FtcGxpZnktc2lnbmluLXdpdGgtaG9zdGVkVUknKSA9PT0gJ3RydWUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcl8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51c2VyUG9vbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfMSA9IHRoaXMudXNlclBvb2wuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXJfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZhaWxlZCB0byBnZXQgdXNlciBmcm9tIHVzZXIgcG9vbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVqKG5ldyBFcnJvcignTm8gY3VycmVudCB1c2VyLicpKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyXzEuZ2V0U2Vzc2lvbihmdW5jdGlvbiAoZXJyLCBzZXNzaW9uKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xlYW5VcEVycm9yXzQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnIpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gZ2V0IHRoZSB1c2VyIHNlc3Npb24nLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU2Vzc2lvbkludmFsaWQoZXJyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsZWFuVXBJbnZhbGlkU2Vzc2lvbih1c2VyXzEpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXBFcnJvcl80ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKG5ldyBFcnJvcihcIlNlc3Npb24gaXMgaW52YWxpZCBkdWUgdG86IFwiICsgZXJyLm1lc3NhZ2UgKyBcIiBhbmQgZmFpbGVkIHRvIGNsZWFuIHVwIGludmFsaWQgc2Vzc2lvbjogXCIgKyBjbGVhblVwRXJyb3JfNC5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlaihlcnIpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl8xLmRlbGV0ZVVzZXIoZnVuY3Rpb24gKGVyciwgcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCd1c2VyRGVsZXRlZCcsIHJlc3VsdCwgJ1RoZSBhdXRoZW50aWNhdGVkIHVzZXIgaGFzIGJlZW4gZGVsZXRlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl8xLnNpZ25PdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudXNlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jbGVhbkNhY2hlZEl0ZW1zKCk7IC8vIGNsZWFuIGF3cyBjcmVkZW50aWFsc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBjaGFuZ2UgdG8gcmVqZWN0cyBpbiByZWZhY3RvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdmYWlsZWQgdG8gY2xlYXIgY2FjaGVkIGl0ZW1zJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2lnbmVkSW5Ib3N0ZWRVSSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub0F1dGhTaWduT3V0UmVkaXJlY3QocmVzLCByZWopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3NpZ25PdXQnLCBfdGhpcy51c2VyLCBcIkEgdXNlciBoYXMgYmVlbiBzaWduZWQgb3V0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ25vIENvbmdpdG8gVXNlciBwb29sJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKG5ldyBFcnJvcignQ29nbml0byBVc2VyIHBvb2wgZG9lcyBub3QgZXhpc3QnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlIGFuIGF1dGhlbnRpY2F0ZWQgdXNlcnMnIGF0dHJpYnV0ZXNcbiAgICAgKiBAcGFyYW0ge0NvZ25pdG9Vc2VyfSAtIFRoZSBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIgb2JqZWN0XG4gICAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICAgKiovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS51cGRhdGVVc2VyQXR0cmlidXRlcyA9IGZ1bmN0aW9uICh1c2VyLCBhdHRyaWJ1dGVzLCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICBpZiAoY2xpZW50TWV0YWRhdGEgPT09IHZvaWQgMCkgeyBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgfVxuICAgICAgICB2YXIgYXR0cmlidXRlTGlzdCA9IFtdO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0aGF0LnVzZXJTZXNzaW9uKHVzZXIpLnRoZW4oZnVuY3Rpb24gKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAnc3ViJyAmJiBrZXkuaW5kZXhPZignX3ZlcmlmaWVkJykgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0ciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU6IGF0dHJpYnV0ZXNba2V5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0LnB1c2goYXR0cik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdXNlci51cGRhdGVBdHRyaWJ1dGVzKGF0dHJpYnV0ZUxpc3QsIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgY2xpZW50TWV0YWRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHVzZXIgYXR0cmlidXRlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB1c2VyIC0gVGhlIENvZ25pdG9Vc2VyIG9iamVjdFxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdG8gdXNlciBhdHRyaWJ1dGVzIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnVzZXJBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLnVzZXJTZXNzaW9uKHVzZXIpLnRoZW4oZnVuY3Rpb24gKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgICB1c2VyLmdldFVzZXJBdHRyaWJ1dGVzKGZ1bmN0aW9uIChlcnIsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnZlcmlmaWVkQ29udGFjdCA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlckF0dHJpYnV0ZXModXNlcikudGhlbihmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdmFyIGF0dHJzID0gdGhhdC5hdHRyaWJ1dGVzVG9PYmplY3QoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICB2YXIgdW52ZXJpZmllZCA9IHt9O1xuICAgICAgICAgICAgdmFyIHZlcmlmaWVkID0ge307XG4gICAgICAgICAgICBpZiAoYXR0cnNbJ2VtYWlsJ10pIHtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cnNbJ2VtYWlsX3ZlcmlmaWVkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgdmVyaWZpZWRbJ2VtYWlsJ10gPSBhdHRyc1snZW1haWwnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVudmVyaWZpZWRbJ2VtYWlsJ10gPSBhdHRyc1snZW1haWwnXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cnNbJ3Bob25lX251bWJlciddKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzWydwaG9uZV9udW1iZXJfdmVyaWZpZWQnXSkge1xuICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZFsncGhvbmVfbnVtYmVyJ10gPSBhdHRyc1sncGhvbmVfbnVtYmVyJ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1bnZlcmlmaWVkWydwaG9uZV9udW1iZXInXSA9IGF0dHJzWydwaG9uZV9udW1iZXInXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZlcmlmaWVkOiB2ZXJpZmllZCxcbiAgICAgICAgICAgICAgICB1bnZlcmlmaWVkOiB1bnZlcmlmaWVkLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmlzRXJyb3JXaXRoTWVzc2FnZSA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgcmV0dXJuICh0eXBlb2YgZXJyID09PSAnb2JqZWN0JyAmJlxuICAgICAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGVyciwgJ21lc3NhZ2UnKSk7XG4gICAgfTtcbiAgICAvLyBTZXNzaW9uIHJldm9rZWQgYnkgYW5vdGhlciBhcHBcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmlzVG9rZW5SZXZva2VkRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pc0Vycm9yV2l0aE1lc3NhZ2UoZXJyKSAmJlxuICAgICAgICAgICAgZXJyLm1lc3NhZ2UgPT09ICdBY2Nlc3MgVG9rZW4gaGFzIGJlZW4gcmV2b2tlZCcpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc1JlZnJlc2hUb2tlblJldm9rZWRFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmlzRXJyb3JXaXRoTWVzc2FnZShlcnIpICYmXG4gICAgICAgICAgICBlcnIubWVzc2FnZSA9PT0gJ1JlZnJlc2ggVG9rZW4gaGFzIGJlZW4gcmV2b2tlZCcpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc1VzZXJEaXNhYmxlZEVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0Vycm9yV2l0aE1lc3NhZ2UoZXJyKSAmJiBlcnIubWVzc2FnZSA9PT0gJ1VzZXIgaXMgZGlzYWJsZWQuJztcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuaXNVc2VyRG9lc05vdEV4aXN0RXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pc0Vycm9yV2l0aE1lc3NhZ2UoZXJyKSAmJiBlcnIubWVzc2FnZSA9PT0gJ1VzZXIgZG9lcyBub3QgZXhpc3QuJyk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmlzUmVmcmVzaFRva2VuRXhwaXJlZEVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZXR1cm4gKHRoaXMuaXNFcnJvcldpdGhNZXNzYWdlKGVycikgJiZcbiAgICAgICAgICAgIGVyci5tZXNzYWdlID09PSAnUmVmcmVzaCBUb2tlbiBoYXMgZXhwaXJlZCcpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc1NpZ25lZEluSG9zdGVkVUkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5fb0F1dGhIYW5kbGVyICYmXG4gICAgICAgICAgICB0aGlzLl9zdG9yYWdlLmdldEl0ZW0oJ2FtcGxpZnktc2lnbmluLXdpdGgtaG9zdGVkVUknKSA9PT0gJ3RydWUnKTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuaXNTZXNzaW9uSW52YWxpZCA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmlzVXNlckRpc2FibGVkRXJyb3IoZXJyKSB8fFxuICAgICAgICAgICAgdGhpcy5pc1VzZXJEb2VzTm90RXhpc3RFcnJvcihlcnIpIHx8XG4gICAgICAgICAgICB0aGlzLmlzVG9rZW5SZXZva2VkRXJyb3IoZXJyKSB8fFxuICAgICAgICAgICAgdGhpcy5pc1JlZnJlc2hUb2tlblJldm9rZWRFcnJvcihlcnIpIHx8XG4gICAgICAgICAgICB0aGlzLmlzUmVmcmVzaFRva2VuRXhwaXJlZEVycm9yKGVycikpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jbGVhblVwSW52YWxpZFNlc3Npb24gPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZV82O1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIuc2lnbk91dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xlYW5DYWNoZWRJdGVtcygpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpOyAvLyBjbGVhbiBhd3MgY3JlZGVudGlhbHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzYgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2ZhaWxlZCB0byBjbGVhciBjYWNoZWQgaXRlbXMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1NpZ25lZEluSG9zdGVkVUkoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9BdXRoU2lnbk91dFJlZGlyZWN0KHJlcywgcmVqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3NpZ25PdXQnLCB0aGlzLnVzZXIsIFwiQSB1c2VyIGhhcyBiZWVuIHNpZ25lZCBvdXRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyB0byBjdXJyZW50IGF1dGhlbnRpY2F0ZWQgQ29nbml0b1VzZXIgaWYgc3VjY2Vzc1xuICAgICAqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuY3VycmVudFVzZXJQb29sVXNlciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLnVzZXJQb29sKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3ROb1VzZXJQb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgX3RoaXMuX3N0b3JhZ2VTeW5jXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyLCBjbGllbnRNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc09BdXRoSW5Qcm9ncmVzcygpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ09BdXRoIHNpZ25JbiBpbiBwcm9ncmVzcywgd2FpdGluZyBmb3IgcmVzb2x1dGlvbi4uLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ09BdXRoIHNpZ25JbiBpbiBwcm9ncmVzcyB0aW1lb3V0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSHViLnJlbW92ZSgnYXV0aCcsIGhvc3RlZFVJU2lnbkNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIE9BVVRIX0ZMT1dfTVNfVElNRU9VVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdWIubGlzdGVuKCdhdXRoJywgaG9zdGVkVUlTaWduQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaG9zdGVkVUlTaWduQ2FsbGJhY2soX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF5bG9hZCA9IF9hLnBheWxvYWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gcGF5bG9hZC5ldmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT09ICdjb2duaXRvSG9zdGVkVUknIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50ID09PSAnY29nbml0b0hvc3RlZFVJX2ZhaWx1cmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIk9BdXRoIHNpZ25JbiByZXNvbHZlZDogXCIgKyBldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdWIucmVtb3ZlKCdhdXRoJywgaG9zdGVkVUlTaWduQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSB0aGlzLnVzZXJQb29sLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIGdldCB1c2VyIGZyb20gdXNlciBwb29sJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaignTm8gY3VycmVudCB1c2VyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVmcmVzaCB0aGUgc2Vzc2lvbiBpZiB0aGUgc2Vzc2lvbiBleHBpcmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIuZ2V0U2Vzc2lvbihmdW5jdGlvbiAoZXJyLCBzZXNzaW9uKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGVhblVwRXJyb3JfNSwgYnlwYXNzQ2FjaGUsIGNsaWVudE1ldGFkYXRhLCBfYSwgc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gZ2V0IHRoZSB1c2VyIHNlc3Npb24nLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTZXNzaW9uSW52YWxpZChlcnIpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGVhblVwSW52YWxpZFNlc3Npb24odXNlcildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXBFcnJvcl81ID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IEVycm9yKFwiU2Vzc2lvbiBpcyBpbnZhbGlkIGR1ZSB0bzogXCIgKyBlcnIubWVzc2FnZSArIFwiIGFuZCBmYWlsZWQgdG8gY2xlYW4gdXAgaW52YWxpZCBzZXNzaW9uOiBcIiArIGNsZWFuVXBFcnJvcl81Lm1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5cGFzc0NhY2hlID0gcGFyYW1zID8gcGFyYW1zLmJ5cGFzc0NhY2hlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYnlwYXNzQ2FjaGUpIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLmNsZWFyKCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBzZXNzaW9uLmdldEFjY2Vzc1Rva2VuKCkuZGVjb2RlUGF5bG9hZCgpLnNjb3BlLCBzY29wZSA9IF9hID09PSB2b2lkIDAgPyAnJyA6IF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuc3BsaXQoJyAnKS5pbmNsdWRlcyhVU0VSX0FETUlOX1NDT1BFKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5nZXRVc2VyRGF0YShmdW5jdGlvbiAoZXJyLCBkYXRhKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsZWFuVXBFcnJvcl82LCBwcmVmZXJyZWRNRkEsIGF0dHJpYnV0ZUxpc3QsIGksIGF0dHJpYnV0ZSwgdXNlckF0dHJpYnV0ZSwgYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycikgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXR0aW5nIHVzZXIgZGF0YSBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1Nlc3Npb25JbnZhbGlkKGVycikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xlYW5VcEludmFsaWRTZXNzaW9uKHVzZXIpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5VcEVycm9yXzYgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKG5ldyBFcnJvcihcIlNlc3Npb24gaXMgaW52YWxpZCBkdWUgdG86IFwiICsgZXJyLm1lc3NhZ2UgKyBcIiBhbmQgZmFpbGVkIHRvIGNsZWFuIHVwIGludmFsaWQgc2Vzc2lvbjogXCIgKyBjbGVhblVwRXJyb3JfNi5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRNRkEgPSBkYXRhLlByZWZlcnJlZE1mYVNldHRpbmcgfHwgJ05PTUZBJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGRhdGEuVXNlckF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZTogZGF0YS5Vc2VyQXR0cmlidXRlc1tpXS5OYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU6IGRhdGEuVXNlckF0dHJpYnV0ZXNbaV0uVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJBdHRyaWJ1dGUgPSBuZXcgQ29nbml0b1VzZXJBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlTGlzdC5wdXNoKHVzZXJBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzVG9PYmplY3QoYXR0cmlidXRlTGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih1c2VyLCB7IGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXMsIHByZWZlcnJlZE1GQTogcHJlZmVycmVkTUZBIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXModXNlcildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSwgeyBieXBhc3NDYWNoZTogYnlwYXNzQ2FjaGUsIGNsaWVudE1ldGFkYXRhOiBjbGllbnRNZXRhZGF0YSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIlVuYWJsZSB0byBnZXQgdGhlIHVzZXIgZGF0YSBiZWNhdXNlIHRoZSBcIiArIFVTRVJfQURNSU5fU0NPUEUgKyBcIiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpcyBub3QgaW4gdGhlIHNjb3BlcyBvZiB0aGUgYWNjZXNzIHRva2VuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlcyh1c2VyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSwgeyBjbGllbnRNZXRhZGF0YTogY2xpZW50TWV0YWRhdGEgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZhaWxlZCB0byBzeW5jIGNhY2hlIGluZm8gaW50byBtZW1vcnknLCBlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqKGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc09BdXRoSW5Qcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub0F1dGhGbG93SW5Qcm9ncmVzcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgICAqIEBwYXJhbSB7Q3VycmVudFVzZXJPcHRzfSAtIG9wdGlvbnMgZm9yIGdldHRpbmcgdGhlIGN1cnJlbnQgdXNlclxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdG8gY3VycmVudCBhdXRoZW50aWNhdGVkIENvZ25pdG9Vc2VyIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmN1cnJlbnRBdXRoZW50aWNhdGVkVXNlciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZlZGVyYXRlZFVzZXIsIGVfNywgZmVkZXJhdGVkSW5mbywgdXNlciwgZV84O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXR0aW5nIGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmZWRlcmF0ZWRVc2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3N0b3JhZ2VTeW5jXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfNyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIHN5bmMgY2FjaGUgaW5mbyBpbnRvIG1lbW9yeScsIGVfNyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlXzc7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmVkZXJhdGVkSW5mbyA9IEpTT04ucGFyc2UodGhpcy5fc3RvcmFnZS5nZXRJdGVtKCdhd3MtYW1wbGlmeS1mZWRlcmF0ZWRJbmZvJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZWRlcmF0ZWRJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlZGVyYXRlZFVzZXIgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmVkZXJhdGVkSW5mby51c2VyKSwgeyB0b2tlbjogZmVkZXJhdGVkSW5mby50b2tlbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY2Fubm90IGxvYWQgZmVkZXJhdGVkIHVzZXIgZnJvbSBhdXRoIHN0b3JhZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmVkZXJhdGVkVXNlcikgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXIgPSBmZWRlcmF0ZWRVc2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXQgY3VycmVudCBhdXRoZW50aWNhdGVkIGZlZGVyYXRlZCB1c2VyJywgdGhpcy51c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnVzZXJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2dldCBjdXJyZW50IGF1dGhlbnRpY2F0ZWQgdXNlcnBvb2wgdXNlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDY7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbNiwgOCwgLCA5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmN1cnJlbnRVc2VyUG9vbFVzZXIocGFyYW1zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgZV84ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVfOCA9PT0gJ05vIHVzZXJQb29sJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignQ2Fubm90IGdldCB0aGUgY3VycmVudCB1c2VyIGJlY2F1c2UgdGhlIHVzZXIgcG9vbCBpcyBtaXNzaW5nLiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1BsZWFzZSBtYWtlIHN1cmUgdGhlIEF1dGggbW9kdWxlIGlzIGNvbmZpZ3VyZWQgd2l0aCBhIHZhbGlkIENvZ25pdG8gVXNlciBQb29sIElEJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1RoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkIGJ5IHRoZSBlcnJvcicsIGVfOCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZWplY3QoJ1RoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkJyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudXNlcl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgdXNlcidzIHNlc3Npb25cbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIHRvIHNlc3Npb24gb2JqZWN0IGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmN1cnJlbnRTZXNzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnR2V0dGluZyBjdXJyZW50IHNlc3Npb24nKTtcbiAgICAgICAgLy8gUHVycG9zZWx5IG5vdCBjYWxsaW5nIHRoZSByZWplY3QgbWV0aG9kIGhlcmUgYmVjYXVzZSB3ZSBkb24ndCBuZWVkIGEgY29uc29sZSBlcnJvclxuICAgICAgICBpZiAoIXRoaXMudXNlclBvb2wpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ05vIFVzZXIgUG9vbCBpbiB0aGUgY29uZmlndXJhdGlvbi4nKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgdGhhdFxuICAgICAgICAgICAgICAgIC5jdXJyZW50VXNlclBvb2xVc2VyKClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgICAgICAgIHRoYXRcbiAgICAgICAgICAgICAgICAgICAgLnVzZXJTZXNzaW9uKHVzZXIpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcyhzZXNzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZhaWxlZCB0byBnZXQgdGhlIGN1cnJlbnQgc2Vzc2lvbicsIGUpO1xuICAgICAgICAgICAgICAgICAgICByZWooZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gZ2V0IHRoZSBjdXJyZW50IHVzZXInLCBlKTtcbiAgICAgICAgICAgICAgICByZWooZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjb3JyZXNwb25kaW5nIHVzZXIgc2Vzc2lvblxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB1c2VyIC0gVGhlIENvZ25pdG9Vc2VyIG9iamVjdFxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdG8gdGhlIHNlc3Npb25cbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnVzZXJTZXNzaW9uID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3RoZSB1c2VyIGlzIG51bGwnKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlamVjdEF1dGhFcnJvcihBdXRoRXJyb3JUeXBlcy5Ob1VzZXJTZXNzaW9uKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7IC8vIFRPRE86IHZlcmlmeSBiZWhhdmlvciBpZiB0aGlzIGlzIG92ZXJyaWRlIGR1cmluZyBzaWduSW5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdHZXR0aW5nIHRoZSBzZXNzaW9uIGZyb20gdGhpcyB1c2VyOicsIHVzZXIpO1xuICAgICAgICAgICAgdXNlci5nZXRTZXNzaW9uKGZ1bmN0aW9uIChlcnIsIHNlc3Npb24pIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2xlYW5VcEVycm9yXzc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnIpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIGdldCB0aGUgc2Vzc2lvbiBmcm9tIHVzZXInLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTZXNzaW9uSW52YWxpZChlcnIpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsZWFuVXBJbnZhbGlkU2Vzc2lvbih1c2VyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuVXBFcnJvcl83ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgRXJyb3IoXCJTZXNzaW9uIGlzIGludmFsaWQgZHVlIHRvOiBcIiArIGVyci5tZXNzYWdlICsgXCIgYW5kIGZhaWxlZCB0byBjbGVhbiB1cCBpbnZhbGlkIHNlc3Npb246IFwiICsgY2xlYW5VcEVycm9yXzcubWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdTdWNjZWVkIHRvIGdldCB0aGUgdXNlciBzZXNzaW9uJywgc2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHNlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7IH0sIHsgY2xpZW50TWV0YWRhdGE6IGNsaWVudE1ldGFkYXRhIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCBhdXRoZW50aWNhdGVkIGNyZWRlbnRpYWxzIG9mIGN1cnJlbnQgdXNlci5cbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVzIHRvIGJlIGN1cnJlbnQgdXNlcidzIGNyZWRlbnRpYWxzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jdXJyZW50VXNlckNyZWRlbnRpYWxzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZV85LCBmZWRlcmF0ZWRJbmZvO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnR2V0dGluZyBjdXJyZW50IHVzZXIgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3N0b3JhZ2VTeW5jXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfOSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIHN5bmMgY2FjaGUgaW5mbyBpbnRvIG1lbW9yeScsIGVfOSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlXzk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGZlZGVyYXRlZEluZm8gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWRlcmF0ZWRJbmZvID0gSlNPTi5wYXJzZSh0aGlzLl9zdG9yYWdlLmdldEl0ZW0oJ2F3cy1hbXBsaWZ5LWZlZGVyYXRlZEluZm8nKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZmFpbGVkIHRvIGdldCBvciBwYXJzZSBpdGVtIGF3cy1hbXBsaWZ5LWZlZGVyYXRlZEluZm8nLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZWRlcmF0ZWRJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVmcmVzaCB0aGUgand0IHRva2VuIGhlcmUgaWYgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuQ3JlZGVudGlhbHMucmVmcmVzaEZlZGVyYXRlZFRva2VuKGZlZGVyYXRlZEluZm8pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmN1cnJlbnRTZXNzaW9uKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2dldHRpbmcgc2Vzc2lvbiBzdWNjZXNzJywgc2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuQ3JlZGVudGlhbHMuc2V0KHNlc3Npb24sICdzZXNzaW9uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXR0aW5nIGd1ZXN0IGNyZWRlbnRpYWxzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuQ3JlZGVudGlhbHMuc2V0KG51bGwsICdndWVzdCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jdXJyZW50Q3JlZGVudGlhbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnZ2V0dGluZyBjdXJyZW50IGNyZWRlbnRpYWxzJyk7XG4gICAgICAgIHJldHVybiB0aGlzLkNyZWRlbnRpYWxzLmdldCgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSW5pdGlhdGUgYW4gYXR0cmlidXRlIGNvbmZpcm1hdGlvbiByZXF1ZXN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IHVzZXIgLSBUaGUgQ29nbml0b1VzZXJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXR0ciAtIFRoZSBhdHRyaWJ1dGVzIHRvIGJlIHZlcmlmaWVkXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSByZXNvbHZlcyB0byBjYWxsYmFjayBkYXRhIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnZlcmlmeVVzZXJBdHRyaWJ1dGUgPSBmdW5jdGlvbiAodXNlciwgYXR0ciwgY2xpZW50TWV0YWRhdGEpIHtcbiAgICAgICAgaWYgKGNsaWVudE1ldGFkYXRhID09PSB2b2lkIDApIHsgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7IH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHVzZXIuZ2V0QXR0cmlidXRlVmVyaWZpY2F0aW9uQ29kZShhdHRyLCB7XG4gICAgICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uRmFpbHVyZTogZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sIGNsaWVudE1ldGFkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb25maXJtIGFuIGF0dHJpYnV0ZSB1c2luZyBhIGNvbmZpcm1hdGlvbiBjb2RlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHVzZXIgLSBUaGUgQ29nbml0b1VzZXJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXR0ciAtIFRoZSBhdHRyaWJ1dGUgdG8gYmUgdmVyaWZpZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29kZSAtIFRoZSBjb25maXJtYXRpb24gY29kZVxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdG8gY2FsbGJhY2sgZGF0YSBpZiBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS52ZXJpZnlVc2VyQXR0cmlidXRlU3VibWl0ID0gZnVuY3Rpb24gKHVzZXIsIGF0dHIsIGNvZGUpIHtcbiAgICAgICAgaWYgKCFjb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3RBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuRW1wdHlDb2RlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdXNlci52ZXJpZnlBdHRyaWJ1dGUoYXR0ciwgY29kZSwge1xuICAgICAgICAgICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUudmVyaWZ5Q3VycmVudFVzZXJBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoYXR0cikge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGF0XG4gICAgICAgICAgICAuY3VycmVudFVzZXJQb29sVXNlcigpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodXNlcikgeyByZXR1cm4gdGhhdC52ZXJpZnlVc2VyQXR0cmlidXRlKHVzZXIsIGF0dHIpOyB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvbmZpcm0gY3VycmVudCB1c2VyJ3MgYXR0cmlidXRlIHVzaW5nIGEgY29uZmlybWF0aW9uIGNvZGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXR0ciAtIFRoZSBhdHRyaWJ1dGUgdG8gYmUgdmVyaWZpZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29kZSAtIFRoZSBjb25maXJtYXRpb24gY29kZVxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgdG8gY2FsbGJhY2sgZGF0YSBpZiBzdWNjZXNzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS52ZXJpZnlDdXJyZW50VXNlckF0dHJpYnV0ZVN1Ym1pdCA9IGZ1bmN0aW9uIChhdHRyLCBjb2RlKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoYXRcbiAgICAgICAgICAgIC5jdXJyZW50VXNlclBvb2xVc2VyKClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7IHJldHVybiB0aGF0LnZlcmlmeVVzZXJBdHRyaWJ1dGVTdWJtaXQodXNlciwgYXR0ciwgY29kZSk7IH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jb2duaXRvSWRlbnRpdHlTaWduT3V0ID0gZnVuY3Rpb24gKG9wdHMsIHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGVfMTAsIGlzU2lnbmVkSW5Ib3N0ZWRVSTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc3RvcmFnZVN5bmNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xMCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIHN5bmMgY2FjaGUgaW5mbyBpbnRvIG1lbW9yeScsIGVfMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZV8xMDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTaWduZWRJbkhvc3RlZFVJID0gdGhpcy5fb0F1dGhIYW5kbGVyICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RvcmFnZS5nZXRJdGVtKCdhbXBsaWZ5LXNpZ25pbi13aXRoLWhvc3RlZFVJJykgPT09ICd0cnVlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5nbG9iYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygndXNlciBnbG9iYWwgc2lnbiBvdXQnLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIG9yZGVyIHRvIHVzZSBnbG9iYWwgc2lnbm91dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgbXVzdCB2YWxpZGF0ZSB0aGUgdXNlciBhcyBhbiBhdXRoZW50aWNhdGVkIHVzZXIgYnkgdXNpbmcgZ2V0U2Vzc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsaWVudE1ldGFkYXRhID0gX3RoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgLy8gVE9ETzogdmVyaWZ5IGJlaGF2aW9yIGlmIHRoaXMgaXMgb3ZlcnJpZGUgZHVyaW5nIHNpZ25JblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5nZXRTZXNzaW9uKGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGVhblVwRXJyb3JfODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2ZhaWxlZCB0byBnZXQgdGhlIHVzZXIgc2Vzc2lvbicsIGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzU2Vzc2lvbkludmFsaWQoZXJyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGVhblVwSW52YWxpZFNlc3Npb24odXNlcildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhblVwRXJyb3JfOCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IEVycm9yKFwiU2Vzc2lvbiBpcyBpbnZhbGlkIGR1ZSB0bzogXCIgKyBlcnIubWVzc2FnZSArIFwiIGFuZCBmYWlsZWQgdG8gY2xlYW4gdXAgaW52YWxpZCBzZXNzaW9uOiBcIiArIGNsZWFuVXBFcnJvcl84Lm1lc3NhZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCByZWooZXJyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlci5nbG9iYWxTaWduT3V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnbG9iYWwgc2lnbiBvdXQgc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2lnbmVkSW5Ib3N0ZWRVSSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm9BdXRoU2lnbk91dFJlZGlyZWN0KHJlcywgcmVqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2dsb2JhbCBzaWduIG91dCBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0sIHsgY2xpZW50TWV0YWRhdGE6IGNsaWVudE1ldGFkYXRhIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCd1c2VyIHNpZ24gb3V0JywgdXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLnNpZ25PdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1NpZ25lZEluSG9zdGVkVUkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMub0F1dGhTaWduT3V0UmVkaXJlY3QocmVzLCByZWopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUub0F1dGhTaWduT3V0UmVkaXJlY3QgPSBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBpc0Jyb3dzZXIgPSBicm93c2VyT3JOb2RlKCkuaXNCcm93c2VyO1xuICAgICAgICBpZiAoaXNCcm93c2VyKSB7XG4gICAgICAgICAgICB0aGlzLm9BdXRoU2lnbk91dFJlZGlyZWN0T3JSZWplY3QocmVqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub0F1dGhTaWduT3V0QW5kUmVzb2x2ZShyZXNvbHZlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5vQXV0aFNpZ25PdXRBbmRSZXNvbHZlID0gZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgdGhpcy5fb0F1dGhIYW5kbGVyLnNpZ25PdXQoKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5vQXV0aFNpZ25PdXRSZWRpcmVjdE9yUmVqZWN0ID0gZnVuY3Rpb24gKHJlamVjdCkge1xuICAgICAgICB0aGlzLl9vQXV0aEhhbmRsZXIuc2lnbk91dCgpOyAvLyB0aGlzIG1ldGhvZCByZWRpcmVjdHMgdXJsXG4gICAgICAgIC8vIEFwcCBzaG91bGQgYmUgcmVkaXJlY3RlZCB0byBhbm90aGVyIHVybCBvdGhlcndpc2UgaXQgd2lsbCByZWplY3RcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiByZWplY3QoRXJyb3IoJ1NpZ25vdXQgdGltZW91dCBmYWlsJykpOyB9LCAzMDAwKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNpZ24gb3V0IG1ldGhvZFxuICAgICAqIEBcbiAgICAgKiBAcmV0dXJuIC0gQSBwcm9taXNlIHJlc29sdmVkIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnNpZ25PdXQgPSBmdW5jdGlvbiAob3B0cykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZV8xMSwgdXNlcjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgMiwgLCAzXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsZWFuQ2FjaGVkSXRlbXMoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzExID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdmYWlsZWQgdG8gY2xlYXIgY2FjaGVkIGl0ZW1zJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVzZXJQb29sKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSB0aGlzLnVzZXJQb29sLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jb2duaXRvSWRlbnRpdHlTaWduT3V0KG9wdHMsIHVzZXIpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnbm8gY3VycmVudCBDb2duaXRvIHVzZXInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdubyBDb2duaXRvIFVzZXIgcG9vbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIE5vdGUgZm9yIGZ1dHVyZSByZWZhY3RvciAtIG5vIHJlbGlhYmxlIHdheSB0byBnZXQgdXNlcm5hbWUgd2l0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICogQ29nbml0byBVc2VyIFBvb2xzIHZzIElkZW50aXR5IHdoZW4gZmVkZXJhdGluZyB3aXRoIFNvY2lhbCBQcm92aWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgd2h5IHdlIG5lZWQgYSB3ZWxsIHN0cnVjdHVyZWQgc2Vzc2lvbiBvYmplY3QgdGhhdCBjYW4gYmUgaW5zcGVjdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBhbmQgaW5mb3JtYXRpb24gcGFzc2VkIGJhY2sgaW4gdGhlIG1lc3NhZ2UgYmVsb3cgZm9yIEh1YiBkaXNwYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnc2lnbk91dCcsIHRoaXMudXNlciwgXCJBIHVzZXIgaGFzIGJlZW4gc2lnbmVkIG91dFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXNlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jbGVhbkNhY2hlZEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IFxuICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBjb2duaXRvIGNhY2hlZCBpdGVtXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuQ3JlZGVudGlhbHMuY2xlYXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsZWFyIGNvZ25pdG8gY2FjaGVkIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgYSBwYXNzd29yZCBmb3IgYW4gYXV0aGVudGljYXRlZCB1c2VyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHVzZXIgLSBUaGUgQ29nbml0b1VzZXIgb2JqZWN0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG9sZFBhc3N3b3JkIC0gdGhlIGN1cnJlbnQgcGFzc3dvcmRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmV3UGFzc3dvcmQgLSB0aGUgcmVxdWVzdGVkIG5ldyBwYXNzd29yZFxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgaWYgc3VjY2Vzc1xuICAgICAqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuY2hhbmdlUGFzc3dvcmQgPSBmdW5jdGlvbiAodXNlciwgb2xkUGFzc3dvcmQsIG5ld1Bhc3N3b3JkLCBjbGllbnRNZXRhZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoY2xpZW50TWV0YWRhdGEgPT09IHZvaWQgMCkgeyBjbGllbnRNZXRhZGF0YSA9IHRoaXMuX2NvbmZpZy5jbGllbnRNZXRhZGF0YTsgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXMudXNlclNlc3Npb24odXNlcikudGhlbihmdW5jdGlvbiAoc2Vzc2lvbikge1xuICAgICAgICAgICAgICAgIHVzZXIuY2hhbmdlUGFzc3dvcmQob2xkUGFzc3dvcmQsIG5ld1Bhc3N3b3JkLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY2hhbmdlIHBhc3N3b3JkIGZhaWx1cmUnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBjbGllbnRNZXRhZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBJbml0aWF0ZSBhIGZvcmdvdCBwYXNzd29yZCByZXF1ZXN0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHVzZXJuYW1lIC0gdGhlIHVzZXJuYW1lIHRvIGNoYW5nZSBwYXNzd29yZFxuICAgICAqIEByZXR1cm4gLSBBIHByb21pc2UgcmVzb2x2ZXMgaWYgc3VjY2Vzc1xuICAgICAqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuZm9yZ290UGFzc3dvcmQgPSBmdW5jdGlvbiAodXNlcm5hbWUsIGNsaWVudE1ldGFkYXRhKSB7XG4gICAgICAgIGlmIChjbGllbnRNZXRhZGF0YSA9PT0gdm9pZCAwKSB7IGNsaWVudE1ldGFkYXRhID0gdGhpcy5fY29uZmlnLmNsaWVudE1ldGFkYXRhOyB9XG4gICAgICAgIGlmICghdGhpcy51c2VyUG9vbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0Tm9Vc2VyUG9vbCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdXNlcm5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlamVjdEF1dGhFcnJvcihBdXRoRXJyb3JUeXBlcy5FbXB0eVVzZXJuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdXNlciA9IHRoaXMuY3JlYXRlQ29nbml0b1VzZXIodXNlcm5hbWUpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdXNlci5mb3Jnb3RQYXNzd29yZCh7XG4gICAgICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZm9yZ290IHBhc3N3b3JkIGZhaWx1cmUnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnZm9yZ290UGFzc3dvcmRfZmFpbHVyZScsIGVyciwgdXNlcm5hbWUgKyBcIiBmb3Jnb3RQYXNzd29yZCBmYWlsZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpbnB1dFZlcmlmaWNhdGlvbkNvZGU6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdmb3Jnb3RQYXNzd29yZCcsIHVzZXIsIHVzZXJuYW1lICsgXCIgaGFzIGluaXRpYXRlZCBmb3Jnb3QgcGFzc3dvcmQgZmxvd1wiKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LCBjbGllbnRNZXRhZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29uZmlybSBhIG5ldyBwYXNzd29yZCB1c2luZyBhIGNvbmZpcm1hdGlvbiBDb2RlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHVzZXJuYW1lIC0gVGhlIHVzZXJuYW1lXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvZGUgLSBUaGUgY29uZmlybWF0aW9uIGNvZGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFzc3dvcmQgLSBUaGUgbmV3IHBhc3N3b3JkXG4gICAgICogQHJldHVybiAtIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGlmIHN1Y2Nlc3NcbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmZvcmdvdFBhc3N3b3JkU3VibWl0ID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBjb2RlLCBwYXNzd29yZCwgY2xpZW50TWV0YWRhdGEpIHtcbiAgICAgICAgaWYgKGNsaWVudE1ldGFkYXRhID09PSB2b2lkIDApIHsgY2xpZW50TWV0YWRhdGEgPSB0aGlzLl9jb25maWcuY2xpZW50TWV0YWRhdGE7IH1cbiAgICAgICAgaWYgKCF0aGlzLnVzZXJQb29sKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3ROb1VzZXJQb29sKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VybmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5VXNlcm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5Q29kZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXNzd29yZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0QXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkVtcHR5UGFzc3dvcmQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1c2VyID0gdGhpcy5jcmVhdGVDb2duaXRvVXNlcih1c2VybmFtZSk7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB1c2VyLmNvbmZpcm1QYXNzd29yZChjb2RlLCBwYXNzd29yZCwge1xuICAgICAgICAgICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2ZvcmdvdFBhc3N3b3JkU3VibWl0JywgdXNlciwgdXNlcm5hbWUgKyBcIiBmb3Jnb3RQYXNzd29yZFN1Ym1pdCBzdWNjZXNzZnVsXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkZhaWx1cmU6IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2ZvcmdvdFBhc3N3b3JkU3VibWl0X2ZhaWx1cmUnLCBlcnIsIHVzZXJuYW1lICsgXCIgZm9yZ290UGFzc3dvcmRTdWJtaXQgZmFpbGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LCBjbGllbnRNZXRhZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IHVzZXIgaW5mb3JtYXRpb25cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJuIHtPYmplY3QgfS0gY3VycmVudCBVc2VyJ3MgaW5mb3JtYXRpb25cbiAgICAgKi9cbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmN1cnJlbnRVc2VySW5mbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSwgdXNlciwgYXR0cmlidXRlcywgdXNlckF0dHJzLCBjcmVkZW50aWFscywgZV8xMiwgaW5mbywgZXJyXzEsIHVzZXI7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2UgPSB0aGlzLkNyZWRlbnRpYWxzLmdldENyZWRTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFzb3VyY2UgfHwgc291cmNlID09PSAnYXdzJyB8fCBzb3VyY2UgPT09ICd1c2VyUG9vbCcpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY3VycmVudFVzZXJQb29sVXNlcigpLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvZ2dlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBudWxsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsyLCA4LCAsIDldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMudXNlckF0dHJpYnV0ZXModXNlcildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlckF0dHJzID0gdGhpcy5hdHRyaWJ1dGVzVG9PYmplY3QoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFscyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbNCwgNiwgLCA3XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmN1cnJlbnRDcmVkZW50aWFscygpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xMiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIHJldHJpZXZlIGNyZWRlbnRpYWxzIHdoaWxlIGdldHRpbmcgY3VycmVudCB1c2VyIGluZm8nLCBlXzEyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjcmVkZW50aWFscyA/IGNyZWRlbnRpYWxzLmlkZW50aXR5SWQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXIuZ2V0VXNlcm5hbWUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB1c2VyQXR0cnMsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcignY3VycmVudFVzZXJJbmZvIGVycm9yJywgZXJyXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHt9XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PT0gJ2ZlZGVyYXRlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gdGhpcy51c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB1c2VyID8gdXNlciA6IHt9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLmZlZGVyYXRlZFNpZ25JbiA9IGZ1bmN0aW9uIChwcm92aWRlck9yT3B0aW9ucywgcmVzcG9uc2UsIHVzZXIpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMsIHByb3ZpZGVyLCBjdXN0b21TdGF0ZSwgY2xpZW50X2lkLCByZWRpcmVjdF91cmksIHByb3ZpZGVyLCBsb2dnZWRJblVzZXIsIHRva2VuLCBpZGVudGl0eV9pZCwgZXhwaXJlc19hdCwgY3JlZGVudGlhbHMsIGN1cnJlbnRVc2VyO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuaWRlbnRpdHlQb29sSWQgJiYgIXRoaXMuX2NvbmZpZy51c2VyUG9vbElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmVkZXJhdGlvbiByZXF1aXJlcyBlaXRoZXIgYSBVc2VyIFBvb2wgb3IgSWRlbnRpdHkgUG9vbCBpbiBjb25maWdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgYmFja3dhcmRzIGNvbXBhdGFiaWxpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvdmlkZXJPck9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5pZGVudGl0eVBvb2xJZCAmJiAhdGhpcy5fY29uZmlnLnVzZXJQb29sSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmVkZXJhdGlvbiB3aXRoIElkZW50aXR5IFBvb2xzIHJlcXVpcmVzIHRva2VucyBwYXNzZWQgYXMgYXJndW1lbnRzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGlzRmVkZXJhdGVkU2lnbkluT3B0aW9ucyhwcm92aWRlck9yT3B0aW9ucykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0ZlZGVyYXRlZFNpZ25Jbk9wdGlvbnNDdXN0b20ocHJvdmlkZXJPck9wdGlvbnMpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQ3VzdG9tU3RhdGUocHJvdmlkZXJPck9wdGlvbnMpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHByb3ZpZGVyT3JPcHRpb25zID09PSAndW5kZWZpbmVkJykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IHByb3ZpZGVyT3JPcHRpb25zIHx8IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlcjogQ29nbml0b0hvc3RlZFVJSWRlbnRpdHlQcm92aWRlci5Db2duaXRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gaXNGZWRlcmF0ZWRTaWduSW5PcHRpb25zKG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBvcHRpb25zLnByb3ZpZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBvcHRpb25zLmN1c3RvbVByb3ZpZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUgPSBpc0ZlZGVyYXRlZFNpZ25Jbk9wdGlvbnMob3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG9wdGlvbnMuY3VzdG9tU3RhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG9wdGlvbnMuY3VzdG9tU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLnVzZXJQb29sSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQgPSBpc0NvZ25pdG9Ib3N0ZWRPcHRzKHRoaXMuX2NvbmZpZy5vYXV0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9jb25maWcudXNlclBvb2xXZWJDbGllbnRJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuX2NvbmZpZy5vYXV0aC5jbGllbnRJRDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdF91cmkgPSBpc0NvZ25pdG9Ib3N0ZWRPcHRzKHRoaXMuX2NvbmZpZy5vYXV0aClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9jb25maWcub2F1dGgucmVkaXJlY3RTaWduSW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLl9jb25maWcub2F1dGgucmVkaXJlY3RVcmk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb0F1dGhIYW5kbGVyLm9hdXRoU2lnbkluKHRoaXMuX2NvbmZpZy5vYXV0aC5yZXNwb25zZVR5cGUsIHRoaXMuX2NvbmZpZy5vYXV0aC5kb21haW4sIHJlZGlyZWN0X3VyaSwgY2xpZW50X2lkLCBwcm92aWRlciwgY3VzdG9tU3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gcHJvdmlkZXJPck9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUbyBjaGVjayBpZiB0aGUgdXNlciBpcyBhbHJlYWR5IGxvZ2dlZCBpblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZWRJblVzZXIgPSBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKHRoaXMuX3N0b3JhZ2UuZ2V0SXRlbSgnYXdzLWFtcGxpZnktZmVkZXJhdGVkSW5mbycpKS51c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VkSW5Vc2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiVGhlcmUgaXMgYWxyZWFkeSBhIHNpZ25lZCBpbiB1c2VyOiBcIiArIGxvZ2dlZEluVXNlciArIFwiIGluIHlvdXIgYXBwLlxcblxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFlvdSBzaG91bGQgbm90IGNhbGwgQXV0aC5mZWRlcmF0ZWRTaWduSW4gbWV0aG9kIGFnYWluIGFzIGl0IG1heSBjYXVzZSB1bmV4cGVjdGVkIGJlaGF2aW9yLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2tlbiA9IHJlc3BvbnNlLnRva2VuLCBpZGVudGl0eV9pZCA9IHJlc3BvbnNlLmlkZW50aXR5X2lkLCBleHBpcmVzX2F0ID0gcmVzcG9uc2UuZXhwaXJlc19hdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuQ3JlZGVudGlhbHMuc2V0KHsgcHJvdmlkZXI6IHByb3ZpZGVyLCB0b2tlbjogdG9rZW4sIGlkZW50aXR5X2lkOiBpZGVudGl0eV9pZCwgdXNlcjogdXNlciwgZXhwaXJlc19hdDogZXhwaXJlc19hdCB9LCAnZmVkZXJhdGlvbicpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmN1cnJlbnRBdXRoZW50aWNhdGVkVXNlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnc2lnbkluJywgY3VycmVudFVzZXIsIFwiQSB1c2VyIFwiICsgY3VycmVudFVzZXIudXNlcm5hbWUgKyBcIiBoYXMgYmVlbiBzaWduZWQgaW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2ZlZGVyYXRlZCBzaWduIGluIGNyZWRlbnRpYWxzJywgY3JlZGVudGlhbHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGNyZWRlbnRpYWxzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXNlZCB0byBjb21wbGV0ZSB0aGUgT0F1dGggZmxvdyB3aXRoIG9yIHdpdGhvdXQgdGhlIENvZ25pdG8gSG9zdGVkIFVJXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFVSTCAtIG9wdGlvbmFsIHBhcmFtZXRlciBmb3IgY3VzdG9tZXJzIHRvIHBhc3MgaW4gdGhlIHJlc3BvbnNlIFVSTFxuICAgICAqL1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuX2hhbmRsZUF1dGhSZXNwb25zZSA9IGZ1bmN0aW9uIChVUkwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRVcmwsIGhhc0NvZGVPckVycm9yLCBoYXNUb2tlbk9yRXJyb3IsIF9hLCBhY2Nlc3NUb2tlbiwgaWRUb2tlbiwgcmVmcmVzaFRva2VuLCBzdGF0ZSwgc2Vzc2lvbiwgY3JlZGVudGlhbHMsIGlzQ3VzdG9tU3RhdGVJbmNsdWRlZCwgY3VycmVudFVzZXIsIGN1c3RvbVN0YXRlLCBlcnJfMjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9BdXRoRmxvd0luUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJTa2lwcGluZyBVUkwgXCIgKyBVUkwgKyBcIiBjdXJyZW50IGZsb3cgaW4gcHJvZ3Jlc3NcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50cnlzLnB1c2goWzEsICwgOCwgOV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vQXV0aEZsb3dJblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY29uZmlnLnVzZXJQb29sSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPQXV0aCByZXNwb25zZXMgcmVxdWlyZSBhIFVzZXIgUG9vbCBkZWZpbmVkIGluIGNvbmZpZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdwYXJzaW5nQ2FsbGJhY2tVcmwnLCB7IHVybDogVVJMIH0sIFwiVGhlIGNhbGxiYWNrIHVybCBpcyBiZWluZyBwYXJzZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXJsID0gVVJMIHx8IChicm93c2VyT3JOb2RlKCkuaXNCcm93c2VyID8gd2luZG93LmxvY2F0aW9uLmhyZWYgOiAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNDb2RlT3JFcnJvciA9ICEhKHBhcnNlKGN1cnJlbnRVcmwpLnF1ZXJ5IHx8ICcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnJicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZW50cnkpIHsgcmV0dXJuIGVudHJ5LnNwbGl0KCc9Jyk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAxKSwgayA9IF9iWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrID09PSAnY29kZScgfHwgayA9PT0gJ2Vycm9yJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFzVG9rZW5PckVycm9yID0gISEocGFyc2UoY3VycmVudFVybCkuaGFzaCB8fCAnIycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN1YnN0cigxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnJicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZW50cnkpIHsgcmV0dXJuIGVudHJ5LnNwbGl0KCc9Jyk7IH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAxKSwgayA9IF9iWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrID09PSAnYWNjZXNzX3Rva2VuJyB8fCBrID09PSAnZXJyb3InO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShoYXNDb2RlT3JFcnJvciB8fCBoYXNUb2tlbk9yRXJyb3IpKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JhZ2Uuc2V0SXRlbSgnYW1wbGlmeS1yZWRpcmVjdGVkLWZyb20taG9zdGVkLXVpJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsyLCA2LCAsIDddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX29BdXRoSGFuZGxlci5oYW5kbGVBdXRoUmVzcG9uc2UoY3VycmVudFVybCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IF9iLnNlbnQoKSwgYWNjZXNzVG9rZW4gPSBfYS5hY2Nlc3NUb2tlbiwgaWRUb2tlbiA9IF9hLmlkVG9rZW4sIHJlZnJlc2hUb2tlbiA9IF9hLnJlZnJlc2hUb2tlbiwgc3RhdGUgPSBfYS5zdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb24gPSBuZXcgQ29nbml0b1VzZXJTZXNzaW9uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZFRva2VuOiBuZXcgQ29nbml0b0lkVG9rZW4oeyBJZFRva2VuOiBpZFRva2VuIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZnJlc2hUb2tlbjogbmV3IENvZ25pdG9SZWZyZXNoVG9rZW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWZyZXNoVG9rZW46IHJlZnJlc2hUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBY2Nlc3NUb2tlbjogbmV3IENvZ25pdG9BY2Nlc3NUb2tlbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5pZGVudGl0eVBvb2xJZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkNyZWRlbnRpYWxzLnNldChzZXNzaW9uLCAnc2Vzc2lvbicpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0FXUyBjcmVkZW50aWFscycsIGNyZWRlbnRpYWxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgaXNDdXN0b21TdGF0ZUluY2x1ZGVkID0gLy0vLnRlc3Qoc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSB0aGlzLmNyZWF0ZUNvZ25pdG9Vc2VyKHNlc3Npb24uZ2V0SWRUb2tlbigpLmRlY29kZVBheWxvYWQoKVsnY29nbml0bzp1c2VybmFtZSddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgY2FsbHMgY2FjaGVUb2tlbnMoKSBpbiBDb2duaXRvIFNES1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFVzZXIuc2V0U2lnbkluVXNlclNlc3Npb24oc2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93ICYmIHR5cGVvZiB3aW5kb3cuaGlzdG9yeSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIG51bGwsIHRoaXMuX2NvbmZpZy5vYXV0aC5yZWRpcmVjdFNpZ25Jbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnc2lnbkluJywgY3VycmVudFVzZXIsIFwiQSB1c2VyIFwiICsgY3VycmVudFVzZXIuZ2V0VXNlcm5hbWUoKSArIFwiIGhhcyBiZWVuIHNpZ25lZCBpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdjb2duaXRvSG9zdGVkVUknLCBjdXJyZW50VXNlciwgXCJBIHVzZXIgXCIgKyBjdXJyZW50VXNlci5nZXRVc2VybmFtZSgpICsgXCIgaGFzIGJlZW4gc2lnbmVkIGluIHZpYSBDb2duaXRvIEhvc3RlZCBVSVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0N1c3RvbVN0YXRlSW5jbHVkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHN0YXRlLnNwbGl0KCctJykuc3BsaWNlKDEpLmpvaW4oJy0nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnY3VzdG9tT0F1dGhTdGF0ZScsIHVybFNhZmVEZWNvZGUoY3VzdG9tU3RhdGUpLCBcIlN0YXRlIGZvciB1c2VyIFwiICsgY3VycmVudFVzZXIuZ2V0VXNlcm5hbWUoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyNlbmRyZWdpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBjcmVkZW50aWFsc107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycl8yID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdFcnJvciBpbiBjb2duaXRvIGhvc3RlZCBhdXRoIHJlc3BvbnNlJywgZXJyXzIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVzdCBsaWtlIGEgc3VjY2Vzc2Z1bCBoYW5kbGluZyBvZiBgP2NvZGVgLCByZXBsYWNlIHRoZSB3aW5kb3cgaGlzdG9yeSB0byBcImRpc3Bvc2VcIiBvZiB0aGUgYGNvZGVgLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCByZWxvYWRpbmcgdGhlIHBhZ2Ugd2lsbCB0aHJvdyBlcnJvcnMgYXMgdGhlIGBjb2RlYCBoYXMgYWxyZWFkeSBiZWVuIHNwZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdyAmJiB0eXBlb2Ygd2luZG93Lmhpc3RvcnkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LCBudWxsLCB0aGlzLl9jb25maWcub2F1dGgucmVkaXJlY3RTaWduSW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ3NpZ25Jbl9mYWlsdXJlJywgZXJyXzIsIFwiVGhlIE9BdXRoIHJlc3BvbnNlIGZsb3cgZmFpbGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2NvZ25pdG9Ib3N0ZWRVSV9mYWlsdXJlJywgZXJyXzIsIFwiQSBmYWlsdXJlIG9jY3VycmVkIHdoZW4gcmV0dXJuaW5nIHRvIHRoZSBDb2duaXRvIEhvc3RlZCBVSVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQXV0aEV2ZW50KCdjdXN0b21TdGF0ZV9mYWlsdXJlJywgZXJyXzIsIFwiQSBmYWlsdXJlIG9jY3VycmVkIHdoZW4gcmV0dXJuaW5nIHN0YXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub0F1dGhGbG93SW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29tcGFjdCB2ZXJzaW9uIG9mIGNyZWRlbnRpYWxzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNyZWRlbnRpYWxzXG4gICAgICogQHJldHVybiB7T2JqZWN0fSAtIENyZWRlbnRpYWxzXG4gICAgICovXG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5lc3NlbnRpYWxDcmVkZW50aWFscyA9IGZ1bmN0aW9uIChjcmVkZW50aWFscykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYWNjZXNzS2V5SWQ6IGNyZWRlbnRpYWxzLmFjY2Vzc0tleUlkLFxuICAgICAgICAgICAgc2Vzc2lvblRva2VuOiBjcmVkZW50aWFscy5zZXNzaW9uVG9rZW4sXG4gICAgICAgICAgICBzZWNyZXRBY2Nlc3NLZXk6IGNyZWRlbnRpYWxzLnNlY3JldEFjY2Vzc0tleSxcbiAgICAgICAgICAgIGlkZW50aXR5SWQ6IGNyZWRlbnRpYWxzLmlkZW50aXR5SWQsXG4gICAgICAgICAgICBhdXRoZW50aWNhdGVkOiBjcmVkZW50aWFscy5hdXRoZW50aWNhdGVkLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5hdHRyaWJ1dGVzVG9PYmplY3QgPSBmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLm1hcChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5OYW1lID09PSAnZW1haWxfdmVyaWZpZWQnIHx8XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZS5OYW1lID09PSAncGhvbmVfbnVtYmVyX3ZlcmlmaWVkJykge1xuICAgICAgICAgICAgICAgICAgICBvYmpbYXR0cmlidXRlLk5hbWVdID1cbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzVHJ1dGh5U3RyaW5nKGF0dHJpYnV0ZS5WYWx1ZSkgfHwgYXR0cmlidXRlLlZhbHVlID09PSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqW2F0dHJpYnV0ZS5OYW1lXSA9IGF0dHJpYnV0ZS5WYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5pc1RydXRoeVN0cmluZyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKHR5cGVvZiB2YWx1ZS50b0xvd2VyQ2FzZSA9PT0gJ2Z1bmN0aW9uJyAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZScpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5jcmVhdGVDb2duaXRvVXNlciA9IGZ1bmN0aW9uICh1c2VybmFtZSkge1xuICAgICAgICB2YXIgdXNlckRhdGEgPSB7XG4gICAgICAgICAgICBVc2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBQb29sOiB0aGlzLnVzZXJQb29sLFxuICAgICAgICB9O1xuICAgICAgICB1c2VyRGF0YS5TdG9yYWdlID0gdGhpcy5fc3RvcmFnZTtcbiAgICAgICAgdmFyIGF1dGhlbnRpY2F0aW9uRmxvd1R5cGUgPSB0aGlzLl9jb25maWcuYXV0aGVudGljYXRpb25GbG93VHlwZTtcbiAgICAgICAgdmFyIHVzZXIgPSBuZXcgQ29nbml0b1VzZXIodXNlckRhdGEpO1xuICAgICAgICBpZiAoYXV0aGVudGljYXRpb25GbG93VHlwZSkge1xuICAgICAgICAgICAgdXNlci5zZXRBdXRoZW50aWNhdGlvbkZsb3dUeXBlKGF1dGhlbnRpY2F0aW9uRmxvd1R5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1c2VyO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5faXNWYWxpZEF1dGhTdG9yYWdlID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAvLyBXZSBuZWVkIHRvIGNoZWNrIGlmIHRoZSBvYmogaGFzIHRoZSBmdW5jdGlvbnMgb2YgU3RvcmFnZVxuICAgICAgICByZXR1cm4gKCEhb2JqICYmXG4gICAgICAgICAgICB0eXBlb2Ygb2JqLmdldEl0ZW0gPT09ICdmdW5jdGlvbicgJiZcbiAgICAgICAgICAgIHR5cGVvZiBvYmouc2V0SXRlbSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgICAgICAgdHlwZW9mIG9iai5yZW1vdmVJdGVtID09PSAnZnVuY3Rpb24nICYmXG4gICAgICAgICAgICB0eXBlb2Ygb2JqLmNsZWFyID09PSAnZnVuY3Rpb24nKTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUubm9Vc2VyUG9vbEVycm9ySGFuZGxlciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgaWYgKGNvbmZpZykge1xuICAgICAgICAgICAgaWYgKCFjb25maWcudXNlclBvb2xJZCB8fCAhY29uZmlnLmlkZW50aXR5UG9vbElkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGhFcnJvclR5cGVzLk1pc3NpbmdBdXRoQ29uZmlnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBBdXRoRXJyb3JUeXBlcy5Ob0NvbmZpZztcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUucmVqZWN0QXV0aEVycm9yID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBBdXRoRXJyb3IodHlwZSkpO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5yZWplY3ROb1VzZXJQb29sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHlwZSA9IHRoaXMubm9Vc2VyUG9vbEVycm9ySGFuZGxlcih0aGlzLl9jb25maWcpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE5vVXNlclBvb2xFcnJvcih0eXBlKSk7XG4gICAgfTtcbiAgICBBdXRoQ2xhc3MucHJvdG90eXBlLnJlbWVtYmVyRGV2aWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VyclVzZXIsIGVycm9yXzI7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jdXJyZW50VXNlclBvb2xVc2VyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyVXNlciA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8yID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdUaGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCBieSB0aGUgZXJyb3InLCBlcnJvcl8yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBQcm9taXNlLnJlamVjdCgnVGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWQnKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJVc2VyLmdldENhY2hlZERldmljZUtleUFuZFBhc3N3b3JkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJVc2VyLnNldERldmljZVN0YXR1c1JlbWVtYmVyZWQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZhaWx1cmU6IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyLmNvZGUgPT09ICdJbnZhbGlkUGFyYW1ldGVyRXhjZXB0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IEF1dGhFcnJvcihBdXRoRXJyb3JUeXBlcy5EZXZpY2VDb25maWcpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyLmNvZGUgPT09ICdOZXR3b3JrRXJyb3InKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgQXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLk5ldHdvcmtFcnJvcikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEF1dGhDbGFzcy5wcm90b3R5cGUuZm9yZ2V0RGV2aWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VyclVzZXIsIGVycm9yXzM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jdXJyZW50VXNlclBvb2xVc2VyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyVXNlciA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8zID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdUaGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCBieSB0aGUgZXJyb3InLCBlcnJvcl8zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBQcm9taXNlLnJlamVjdCgnVGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWQnKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJVc2VyLmdldENhY2hlZERldmljZUtleUFuZFBhc3N3b3JkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJVc2VyLmZvcmdldERldmljZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRmFpbHVyZTogZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIuY29kZSA9PT0gJ0ludmFsaWRQYXJhbWV0ZXJFeGNlcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgQXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkRldmljZUNvbmZpZykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlcnIuY29kZSA9PT0gJ05ldHdvcmtFcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKG5ldyBBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuTmV0d29ya0Vycm9yKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQXV0aENsYXNzLnByb3RvdHlwZS5mZXRjaERldmljZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyVXNlciwgZXJyb3JfNDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgMiwgLCAzXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmN1cnJlbnRVc2VyUG9vbFVzZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJVc2VyID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1RoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkIGJ5IHRoZSBlcnJvcicsIGVycm9yXzQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyVXNlci5nZXRDYWNoZWREZXZpY2VLZXlBbmRQYXNzd29yZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMsIHJlaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2IgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldmljZUxpc3QgPSBkYXRhLkRldmljZXMubWFwKGZ1bmN0aW9uIChkZXZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldmljZU5hbWUgPSBkZXZpY2UuRGV2aWNlQXR0cmlidXRlcy5maW5kKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE5hbWUgPSBfYS5OYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5hbWUgPT09ICdkZXZpY2VfbmFtZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGV2aWNlSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkZXZpY2UuRGV2aWNlS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGV2aWNlTmFtZS5WYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRldmljZUluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKGRldmljZUxpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRmFpbHVyZTogZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIuY29kZSA9PT0gJ0ludmFsaWRQYXJhbWV0ZXJFeGNlcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgQXV0aEVycm9yKEF1dGhFcnJvclR5cGVzLkRldmljZUNvbmZpZykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlcnIuY29kZSA9PT0gJ05ldHdvcmtFcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKG5ldyBBdXRoRXJyb3IoQXV0aEVycm9yVHlwZXMuTmV0d29ya0Vycm9yKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyVXNlci5saXN0RGV2aWNlcyhNQVhfREVWSUNFUywgbnVsbCwgY2IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQXV0aENsYXNzO1xufSgpKTtcbmV4cG9ydCB7IEF1dGhDbGFzcyB9O1xuZXhwb3J0IHZhciBBdXRoID0gbmV3IEF1dGhDbGFzcyhudWxsKTtcbkFtcGxpZnkucmVnaXN0ZXIoQXV0aCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdXRoLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/Auth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/Errors.js":
/*!**********************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/Errors.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthError: () => (/* binding */ AuthError),\n/* harmony export */   NoUserPoolError: () => (/* binding */ NoUserPoolError),\n/* harmony export */   authErrorMessages: () => (/* binding */ authErrorMessages)\n/* harmony export */ });\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./common/AuthErrorStrings */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings.js\");\n/*\n * Copyright 2019-2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('AuthError');\nvar AuthError = /** @class */ (function (_super) {\n    __extends(AuthError, _super);\n    function AuthError(type) {\n        var _this = this;\n        var _a = authErrorMessages[type], message = _a.message, log = _a.log;\n        _this = _super.call(this, message) || this;\n        // Hack for making the custom error class work when transpiled to es5\n        // TODO: Delete the following 2 lines after we change the build target to >= es2015\n        _this.constructor = AuthError;\n        Object.setPrototypeOf(_this, AuthError.prototype);\n        _this.name = 'AuthError';\n        _this.log = log || message;\n        logger.error(_this.log);\n        return _this;\n    }\n    return AuthError;\n}(Error));\n\nvar NoUserPoolError = /** @class */ (function (_super) {\n    __extends(NoUserPoolError, _super);\n    function NoUserPoolError(type) {\n        var _this = _super.call(this, type) || this;\n        // Hack for making the custom error class work when transpiled to es5\n        // TODO: Delete the following 2 lines after we change the build target to >= es2015\n        _this.constructor = NoUserPoolError;\n        Object.setPrototypeOf(_this, NoUserPoolError.prototype);\n        _this.name = 'NoUserPoolError';\n        return _this;\n    }\n    return NoUserPoolError;\n}(AuthError));\n\nvar authErrorMessages = {\n    noConfig: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.DEFAULT_MSG,\n        log: \"\\n            Error: Amplify has not been configured correctly.\\n            This error is typically caused by one of the following scenarios:\\n\\n            1. Make sure you're passing the awsconfig object to Amplify.configure() in your app's entry point\\n                See https://aws-amplify.github.io/docs/js/authentication#configure-your-app for more information\\n            \\n            2. There might be multiple conflicting versions of amplify packages in your node_modules.\\n\\t\\t\\t\\tRefer to our docs site for help upgrading Amplify packages (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js)\\n        \",\n    },\n    missingAuthConfig: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.DEFAULT_MSG,\n        log: \"\\n            Error: Amplify has not been configured correctly. \\n            The configuration object is missing required auth properties.\\n            This error is typically caused by one of the following scenarios:\\n\\n            1. Did you run `amplify push` after adding auth via `amplify add auth`?\\n                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\\n\\n            2. This could also be caused by multiple conflicting versions of amplify packages, see (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js) for help upgrading Amplify packages.\\n        \",\n    },\n    emptyUsername: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.EMPTY_USERNAME,\n    },\n    // TODO: should include a list of valid sign-in types\n    invalidUsername: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.INVALID_USERNAME,\n    },\n    emptyPassword: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.EMPTY_PASSWORD,\n    },\n    emptyCode: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.EMPTY_CODE,\n    },\n    signUpError: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.SIGN_UP_ERROR,\n        log: 'The first parameter should either be non-null string or object',\n    },\n    noMFA: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.NO_MFA,\n    },\n    invalidMFA: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.INVALID_MFA,\n    },\n    emptyChallengeResponse: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.EMPTY_CHALLENGE,\n    },\n    noUserSession: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.NO_USER_SESSION,\n    },\n    deviceConfig: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.DEVICE_CONFIG,\n    },\n    networkError: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.NETWORK_ERROR,\n    },\n    autoSignInError: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.AUTOSIGNIN_ERROR,\n    },\n    default: {\n        message: _common_AuthErrorStrings__WEBPACK_IMPORTED_MODULE_1__.AuthErrorStrings.DEFAULT_MSG,\n    },\n};\n//# sourceMappingURL=Errors.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9FcnJvcnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0I7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDdkYsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQzJEO0FBQ0M7QUFDN0QsaUJBQWlCLDREQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNvQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQzBCO0FBQ3BCO0FBQ1A7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsaUJBQWlCLHNFQUFnQjtBQUNqQztBQUNBLEtBQUs7QUFDTDtBQUNBLGlCQUFpQixzRUFBZ0I7QUFDakMsS0FBSztBQUNMO0FBQ0E7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDLEtBQUs7QUFDTDtBQUNBLGlCQUFpQixzRUFBZ0I7QUFDakMsS0FBSztBQUNMO0FBQ0EsaUJBQWlCLHNFQUFnQjtBQUNqQyxLQUFLO0FBQ0w7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsaUJBQWlCLHNFQUFnQjtBQUNqQyxLQUFLO0FBQ0w7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDLEtBQUs7QUFDTDtBQUNBLGlCQUFpQixzRUFBZ0I7QUFDakMsS0FBSztBQUNMO0FBQ0EsaUJBQWlCLHNFQUFnQjtBQUNqQyxLQUFLO0FBQ0w7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDLEtBQUs7QUFDTDtBQUNBLGlCQUFpQixzRUFBZ0I7QUFDakMsS0FBSztBQUNMO0FBQ0EsaUJBQWlCLHNFQUFnQjtBQUNqQyxLQUFLO0FBQ0w7QUFDQSxpQkFBaUIsc0VBQWdCO0FBQ2pDLEtBQUs7QUFDTDtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvYXV0aC9saWItZXNtL0Vycm9ycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTktMjAyMCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5pbXBvcnQgeyBDb25zb2xlTG9nZ2VyIGFzIExvZ2dlciB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9jb3JlJztcbmltcG9ydCB7IEF1dGhFcnJvclN0cmluZ3MgfSBmcm9tICcuL2NvbW1vbi9BdXRoRXJyb3JTdHJpbmdzJztcbnZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdBdXRoRXJyb3InKTtcbnZhciBBdXRoRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEF1dGhFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBdXRoRXJyb3IodHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgX2EgPSBhdXRoRXJyb3JNZXNzYWdlc1t0eXBlXSwgbWVzc2FnZSA9IF9hLm1lc3NhZ2UsIGxvZyA9IF9hLmxvZztcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzO1xuICAgICAgICAvLyBIYWNrIGZvciBtYWtpbmcgdGhlIGN1c3RvbSBlcnJvciBjbGFzcyB3b3JrIHdoZW4gdHJhbnNwaWxlZCB0byBlczVcbiAgICAgICAgLy8gVE9ETzogRGVsZXRlIHRoZSBmb2xsb3dpbmcgMiBsaW5lcyBhZnRlciB3ZSBjaGFuZ2UgdGhlIGJ1aWxkIHRhcmdldCB0byA+PSBlczIwMTVcbiAgICAgICAgX3RoaXMuY29uc3RydWN0b3IgPSBBdXRoRXJyb3I7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgQXV0aEVycm9yLnByb3RvdHlwZSk7XG4gICAgICAgIF90aGlzLm5hbWUgPSAnQXV0aEVycm9yJztcbiAgICAgICAgX3RoaXMubG9nID0gbG9nIHx8IG1lc3NhZ2U7XG4gICAgICAgIGxvZ2dlci5lcnJvcihfdGhpcy5sb2cpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBBdXRoRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnQgeyBBdXRoRXJyb3IgfTtcbnZhciBOb1VzZXJQb29sRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE5vVXNlclBvb2xFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb1VzZXJQb29sRXJyb3IodHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB0eXBlKSB8fCB0aGlzO1xuICAgICAgICAvLyBIYWNrIGZvciBtYWtpbmcgdGhlIGN1c3RvbSBlcnJvciBjbGFzcyB3b3JrIHdoZW4gdHJhbnNwaWxlZCB0byBlczVcbiAgICAgICAgLy8gVE9ETzogRGVsZXRlIHRoZSBmb2xsb3dpbmcgMiBsaW5lcyBhZnRlciB3ZSBjaGFuZ2UgdGhlIGJ1aWxkIHRhcmdldCB0byA+PSBlczIwMTVcbiAgICAgICAgX3RoaXMuY29uc3RydWN0b3IgPSBOb1VzZXJQb29sRXJyb3I7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgTm9Vc2VyUG9vbEVycm9yLnByb3RvdHlwZSk7XG4gICAgICAgIF90aGlzLm5hbWUgPSAnTm9Vc2VyUG9vbEVycm9yJztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gTm9Vc2VyUG9vbEVycm9yO1xufShBdXRoRXJyb3IpKTtcbmV4cG9ydCB7IE5vVXNlclBvb2xFcnJvciB9O1xuZXhwb3J0IHZhciBhdXRoRXJyb3JNZXNzYWdlcyA9IHtcbiAgICBub0NvbmZpZzoge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLkRFRkFVTFRfTVNHLFxuICAgICAgICBsb2c6IFwiXFxuICAgICAgICAgICAgRXJyb3I6IEFtcGxpZnkgaGFzIG5vdCBiZWVuIGNvbmZpZ3VyZWQgY29ycmVjdGx5LlxcbiAgICAgICAgICAgIFRoaXMgZXJyb3IgaXMgdHlwaWNhbGx5IGNhdXNlZCBieSBvbmUgb2YgdGhlIGZvbGxvd2luZyBzY2VuYXJpb3M6XFxuXFxuICAgICAgICAgICAgMS4gTWFrZSBzdXJlIHlvdSdyZSBwYXNzaW5nIHRoZSBhd3Njb25maWcgb2JqZWN0IHRvIEFtcGxpZnkuY29uZmlndXJlKCkgaW4geW91ciBhcHAncyBlbnRyeSBwb2ludFxcbiAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9hd3MtYW1wbGlmeS5naXRodWIuaW8vZG9jcy9qcy9hdXRoZW50aWNhdGlvbiNjb25maWd1cmUteW91ci1hcHAgZm9yIG1vcmUgaW5mb3JtYXRpb25cXG4gICAgICAgICAgICBcXG4gICAgICAgICAgICAyLiBUaGVyZSBtaWdodCBiZSBtdWx0aXBsZSBjb25mbGljdGluZyB2ZXJzaW9ucyBvZiBhbXBsaWZ5IHBhY2thZ2VzIGluIHlvdXIgbm9kZV9tb2R1bGVzLlxcblxcdFxcdFxcdFxcdFJlZmVyIHRvIG91ciBkb2NzIHNpdGUgZm9yIGhlbHAgdXBncmFkaW5nIEFtcGxpZnkgcGFja2FnZXMgKGh0dHBzOi8vZG9jcy5hbXBsaWZ5LmF3cy9saWIvdHJvdWJsZXNob290aW5nL3VwZ3JhZGluZy9xL3BsYXRmb3JtL2pzKVxcbiAgICAgICAgXCIsXG4gICAgfSxcbiAgICBtaXNzaW5nQXV0aENvbmZpZzoge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLkRFRkFVTFRfTVNHLFxuICAgICAgICBsb2c6IFwiXFxuICAgICAgICAgICAgRXJyb3I6IEFtcGxpZnkgaGFzIG5vdCBiZWVuIGNvbmZpZ3VyZWQgY29ycmVjdGx5LiBcXG4gICAgICAgICAgICBUaGUgY29uZmlndXJhdGlvbiBvYmplY3QgaXMgbWlzc2luZyByZXF1aXJlZCBhdXRoIHByb3BlcnRpZXMuXFxuICAgICAgICAgICAgVGhpcyBlcnJvciBpcyB0eXBpY2FsbHkgY2F1c2VkIGJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nIHNjZW5hcmlvczpcXG5cXG4gICAgICAgICAgICAxLiBEaWQgeW91IHJ1biBgYW1wbGlmeSBwdXNoYCBhZnRlciBhZGRpbmcgYXV0aCB2aWEgYGFtcGxpZnkgYWRkIGF1dGhgP1xcbiAgICAgICAgICAgICAgICBTZWUgaHR0cHM6Ly9hd3MtYW1wbGlmeS5naXRodWIuaW8vZG9jcy9qcy9hdXRoZW50aWNhdGlvbiNhbXBsaWZ5LXByb2plY3Qtc2V0dXAgZm9yIG1vcmUgaW5mb3JtYXRpb25cXG5cXG4gICAgICAgICAgICAyLiBUaGlzIGNvdWxkIGFsc28gYmUgY2F1c2VkIGJ5IG11bHRpcGxlIGNvbmZsaWN0aW5nIHZlcnNpb25zIG9mIGFtcGxpZnkgcGFja2FnZXMsIHNlZSAoaHR0cHM6Ly9kb2NzLmFtcGxpZnkuYXdzL2xpYi90cm91Ymxlc2hvb3RpbmcvdXBncmFkaW5nL3EvcGxhdGZvcm0vanMpIGZvciBoZWxwIHVwZ3JhZGluZyBBbXBsaWZ5IHBhY2thZ2VzLlxcbiAgICAgICAgXCIsXG4gICAgfSxcbiAgICBlbXB0eVVzZXJuYW1lOiB7XG4gICAgICAgIG1lc3NhZ2U6IEF1dGhFcnJvclN0cmluZ3MuRU1QVFlfVVNFUk5BTUUsXG4gICAgfSxcbiAgICAvLyBUT0RPOiBzaG91bGQgaW5jbHVkZSBhIGxpc3Qgb2YgdmFsaWQgc2lnbi1pbiB0eXBlc1xuICAgIGludmFsaWRVc2VybmFtZToge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLklOVkFMSURfVVNFUk5BTUUsXG4gICAgfSxcbiAgICBlbXB0eVBhc3N3b3JkOiB7XG4gICAgICAgIG1lc3NhZ2U6IEF1dGhFcnJvclN0cmluZ3MuRU1QVFlfUEFTU1dPUkQsXG4gICAgfSxcbiAgICBlbXB0eUNvZGU6IHtcbiAgICAgICAgbWVzc2FnZTogQXV0aEVycm9yU3RyaW5ncy5FTVBUWV9DT0RFLFxuICAgIH0sXG4gICAgc2lnblVwRXJyb3I6IHtcbiAgICAgICAgbWVzc2FnZTogQXV0aEVycm9yU3RyaW5ncy5TSUdOX1VQX0VSUk9SLFxuICAgICAgICBsb2c6ICdUaGUgZmlyc3QgcGFyYW1ldGVyIHNob3VsZCBlaXRoZXIgYmUgbm9uLW51bGwgc3RyaW5nIG9yIG9iamVjdCcsXG4gICAgfSxcbiAgICBub01GQToge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLk5PX01GQSxcbiAgICB9LFxuICAgIGludmFsaWRNRkE6IHtcbiAgICAgICAgbWVzc2FnZTogQXV0aEVycm9yU3RyaW5ncy5JTlZBTElEX01GQSxcbiAgICB9LFxuICAgIGVtcHR5Q2hhbGxlbmdlUmVzcG9uc2U6IHtcbiAgICAgICAgbWVzc2FnZTogQXV0aEVycm9yU3RyaW5ncy5FTVBUWV9DSEFMTEVOR0UsXG4gICAgfSxcbiAgICBub1VzZXJTZXNzaW9uOiB7XG4gICAgICAgIG1lc3NhZ2U6IEF1dGhFcnJvclN0cmluZ3MuTk9fVVNFUl9TRVNTSU9OLFxuICAgIH0sXG4gICAgZGV2aWNlQ29uZmlnOiB7XG4gICAgICAgIG1lc3NhZ2U6IEF1dGhFcnJvclN0cmluZ3MuREVWSUNFX0NPTkZJRyxcbiAgICB9LFxuICAgIG5ldHdvcmtFcnJvcjoge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLk5FVFdPUktfRVJST1IsXG4gICAgfSxcbiAgICBhdXRvU2lnbkluRXJyb3I6IHtcbiAgICAgICAgbWVzc2FnZTogQXV0aEVycm9yU3RyaW5ncy5BVVRPU0lHTklOX0VSUk9SLFxuICAgIH0sXG4gICAgZGVmYXVsdDoge1xuICAgICAgICBtZXNzYWdlOiBBdXRoRXJyb3JTdHJpbmdzLkRFRkFVTFRfTVNHLFxuICAgIH0sXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXJyb3JzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/Errors.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js":
/*!***************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _urlOpener__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./urlOpener */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js\");\n/* harmony import */ var _oauthStorage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./oauthStorage */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js\");\n/* harmony import */ var _types_Auth__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../types/Auth */ \"(ssr)/./node_modules/@aws-amplify/auth/lib-esm/types/Auth.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Hub.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js\");\n/* harmony import */ var crypto_js_sha256__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto-js/sha256 */ \"(ssr)/./node_modules/crypto-js/sha256.js\");\n/* harmony import */ var crypto_js_sha256__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto_js_sha256__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var crypto_js_enc_base64__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto-js/enc-base64 */ \"(ssr)/./node_modules/crypto-js/enc-base64.js\");\n/* harmony import */ var crypto_js_enc_base64__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto_js_enc_base64__WEBPACK_IMPORTED_MODULE_2__);\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n // Used for OAuth parsing of Cognito Hosted UI\n\n\n\n\n\n\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nvar dispatchAuthEvent = function (event, data, message) {\n    _aws_amplify_core__WEBPACK_IMPORTED_MODULE_3__.Hub.dispatch('auth', { event: event, data: data, message: message }, 'Auth', AMPLIFY_SYMBOL);\n};\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__.ConsoleLogger('OAuth');\nvar OAuth = /** @class */ (function () {\n    function OAuth(_a) {\n        var config = _a.config, cognitoClientId = _a.cognitoClientId, _b = _a.scopes, scopes = _b === void 0 ? [] : _b;\n        this._urlOpener = config.urlOpener || _urlOpener__WEBPACK_IMPORTED_MODULE_5__.launchUri;\n        this._config = config;\n        this._cognitoClientId = cognitoClientId;\n        if (!this.isValidScopes(scopes))\n            throw Error('scopes must be a String Array');\n        this._scopes = scopes;\n    }\n    OAuth.prototype.isValidScopes = function (scopes) {\n        return (Array.isArray(scopes) && scopes.every(function (scope) { return typeof scope === 'string'; }));\n    };\n    OAuth.prototype.oauthSignIn = function (responseType, domain, redirectSignIn, clientId, provider, customState) {\n        if (responseType === void 0) { responseType = 'code'; }\n        if (provider === void 0) { provider = _types_Auth__WEBPACK_IMPORTED_MODULE_6__.CognitoHostedUIIdentityProvider.Cognito; }\n        var generatedState = this._generateState(32);\n        /* encodeURIComponent is not URL safe, use urlSafeEncode instead. Cognito\n        single-encodes/decodes url on first sign in and double-encodes/decodes url\n        when user already signed in. Using encodeURIComponent, Base32, Base64 add\n        characters % or = which on further encoding becomes unsafe. '=' create issue\n        for parsing query params.\n        Refer: https://github.com/aws-amplify/amplify-js/issues/5218 */\n        var state = customState\n            ? generatedState + \"-\" + (0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.urlSafeEncode)(customState)\n            : generatedState;\n        _oauthStorage__WEBPACK_IMPORTED_MODULE_8__.setState(state);\n        var pkce_key = this._generateRandom(128);\n        _oauthStorage__WEBPACK_IMPORTED_MODULE_8__.setPKCE(pkce_key);\n        var code_challenge = this._generateChallenge(pkce_key);\n        var code_challenge_method = 'S256';\n        var scopesString = this._scopes.join(' ');\n        var queryString = Object.entries(__assign(__assign({ redirect_uri: redirectSignIn, response_type: responseType, client_id: clientId, identity_provider: provider, scope: scopesString, state: state }, (responseType === 'code' ? { code_challenge: code_challenge } : {})), (responseType === 'code' ? { code_challenge_method: code_challenge_method } : {})))\n            .map(function (_a) {\n            var _b = __read(_a, 2), k = _b[0], v = _b[1];\n            return encodeURIComponent(k) + \"=\" + encodeURIComponent(v);\n        })\n            .join('&');\n        var URL = \"https://\" + domain + \"/oauth2/authorize?\" + queryString;\n        logger.debug(\"Redirecting to \" + URL);\n        this._urlOpener(URL, redirectSignIn);\n    };\n    OAuth.prototype._handleCodeFlow = function (currentUrl) {\n        return __awaiter(this, void 0, void 0, function () {\n            var code, currentUrlPathname, redirectSignInPathname, oAuthTokenEndpoint, client_id, redirect_uri, code_verifier, oAuthTokenBody, body, _a, access_token, refresh_token, id_token, error;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        code = ((0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(currentUrl).query || '')\n                            .split('&')\n                            .map(function (pairings) { return pairings.split('='); })\n                            .reduce(function (accum, _a) {\n                            var _b;\n                            var _c = __read(_a, 2), k = _c[0], v = _c[1];\n                            return (__assign(__assign({}, accum), (_b = {}, _b[k] = v, _b)));\n                        }, { code: undefined }).code;\n                        currentUrlPathname = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(currentUrl).pathname || '/';\n                        redirectSignInPathname = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(this._config.redirectSignIn).pathname || '/';\n                        if (!code || currentUrlPathname !== redirectSignInPathname) {\n                            return [2 /*return*/];\n                        }\n                        oAuthTokenEndpoint = 'https://' + this._config.domain + '/oauth2/token';\n                        dispatchAuthEvent('codeFlow', {}, \"Retrieving tokens from \" + oAuthTokenEndpoint);\n                        client_id = (0,_types_Auth__WEBPACK_IMPORTED_MODULE_6__.isCognitoHostedOpts)(this._config)\n                            ? this._cognitoClientId\n                            : this._config.clientID;\n                        redirect_uri = (0,_types_Auth__WEBPACK_IMPORTED_MODULE_6__.isCognitoHostedOpts)(this._config)\n                            ? this._config.redirectSignIn\n                            : this._config.redirectUri;\n                        code_verifier = _oauthStorage__WEBPACK_IMPORTED_MODULE_8__.getPKCE();\n                        oAuthTokenBody = __assign({ grant_type: 'authorization_code', code: code,\n                            client_id: client_id,\n                            redirect_uri: redirect_uri }, (code_verifier ? { code_verifier: code_verifier } : {}));\n                        logger.debug(\"Calling token endpoint: \" + oAuthTokenEndpoint + \" with\", oAuthTokenBody);\n                        body = Object.entries(oAuthTokenBody)\n                            .map(function (_a) {\n                            var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                            return encodeURIComponent(k) + \"=\" + encodeURIComponent(v);\n                        })\n                            .join('&');\n                        return [4 /*yield*/, fetch(oAuthTokenEndpoint, {\n                                method: 'POST',\n                                headers: {\n                                    'Content-Type': 'application/x-www-form-urlencoded',\n                                },\n                                body: body,\n                            })];\n                    case 1: return [4 /*yield*/, (_b.sent()).json()];\n                    case 2:\n                        _a = _b.sent(), access_token = _a.access_token, refresh_token = _a.refresh_token, id_token = _a.id_token, error = _a.error;\n                        if (error) {\n                            throw new Error(error);\n                        }\n                        return [2 /*return*/, {\n                                accessToken: access_token,\n                                refreshToken: refresh_token,\n                                idToken: id_token,\n                            }];\n                }\n            });\n        });\n    };\n    OAuth.prototype._handleImplicitFlow = function (currentUrl) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, id_token, access_token;\n            return __generator(this, function (_b) {\n                _a = ((0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(currentUrl).hash || '#')\n                    .substr(1) // Remove # from returned code\n                    .split('&')\n                    .map(function (pairings) { return pairings.split('='); })\n                    .reduce(function (accum, _a) {\n                    var _b;\n                    var _c = __read(_a, 2), k = _c[0], v = _c[1];\n                    return (__assign(__assign({}, accum), (_b = {}, _b[k] = v, _b)));\n                }, {\n                    id_token: undefined,\n                    access_token: undefined,\n                }), id_token = _a.id_token, access_token = _a.access_token;\n                dispatchAuthEvent('implicitFlow', {}, \"Got tokens from \" + currentUrl);\n                logger.debug(\"Retrieving implicit tokens from \" + currentUrl + \" with\");\n                return [2 /*return*/, {\n                        accessToken: access_token,\n                        idToken: id_token,\n                        refreshToken: null,\n                    }];\n            });\n        });\n    };\n    OAuth.prototype.handleAuthResponse = function (currentUrl) {\n        return __awaiter(this, void 0, void 0, function () {\n            var urlParams, error, error_description, state, _a, _b, e_1;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _c.trys.push([0, 5, , 6]);\n                        urlParams = currentUrl\n                            ? __assign(__assign({}, ((0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(currentUrl).hash || '#')\n                                .substr(1)\n                                .split('&')\n                                .map(function (entry) { return entry.split('='); })\n                                .reduce(function (acc, _a) {\n                                var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                                return ((acc[k] = v), acc);\n                            }, {})), ((0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(currentUrl).query || '')\n                                .split('&')\n                                .map(function (entry) { return entry.split('='); })\n                                .reduce(function (acc, _a) {\n                                var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                                return ((acc[k] = v), acc);\n                            }, {}))\n                            : {};\n                        error = urlParams.error, error_description = urlParams.error_description;\n                        if (error) {\n                            throw new Error(error_description);\n                        }\n                        state = this._validateState(urlParams);\n                        logger.debug(\"Starting \" + this._config.responseType + \" flow with \" + currentUrl);\n                        if (!(this._config.responseType === 'code')) return [3 /*break*/, 2];\n                        _a = [{}];\n                        return [4 /*yield*/, this._handleCodeFlow(currentUrl)];\n                    case 1: return [2 /*return*/, __assign.apply(void 0, [__assign.apply(void 0, _a.concat([(_c.sent())])), { state: state }])];\n                    case 2:\n                        _b = [{}];\n                        return [4 /*yield*/, this._handleImplicitFlow(currentUrl)];\n                    case 3: return [2 /*return*/, __assign.apply(void 0, [__assign.apply(void 0, _b.concat([(_c.sent())])), { state: state }])];\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_1 = _c.sent();\n                        logger.error(\"Error handling auth response.\", e_1);\n                        throw e_1;\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    OAuth.prototype._validateState = function (urlParams) {\n        if (!urlParams) {\n            return;\n        }\n        var savedState = _oauthStorage__WEBPACK_IMPORTED_MODULE_8__.getState();\n        var returnedState = urlParams.state;\n        // This is because savedState only exists if the flow was initiated by Amplify\n        if (savedState && savedState !== returnedState) {\n            throw new Error('Invalid state in OAuth flow');\n        }\n        return returnedState;\n    };\n    OAuth.prototype.signOut = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var oAuthLogoutEndpoint, client_id, signout_uri;\n            return __generator(this, function (_a) {\n                oAuthLogoutEndpoint = 'https://' + this._config.domain + '/logout?';\n                client_id = (0,_types_Auth__WEBPACK_IMPORTED_MODULE_6__.isCognitoHostedOpts)(this._config)\n                    ? this._cognitoClientId\n                    : this._config.oauth.clientID;\n                signout_uri = (0,_types_Auth__WEBPACK_IMPORTED_MODULE_6__.isCognitoHostedOpts)(this._config)\n                    ? this._config.redirectSignOut\n                    : this._config.returnTo;\n                oAuthLogoutEndpoint += Object.entries({\n                    client_id: client_id,\n                    logout_uri: encodeURIComponent(signout_uri),\n                })\n                    .map(function (_a) {\n                    var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                    return k + \"=\" + v;\n                })\n                    .join('&');\n                dispatchAuthEvent('oAuthSignOut', { oAuth: 'signOut' }, \"Signing out from \" + oAuthLogoutEndpoint);\n                logger.debug(\"Signing out from \" + oAuthLogoutEndpoint);\n                return [2 /*return*/, this._urlOpener(oAuthLogoutEndpoint, signout_uri)];\n            });\n        });\n    };\n    OAuth.prototype._generateState = function (length) {\n        var result = '';\n        var i = length;\n        var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n        for (; i > 0; --i)\n            result += chars[Math.round(Math.random() * (chars.length - 1))];\n        return result;\n    };\n    OAuth.prototype._generateChallenge = function (code) {\n        return this._base64URL(crypto_js_sha256__WEBPACK_IMPORTED_MODULE_1___default()(code));\n    };\n    OAuth.prototype._base64URL = function (string) {\n        return string\n            .toString((crypto_js_enc_base64__WEBPACK_IMPORTED_MODULE_2___default()))\n            .replace(/=/g, '')\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_');\n    };\n    OAuth.prototype._generateRandom = function (size) {\n        var CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\n        var buffer = new Uint8Array(size);\n        if (typeof window !== 'undefined' && !!window.crypto) {\n            window.crypto.getRandomValues(buffer);\n        }\n        else {\n            for (var i = 0; i < size; i += 1) {\n                buffer[i] = (Math.random() * CHARSET.length) | 0;\n            }\n        }\n        return this._bufferToString(buffer);\n    };\n    OAuth.prototype._bufferToString = function (buffer) {\n        var CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n        var state = [];\n        for (var i = 0; i < buffer.byteLength; i += 1) {\n            var index = buffer[i] % CHARSET.length;\n            state.push(CHARSET[index]);\n        }\n        return state.join('');\n    };\n    return OAuth;\n}());\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OAuth);\n//# sourceMappingURL=OAuth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9PQXV0aC9PQXV0aC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQUksSUFBSSxTQUFJO0FBQzVCO0FBQ0EsaURBQWlELE9BQU87QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3Qiw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBLG1CQUFtQixTQUFJLElBQUksU0FBSTtBQUMvQixjQUFjLDZCQUE2QiwwQkFBMEIsY0FBYyxxQkFBcUI7QUFDeEcsaUJBQWlCLG9EQUFvRCxxRUFBcUUsY0FBYztBQUN4Six1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QyxtQ0FBbUMsU0FBUztBQUM1QyxtQ0FBbUMsV0FBVyxVQUFVO0FBQ3hELDBDQUEwQyxjQUFjO0FBQ3hEO0FBQ0EsOEdBQThHLE9BQU87QUFDckgsaUZBQWlGLGlCQUFpQjtBQUNsRyx5REFBeUQsZ0JBQWdCLFFBQVE7QUFDakYsK0NBQStDLGdCQUFnQixnQkFBZ0I7QUFDL0U7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBLFVBQVUsWUFBWSxhQUFhLFNBQVMsVUFBVTtBQUN0RCxvQ0FBb0MsU0FBUztBQUM3QztBQUNBO0FBQ0EsY0FBYyxTQUFJLElBQUksU0FBSTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDNEIsQ0FBQztBQUNXO0FBQ087QUFDdUM7QUFDTjtBQUMxQztBQUNJO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLGtEQUFHLG9CQUFvQiw0Q0FBNEM7QUFDdkU7QUFDQSxpQkFBaUIsNERBQU07QUFDdkI7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGlEQUFTO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUVBQXlFLG1DQUFtQztBQUM1RztBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLG1DQUFtQyxXQUFXLHdFQUErQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGdFQUFhO0FBQ2xEO0FBQ0EsUUFBUSxtREFBcUI7QUFDN0I7QUFDQSxRQUFRLGtEQUFvQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsZ0pBQWdKLCtCQUErQixpQ0FBaUMsSUFBSSxpQ0FBaUMsK0NBQStDLElBQUk7QUFDclc7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsMENBQUs7QUFDckM7QUFDQSx1REFBdUQsNkJBQTZCO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxrQkFBa0I7QUFDMUUseUJBQXlCLElBQUksaUJBQWlCO0FBQzlDLDZDQUE2QywwQ0FBSztBQUNsRCxpREFBaUQsMENBQUs7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQsb0NBQW9DLGdFQUFtQjtBQUN2RDtBQUNBO0FBQ0EsdUNBQXVDLGdFQUFtQjtBQUMxRDtBQUNBO0FBQ0Esd0NBQXdDLGtEQUFvQjtBQUM1RCxvREFBb0Q7QUFDcEQ7QUFDQSx3REFBd0QscUJBQXFCLCtCQUErQixJQUFJO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwwQ0FBSztBQUMzQjtBQUNBO0FBQ0EsK0NBQStDLDZCQUE2QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Qsa0JBQWtCO0FBQ2xFLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELEdBQUcsMENBQUs7QUFDMUQ7QUFDQTtBQUNBLHdEQUF3RCwwQkFBMEI7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLElBQUksS0FBSywwQ0FBSztBQUMzQztBQUNBLHdEQUF3RCwwQkFBMEI7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLElBQUk7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBLDhIQUE4SCxjQUFjO0FBQzVJO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0EsOEhBQThILGNBQWM7QUFDNUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbURBQXFCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnRUFBbUI7QUFDL0M7QUFDQTtBQUNBLDhCQUE4QixnRUFBbUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxvREFBb0Qsa0JBQWtCO0FBQ3RFO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsdURBQU07QUFDckM7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDZEQUFNO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUVBQWUsS0FBSyxFQUFDO0FBQ3JCIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvYXV0aC9saWItZXNtL09BdXRoL09BdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgX19hc3NpZ24gPSAodGhpcyAmJiB0aGlzLl9fYXNzaWduKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbmltcG9ydCB7IHBhcnNlIH0gZnJvbSAndXJsJzsgLy8gVXNlZCBmb3IgT0F1dGggcGFyc2luZyBvZiBDb2duaXRvIEhvc3RlZCBVSVxuaW1wb3J0IHsgbGF1bmNoVXJpIH0gZnJvbSAnLi91cmxPcGVuZXInO1xuaW1wb3J0ICogYXMgb0F1dGhTdG9yYWdlIGZyb20gJy4vb2F1dGhTdG9yYWdlJztcbmltcG9ydCB7IGlzQ29nbml0b0hvc3RlZE9wdHMsIENvZ25pdG9Ib3N0ZWRVSUlkZW50aXR5UHJvdmlkZXIsIH0gZnJvbSAnLi4vdHlwZXMvQXV0aCc7XG5pbXBvcnQgeyBDb25zb2xlTG9nZ2VyIGFzIExvZ2dlciwgSHViLCB1cmxTYWZlRW5jb2RlIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L2NvcmUnO1xuaW1wb3J0IHNoYTI1NiBmcm9tICdjcnlwdG8tanMvc2hhMjU2JztcbmltcG9ydCBCYXNlNjQgZnJvbSAnY3J5cHRvLWpzL2VuYy1iYXNlNjQnO1xudmFyIEFNUExJRllfU1lNQk9MID0gKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIFN5bWJvbC5mb3IgPT09ICdmdW5jdGlvbidcbiAgICA/IFN5bWJvbC5mb3IoJ2FtcGxpZnlfZGVmYXVsdCcpXG4gICAgOiAnQEBhbXBsaWZ5X2RlZmF1bHQnKTtcbnZhciBkaXNwYXRjaEF1dGhFdmVudCA9IGZ1bmN0aW9uIChldmVudCwgZGF0YSwgbWVzc2FnZSkge1xuICAgIEh1Yi5kaXNwYXRjaCgnYXV0aCcsIHsgZXZlbnQ6IGV2ZW50LCBkYXRhOiBkYXRhLCBtZXNzYWdlOiBtZXNzYWdlIH0sICdBdXRoJywgQU1QTElGWV9TWU1CT0wpO1xufTtcbnZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdPQXV0aCcpO1xudmFyIE9BdXRoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE9BdXRoKF9hKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBfYS5jb25maWcsIGNvZ25pdG9DbGllbnRJZCA9IF9hLmNvZ25pdG9DbGllbnRJZCwgX2IgPSBfYS5zY29wZXMsIHNjb3BlcyA9IF9iID09PSB2b2lkIDAgPyBbXSA6IF9iO1xuICAgICAgICB0aGlzLl91cmxPcGVuZXIgPSBjb25maWcudXJsT3BlbmVyIHx8IGxhdW5jaFVyaTtcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLl9jb2duaXRvQ2xpZW50SWQgPSBjb2duaXRvQ2xpZW50SWQ7XG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkU2NvcGVzKHNjb3BlcykpXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignc2NvcGVzIG11c3QgYmUgYSBTdHJpbmcgQXJyYXknKTtcbiAgICAgICAgdGhpcy5fc2NvcGVzID0gc2NvcGVzO1xuICAgIH1cbiAgICBPQXV0aC5wcm90b3R5cGUuaXNWYWxpZFNjb3BlcyA9IGZ1bmN0aW9uIChzY29wZXMpIHtcbiAgICAgICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHNjb3BlcykgJiYgc2NvcGVzLmV2ZXJ5KGZ1bmN0aW9uIChzY29wZSkgeyByZXR1cm4gdHlwZW9mIHNjb3BlID09PSAnc3RyaW5nJzsgfSkpO1xuICAgIH07XG4gICAgT0F1dGgucHJvdG90eXBlLm9hdXRoU2lnbkluID0gZnVuY3Rpb24gKHJlc3BvbnNlVHlwZSwgZG9tYWluLCByZWRpcmVjdFNpZ25JbiwgY2xpZW50SWQsIHByb3ZpZGVyLCBjdXN0b21TdGF0ZSkge1xuICAgICAgICBpZiAocmVzcG9uc2VUeXBlID09PSB2b2lkIDApIHsgcmVzcG9uc2VUeXBlID0gJ2NvZGUnOyB9XG4gICAgICAgIGlmIChwcm92aWRlciA9PT0gdm9pZCAwKSB7IHByb3ZpZGVyID0gQ29nbml0b0hvc3RlZFVJSWRlbnRpdHlQcm92aWRlci5Db2duaXRvOyB9XG4gICAgICAgIHZhciBnZW5lcmF0ZWRTdGF0ZSA9IHRoaXMuX2dlbmVyYXRlU3RhdGUoMzIpO1xuICAgICAgICAvKiBlbmNvZGVVUklDb21wb25lbnQgaXMgbm90IFVSTCBzYWZlLCB1c2UgdXJsU2FmZUVuY29kZSBpbnN0ZWFkLiBDb2duaXRvXG4gICAgICAgIHNpbmdsZS1lbmNvZGVzL2RlY29kZXMgdXJsIG9uIGZpcnN0IHNpZ24gaW4gYW5kIGRvdWJsZS1lbmNvZGVzL2RlY29kZXMgdXJsXG4gICAgICAgIHdoZW4gdXNlciBhbHJlYWR5IHNpZ25lZCBpbi4gVXNpbmcgZW5jb2RlVVJJQ29tcG9uZW50LCBCYXNlMzIsIEJhc2U2NCBhZGRcbiAgICAgICAgY2hhcmFjdGVycyAlIG9yID0gd2hpY2ggb24gZnVydGhlciBlbmNvZGluZyBiZWNvbWVzIHVuc2FmZS4gJz0nIGNyZWF0ZSBpc3N1ZVxuICAgICAgICBmb3IgcGFyc2luZyBxdWVyeSBwYXJhbXMuXG4gICAgICAgIFJlZmVyOiBodHRwczovL2dpdGh1Yi5jb20vYXdzLWFtcGxpZnkvYW1wbGlmeS1qcy9pc3N1ZXMvNTIxOCAqL1xuICAgICAgICB2YXIgc3RhdGUgPSBjdXN0b21TdGF0ZVxuICAgICAgICAgICAgPyBnZW5lcmF0ZWRTdGF0ZSArIFwiLVwiICsgdXJsU2FmZUVuY29kZShjdXN0b21TdGF0ZSlcbiAgICAgICAgICAgIDogZ2VuZXJhdGVkU3RhdGU7XG4gICAgICAgIG9BdXRoU3RvcmFnZS5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgIHZhciBwa2NlX2tleSA9IHRoaXMuX2dlbmVyYXRlUmFuZG9tKDEyOCk7XG4gICAgICAgIG9BdXRoU3RvcmFnZS5zZXRQS0NFKHBrY2Vfa2V5KTtcbiAgICAgICAgdmFyIGNvZGVfY2hhbGxlbmdlID0gdGhpcy5fZ2VuZXJhdGVDaGFsbGVuZ2UocGtjZV9rZXkpO1xuICAgICAgICB2YXIgY29kZV9jaGFsbGVuZ2VfbWV0aG9kID0gJ1MyNTYnO1xuICAgICAgICB2YXIgc2NvcGVzU3RyaW5nID0gdGhpcy5fc2NvcGVzLmpvaW4oJyAnKTtcbiAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nID0gT2JqZWN0LmVudHJpZXMoX19hc3NpZ24oX19hc3NpZ24oeyByZWRpcmVjdF91cmk6IHJlZGlyZWN0U2lnbkluLCByZXNwb25zZV90eXBlOiByZXNwb25zZVR5cGUsIGNsaWVudF9pZDogY2xpZW50SWQsIGlkZW50aXR5X3Byb3ZpZGVyOiBwcm92aWRlciwgc2NvcGU6IHNjb3Blc1N0cmluZywgc3RhdGU6IHN0YXRlIH0sIChyZXNwb25zZVR5cGUgPT09ICdjb2RlJyA/IHsgY29kZV9jaGFsbGVuZ2U6IGNvZGVfY2hhbGxlbmdlIH0gOiB7fSkpLCAocmVzcG9uc2VUeXBlID09PSAnY29kZScgPyB7IGNvZGVfY2hhbGxlbmdlX21ldGhvZDogY29kZV9jaGFsbGVuZ2VfbWV0aG9kIH0gOiB7fSkpKVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksIGsgPSBfYlswXSwgdiA9IF9iWzFdO1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHYpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oJyYnKTtcbiAgICAgICAgdmFyIFVSTCA9IFwiaHR0cHM6Ly9cIiArIGRvbWFpbiArIFwiL29hdXRoMi9hdXRob3JpemU/XCIgKyBxdWVyeVN0cmluZztcbiAgICAgICAgbG9nZ2VyLmRlYnVnKFwiUmVkaXJlY3RpbmcgdG8gXCIgKyBVUkwpO1xuICAgICAgICB0aGlzLl91cmxPcGVuZXIoVVJMLCByZWRpcmVjdFNpZ25Jbik7XG4gICAgfTtcbiAgICBPQXV0aC5wcm90b3R5cGUuX2hhbmRsZUNvZGVGbG93ID0gZnVuY3Rpb24gKGN1cnJlbnRVcmwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvZGUsIGN1cnJlbnRVcmxQYXRobmFtZSwgcmVkaXJlY3RTaWduSW5QYXRobmFtZSwgb0F1dGhUb2tlbkVuZHBvaW50LCBjbGllbnRfaWQsIHJlZGlyZWN0X3VyaSwgY29kZV92ZXJpZmllciwgb0F1dGhUb2tlbkJvZHksIGJvZHksIF9hLCBhY2Nlc3NfdG9rZW4sIHJlZnJlc2hfdG9rZW4sIGlkX3Rva2VuLCBlcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUgPSAocGFyc2UoY3VycmVudFVybCkucXVlcnkgfHwgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KCcmJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChwYWlyaW5ncykgeyByZXR1cm4gcGFpcmluZ3Muc3BsaXQoJz0nKTsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jID0gX19yZWFkKF9hLCAyKSwgayA9IF9jWzBdLCB2ID0gX2NbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYWNjdW0pLCAoX2IgPSB7fSwgX2Jba10gPSB2LCBfYikpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsgY29kZTogdW5kZWZpbmVkIH0pLmNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXJsUGF0aG5hbWUgPSBwYXJzZShjdXJyZW50VXJsKS5wYXRobmFtZSB8fCAnLyc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFNpZ25JblBhdGhuYW1lID0gcGFyc2UodGhpcy5fY29uZmlnLnJlZGlyZWN0U2lnbkluKS5wYXRobmFtZSB8fCAnLyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvZGUgfHwgY3VycmVudFVybFBhdGhuYW1lICE9PSByZWRpcmVjdFNpZ25JblBhdGhuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb0F1dGhUb2tlbkVuZHBvaW50ID0gJ2h0dHBzOi8vJyArIHRoaXMuX2NvbmZpZy5kb21haW4gKyAnL29hdXRoMi90b2tlbic7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEF1dGhFdmVudCgnY29kZUZsb3cnLCB7fSwgXCJSZXRyaWV2aW5nIHRva2VucyBmcm9tIFwiICsgb0F1dGhUb2tlbkVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudF9pZCA9IGlzQ29nbml0b0hvc3RlZE9wdHModGhpcy5fY29uZmlnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5fY29nbml0b0NsaWVudElkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLl9jb25maWcuY2xpZW50SUQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdF91cmkgPSBpc0NvZ25pdG9Ib3N0ZWRPcHRzKHRoaXMuX2NvbmZpZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX2NvbmZpZy5yZWRpcmVjdFNpZ25JblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5fY29uZmlnLnJlZGlyZWN0VXJpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29kZV92ZXJpZmllciA9IG9BdXRoU3RvcmFnZS5nZXRQS0NFKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvQXV0aFRva2VuQm9keSA9IF9fYXNzaWduKHsgZ3JhbnRfdHlwZTogJ2F1dGhvcml6YXRpb25fY29kZScsIGNvZGU6IGNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3RfdXJpOiByZWRpcmVjdF91cmkgfSwgKGNvZGVfdmVyaWZpZXIgPyB7IGNvZGVfdmVyaWZpZXI6IGNvZGVfdmVyaWZpZXIgfSA6IHt9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDYWxsaW5nIHRva2VuIGVuZHBvaW50OiBcIiArIG9BdXRoVG9rZW5FbmRwb2ludCArIFwiIHdpdGhcIiwgb0F1dGhUb2tlbkJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYm9keSA9IE9iamVjdC5lbnRyaWVzKG9BdXRoVG9rZW5Cb2R5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAyKSwgayA9IF9iWzBdLCB2ID0gX2JbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbignJicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2gob0F1dGhUb2tlbkVuZHBvaW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IGJvZHksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIChfYi5zZW50KCkpLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gX2Iuc2VudCgpLCBhY2Nlc3NfdG9rZW4gPSBfYS5hY2Nlc3NfdG9rZW4sIHJlZnJlc2hfdG9rZW4gPSBfYS5yZWZyZXNoX3Rva2VuLCBpZF90b2tlbiA9IF9hLmlkX3Rva2VuLCBlcnJvciA9IF9hLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NfdG9rZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaF90b2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjogaWRfdG9rZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT0F1dGgucHJvdG90eXBlLl9oYW5kbGVJbXBsaWNpdEZsb3cgPSBmdW5jdGlvbiAoY3VycmVudFVybCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2EsIGlkX3Rva2VuLCBhY2Nlc3NfdG9rZW47XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgX2EgPSAocGFyc2UoY3VycmVudFVybCkuaGFzaCB8fCAnIycpXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzdHIoMSkgLy8gUmVtb3ZlICMgZnJvbSByZXR1cm5lZCBjb2RlXG4gICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnJicpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHBhaXJpbmdzKSB7IHJldHVybiBwYWlyaW5ncy5zcGxpdCgnPScpOyB9KVxuICAgICAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2MgPSBfX3JlYWQoX2EsIDIpLCBrID0gX2NbMF0sIHYgPSBfY1sxXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYWNjdW0pLCAoX2IgPSB7fSwgX2Jba10gPSB2LCBfYikpKTtcbiAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIGlkX3Rva2VuOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc190b2tlbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIH0pLCBpZF90b2tlbiA9IF9hLmlkX3Rva2VuLCBhY2Nlc3NfdG9rZW4gPSBfYS5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ2ltcGxpY2l0RmxvdycsIHt9LCBcIkdvdCB0b2tlbnMgZnJvbSBcIiArIGN1cnJlbnRVcmwpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIlJldHJpZXZpbmcgaW1wbGljaXQgdG9rZW5zIGZyb20gXCIgKyBjdXJyZW50VXJsICsgXCIgd2l0aFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc190b2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkVG9rZW46IGlkX3Rva2VuLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9BdXRoLnByb3RvdHlwZS5oYW5kbGVBdXRoUmVzcG9uc2UgPSBmdW5jdGlvbiAoY3VycmVudFVybCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXJsUGFyYW1zLCBlcnJvciwgZXJyb3JfZGVzY3JpcHRpb24sIHN0YXRlLCBfYSwgX2IsIGVfMTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMCwgNSwgLCA2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmxQYXJhbXMgPSBjdXJyZW50VXJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgKHBhcnNlKGN1cnJlbnRVcmwpLmhhc2ggfHwgJyMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3Vic3RyKDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnJicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGVudHJ5KSB7IHJldHVybiBlbnRyeS5zcGxpdCgnPScpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChhY2MsIF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksIGsgPSBfYlswXSwgdiA9IF9iWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChhY2Nba10gPSB2KSwgYWNjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7fSkpLCAocGFyc2UoY3VycmVudFVybCkucXVlcnkgfHwgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgnJicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGVudHJ5KSB7IHJldHVybiBlbnRyeS5zcGxpdCgnPScpOyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChhY2MsIF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksIGsgPSBfYlswXSwgdiA9IF9iWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChhY2Nba10gPSB2KSwgYWNjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7fSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gdXJsUGFyYW1zLmVycm9yLCBlcnJvcl9kZXNjcmlwdGlvbiA9IHVybFBhcmFtcy5lcnJvcl9kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcl9kZXNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXMuX3ZhbGlkYXRlU3RhdGUodXJsUGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcIlN0YXJ0aW5nIFwiICsgdGhpcy5fY29uZmlnLnJlc3BvbnNlVHlwZSArIFwiIGZsb3cgd2l0aCBcIiArIGN1cnJlbnRVcmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5fY29uZmlnLnJlc3BvbnNlVHlwZSA9PT0gJ2NvZGUnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IFt7fV07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9oYW5kbGVDb2RlRmxvdyhjdXJyZW50VXJsKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9fYXNzaWduLmFwcGx5KHZvaWQgMCwgW19fYXNzaWduLmFwcGx5KHZvaWQgMCwgX2EuY29uY2F0KFsoX2Muc2VudCgpKV0pKSwgeyBzdGF0ZTogc3RhdGUgfV0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbe31dO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5faGFuZGxlSW1wbGljaXRGbG93KGN1cnJlbnRVcmwpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qLywgX19hc3NpZ24uYXBwbHkodm9pZCAwLCBbX19hc3NpZ24uYXBwbHkodm9pZCAwLCBfYi5jb25jYXQoWyhfYy5zZW50KCkpXSkpLCB7IHN0YXRlOiBzdGF0ZSB9XSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciBoYW5kbGluZyBhdXRoIHJlc3BvbnNlLlwiLCBlXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZV8xO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPQXV0aC5wcm90b3R5cGUuX3ZhbGlkYXRlU3RhdGUgPSBmdW5jdGlvbiAodXJsUGFyYW1zKSB7XG4gICAgICAgIGlmICghdXJsUGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNhdmVkU3RhdGUgPSBvQXV0aFN0b3JhZ2UuZ2V0U3RhdGUoKTtcbiAgICAgICAgdmFyIHJldHVybmVkU3RhdGUgPSB1cmxQYXJhbXMuc3RhdGU7XG4gICAgICAgIC8vIFRoaXMgaXMgYmVjYXVzZSBzYXZlZFN0YXRlIG9ubHkgZXhpc3RzIGlmIHRoZSBmbG93IHdhcyBpbml0aWF0ZWQgYnkgQW1wbGlmeVxuICAgICAgICBpZiAoc2F2ZWRTdGF0ZSAmJiBzYXZlZFN0YXRlICE9PSByZXR1cm5lZFN0YXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RhdGUgaW4gT0F1dGggZmxvdycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXR1cm5lZFN0YXRlO1xuICAgIH07XG4gICAgT0F1dGgucHJvdG90eXBlLnNpZ25PdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvQXV0aExvZ291dEVuZHBvaW50LCBjbGllbnRfaWQsIHNpZ25vdXRfdXJpO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIG9BdXRoTG9nb3V0RW5kcG9pbnQgPSAnaHR0cHM6Ly8nICsgdGhpcy5fY29uZmlnLmRvbWFpbiArICcvbG9nb3V0Pyc7XG4gICAgICAgICAgICAgICAgY2xpZW50X2lkID0gaXNDb2duaXRvSG9zdGVkT3B0cyh0aGlzLl9jb25maWcpXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5fY29nbml0b0NsaWVudElkXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5fY29uZmlnLm9hdXRoLmNsaWVudElEO1xuICAgICAgICAgICAgICAgIHNpZ25vdXRfdXJpID0gaXNDb2duaXRvSG9zdGVkT3B0cyh0aGlzLl9jb25maWcpXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5fY29uZmlnLnJlZGlyZWN0U2lnbk91dFxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMuX2NvbmZpZy5yZXR1cm5UbztcbiAgICAgICAgICAgICAgICBvQXV0aExvZ291dEVuZHBvaW50ICs9IE9iamVjdC5lbnRyaWVzKHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRfaWQsXG4gICAgICAgICAgICAgICAgICAgIGxvZ291dF91cmk6IGVuY29kZVVSSUNvbXBvbmVudChzaWdub3V0X3VyaSksXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX19yZWFkKF9hLCAyKSwgayA9IF9iWzBdLCB2ID0gX2JbMV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrICsgXCI9XCIgKyB2O1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCcmJyk7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hBdXRoRXZlbnQoJ29BdXRoU2lnbk91dCcsIHsgb0F1dGg6ICdzaWduT3V0JyB9LCBcIlNpZ25pbmcgb3V0IGZyb20gXCIgKyBvQXV0aExvZ291dEVuZHBvaW50KTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJTaWduaW5nIG91dCBmcm9tIFwiICsgb0F1dGhMb2dvdXRFbmRwb2ludCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuX3VybE9wZW5lcihvQXV0aExvZ291dEVuZHBvaW50LCBzaWdub3V0X3VyaSldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT0F1dGgucHJvdG90eXBlLl9nZW5lcmF0ZVN0YXRlID0gZnVuY3Rpb24gKGxlbmd0aCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgICAgIHZhciBpID0gbGVuZ3RoO1xuICAgICAgICB2YXIgY2hhcnMgPSAnMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xuICAgICAgICBmb3IgKDsgaSA+IDA7IC0taSlcbiAgICAgICAgICAgIHJlc3VsdCArPSBjaGFyc1tNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoY2hhcnMubGVuZ3RoIC0gMSkpXTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9BdXRoLnByb3RvdHlwZS5fZ2VuZXJhdGVDaGFsbGVuZ2UgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYmFzZTY0VVJMKHNoYTI1Nihjb2RlKSk7XG4gICAgfTtcbiAgICBPQXV0aC5wcm90b3R5cGUuX2Jhc2U2NFVSTCA9IGZ1bmN0aW9uIChzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZ1xuICAgICAgICAgICAgLnRvU3RyaW5nKEJhc2U2NClcbiAgICAgICAgICAgIC5yZXBsYWNlKC89L2csICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcKy9nLCAnLScpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwvL2csICdfJyk7XG4gICAgfTtcbiAgICBPQXV0aC5wcm90b3R5cGUuX2dlbmVyYXRlUmFuZG9tID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgICAgdmFyIENIQVJTRVQgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODktLl9+JztcbiAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KHNpemUpO1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgISF3aW5kb3cuY3J5cHRvKSB7XG4gICAgICAgICAgICB3aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhidWZmZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJbaV0gPSAoTWF0aC5yYW5kb20oKSAqIENIQVJTRVQubGVuZ3RoKSB8IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlclRvU3RyaW5nKGJ1ZmZlcik7XG4gICAgfTtcbiAgICBPQXV0aC5wcm90b3R5cGUuX2J1ZmZlclRvU3RyaW5nID0gZnVuY3Rpb24gKGJ1ZmZlcikge1xuICAgICAgICB2YXIgQ0hBUlNFVCA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSc7XG4gICAgICAgIHZhciBzdGF0ZSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlci5ieXRlTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGJ1ZmZlcltpXSAlIENIQVJTRVQubGVuZ3RoO1xuICAgICAgICAgICAgc3RhdGUucHVzaChDSEFSU0VUW2luZGV4XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YXRlLmpvaW4oJycpO1xuICAgIH07XG4gICAgcmV0dXJuIE9BdXRoO1xufSgpKTtcbmV4cG9ydCBkZWZhdWx0IE9BdXRoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9T0F1dGguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearAll: () => (/* binding */ clearAll),\n/* harmony export */   getPKCE: () => (/* binding */ getPKCE),\n/* harmony export */   getState: () => (/* binding */ getState),\n/* harmony export */   setPKCE: () => (/* binding */ setPKCE),\n/* harmony export */   setState: () => (/* binding */ setState)\n/* harmony export */ });\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar setState = function (state) {\n    window.sessionStorage.setItem('oauth_state', state);\n};\nvar getState = function () {\n    var oauth_state = window.sessionStorage.getItem('oauth_state');\n    window.sessionStorage.removeItem('oauth_state');\n    return oauth_state;\n};\nvar setPKCE = function (private_key) {\n    window.sessionStorage.setItem('ouath_pkce_key', private_key);\n};\nvar getPKCE = function () {\n    var ouath_pkce_key = window.sessionStorage.getItem('ouath_pkce_key');\n    window.sessionStorage.removeItem('ouath_pkce_key');\n    return ouath_pkce_key;\n};\nvar clearAll = function () {\n    window.sessionStorage.removeItem('ouath_pkce_key');\n    window.sessionStorage.removeItem('oauth_state');\n};\n//# sourceMappingURL=oauthStorage.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9PQXV0aC9vYXV0aFN0b3JhZ2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9hdXRoL2xpYi1lc20vT0F1dGgvb2F1dGhTdG9yYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5leHBvcnQgdmFyIHNldFN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ29hdXRoX3N0YXRlJywgc3RhdGUpO1xufTtcbmV4cG9ydCB2YXIgZ2V0U3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9hdXRoX3N0YXRlID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ29hdXRoX3N0YXRlJyk7XG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ29hdXRoX3N0YXRlJyk7XG4gICAgcmV0dXJuIG9hdXRoX3N0YXRlO1xufTtcbmV4cG9ydCB2YXIgc2V0UEtDRSA9IGZ1bmN0aW9uIChwcml2YXRlX2tleSkge1xuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdvdWF0aF9wa2NlX2tleScsIHByaXZhdGVfa2V5KTtcbn07XG5leHBvcnQgdmFyIGdldFBLQ0UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG91YXRoX3BrY2Vfa2V5ID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ291YXRoX3BrY2Vfa2V5Jyk7XG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ291YXRoX3BrY2Vfa2V5Jyk7XG4gICAgcmV0dXJuIG91YXRoX3BrY2Vfa2V5O1xufTtcbmV4cG9ydCB2YXIgY2xlYXJBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ291YXRoX3BrY2Vfa2V5Jyk7XG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ29hdXRoX3N0YXRlJyk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2F1dGhTdG9yYWdlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   launchUri: () => (/* binding */ launchUri)\n/* harmony export */ });\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar SELF = '_self';\nvar launchUri = function (url) {\n    var windowProxy = window.open(url, SELF);\n    if (windowProxy) {\n        return Promise.resolve(windowProxy);\n    }\n    else {\n        return Promise.reject();\n    }\n};\n//# sourceMappingURL=urlOpener.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9PQXV0aC91cmxPcGVuZXIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9hdXRoL2xpYi1lc20vT0F1dGgvdXJsT3BlbmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgU0VMRiA9ICdfc2VsZic7XG5leHBvcnQgdmFyIGxhdW5jaFVyaSA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICB2YXIgd2luZG93UHJveHkgPSB3aW5kb3cub3Blbih1cmwsIFNFTEYpO1xuICAgIGlmICh3aW5kb3dQcm94eSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHdpbmRvd1Byb3h5KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuICAgIH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD11cmxPcGVuZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthErrorStrings: () => (/* binding */ AuthErrorStrings)\n/* harmony export */ });\nvar AuthErrorStrings;\n(function (AuthErrorStrings) {\n    AuthErrorStrings[\"DEFAULT_MSG\"] = \"Authentication Error\";\n    AuthErrorStrings[\"EMPTY_EMAIL\"] = \"Email cannot be empty\";\n    AuthErrorStrings[\"EMPTY_PHONE\"] = \"Phone number cannot be empty\";\n    AuthErrorStrings[\"EMPTY_USERNAME\"] = \"Username cannot be empty\";\n    AuthErrorStrings[\"INVALID_USERNAME\"] = \"The username should either be a string or one of the sign in types\";\n    AuthErrorStrings[\"EMPTY_PASSWORD\"] = \"Password cannot be empty\";\n    AuthErrorStrings[\"EMPTY_CODE\"] = \"Confirmation code cannot be empty\";\n    AuthErrorStrings[\"SIGN_UP_ERROR\"] = \"Error creating account\";\n    AuthErrorStrings[\"NO_MFA\"] = \"No valid MFA method provided\";\n    AuthErrorStrings[\"INVALID_MFA\"] = \"Invalid MFA type\";\n    AuthErrorStrings[\"EMPTY_CHALLENGE\"] = \"Challenge response cannot be empty\";\n    AuthErrorStrings[\"NO_USER_SESSION\"] = \"Failed to get the session because the user is empty\";\n    AuthErrorStrings[\"NETWORK_ERROR\"] = \"Network Error\";\n    AuthErrorStrings[\"DEVICE_CONFIG\"] = \"Device tracking has not been configured in this User Pool\";\n    AuthErrorStrings[\"AUTOSIGNIN_ERROR\"] = \"Please use your credentials to sign in\";\n})(AuthErrorStrings || (AuthErrorStrings = {}));\n//# sourceMappingURL=AuthErrorStrings.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS9jb21tb24vQXV0aEVycm9yU3RyaW5ncy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNENBQTRDO0FBQzdDIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvYXV0aC9saWItZXNtL2NvbW1vbi9BdXRoRXJyb3JTdHJpbmdzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB2YXIgQXV0aEVycm9yU3RyaW5ncztcbihmdW5jdGlvbiAoQXV0aEVycm9yU3RyaW5ncykge1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJERUZBVUxUX01TR1wiXSA9IFwiQXV0aGVudGljYXRpb24gRXJyb3JcIjtcbiAgICBBdXRoRXJyb3JTdHJpbmdzW1wiRU1QVFlfRU1BSUxcIl0gPSBcIkVtYWlsIGNhbm5vdCBiZSBlbXB0eVwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJFTVBUWV9QSE9ORVwiXSA9IFwiUGhvbmUgbnVtYmVyIGNhbm5vdCBiZSBlbXB0eVwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJFTVBUWV9VU0VSTkFNRVwiXSA9IFwiVXNlcm5hbWUgY2Fubm90IGJlIGVtcHR5XCI7XG4gICAgQXV0aEVycm9yU3RyaW5nc1tcIklOVkFMSURfVVNFUk5BTUVcIl0gPSBcIlRoZSB1c2VybmFtZSBzaG91bGQgZWl0aGVyIGJlIGEgc3RyaW5nIG9yIG9uZSBvZiB0aGUgc2lnbiBpbiB0eXBlc1wiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJFTVBUWV9QQVNTV09SRFwiXSA9IFwiUGFzc3dvcmQgY2Fubm90IGJlIGVtcHR5XCI7XG4gICAgQXV0aEVycm9yU3RyaW5nc1tcIkVNUFRZX0NPREVcIl0gPSBcIkNvbmZpcm1hdGlvbiBjb2RlIGNhbm5vdCBiZSBlbXB0eVwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJTSUdOX1VQX0VSUk9SXCJdID0gXCJFcnJvciBjcmVhdGluZyBhY2NvdW50XCI7XG4gICAgQXV0aEVycm9yU3RyaW5nc1tcIk5PX01GQVwiXSA9IFwiTm8gdmFsaWQgTUZBIG1ldGhvZCBwcm92aWRlZFwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJJTlZBTElEX01GQVwiXSA9IFwiSW52YWxpZCBNRkEgdHlwZVwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJFTVBUWV9DSEFMTEVOR0VcIl0gPSBcIkNoYWxsZW5nZSByZXNwb25zZSBjYW5ub3QgYmUgZW1wdHlcIjtcbiAgICBBdXRoRXJyb3JTdHJpbmdzW1wiTk9fVVNFUl9TRVNTSU9OXCJdID0gXCJGYWlsZWQgdG8gZ2V0IHRoZSBzZXNzaW9uIGJlY2F1c2UgdGhlIHVzZXIgaXMgZW1wdHlcIjtcbiAgICBBdXRoRXJyb3JTdHJpbmdzW1wiTkVUV09SS19FUlJPUlwiXSA9IFwiTmV0d29yayBFcnJvclwiO1xuICAgIEF1dGhFcnJvclN0cmluZ3NbXCJERVZJQ0VfQ09ORklHXCJdID0gXCJEZXZpY2UgdHJhY2tpbmcgaGFzIG5vdCBiZWVuIGNvbmZpZ3VyZWQgaW4gdGhpcyBVc2VyIFBvb2xcIjtcbiAgICBBdXRoRXJyb3JTdHJpbmdzW1wiQVVUT1NJR05JTl9FUlJPUlwiXSA9IFwiUGxlYXNlIHVzZSB5b3VyIGNyZWRlbnRpYWxzIHRvIHNpZ24gaW5cIjtcbn0pKEF1dGhFcnJvclN0cmluZ3MgfHwgKEF1dGhFcnJvclN0cmluZ3MgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXV0aEVycm9yU3RyaW5ncy5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/types/Auth.js":
/*!**************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/types/Auth.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthErrorTypes: () => (/* binding */ AuthErrorTypes),\n/* harmony export */   CognitoHostedUIIdentityProvider: () => (/* binding */ CognitoHostedUIIdentityProvider),\n/* harmony export */   GRAPHQL_AUTH_MODE: () => (/* binding */ GRAPHQL_AUTH_MODE),\n/* harmony export */   hasCustomState: () => (/* binding */ hasCustomState),\n/* harmony export */   isCognitoHostedOpts: () => (/* binding */ isCognitoHostedOpts),\n/* harmony export */   isFederatedSignInOptions: () => (/* binding */ isFederatedSignInOptions),\n/* harmony export */   isFederatedSignInOptionsCustom: () => (/* binding */ isFederatedSignInOptionsCustom),\n/* harmony export */   isUsernamePasswordOpts: () => (/* binding */ isUsernamePasswordOpts)\n/* harmony export */ });\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar CognitoHostedUIIdentityProvider;\n(function (CognitoHostedUIIdentityProvider) {\n    CognitoHostedUIIdentityProvider[\"Cognito\"] = \"COGNITO\";\n    CognitoHostedUIIdentityProvider[\"Google\"] = \"Google\";\n    CognitoHostedUIIdentityProvider[\"Facebook\"] = \"Facebook\";\n    CognitoHostedUIIdentityProvider[\"Amazon\"] = \"LoginWithAmazon\";\n    CognitoHostedUIIdentityProvider[\"Apple\"] = \"SignInWithApple\";\n})(CognitoHostedUIIdentityProvider || (CognitoHostedUIIdentityProvider = {}));\nfunction isFederatedSignInOptions(obj) {\n    var keys = ['provider'];\n    return obj && !!keys.find(function (k) { return obj.hasOwnProperty(k); });\n}\nfunction isFederatedSignInOptionsCustom(obj) {\n    var keys = ['customProvider'];\n    return obj && !!keys.find(function (k) { return obj.hasOwnProperty(k); });\n}\nfunction hasCustomState(obj) {\n    var keys = ['customState'];\n    return obj && !!keys.find(function (k) { return obj.hasOwnProperty(k); });\n}\nfunction isCognitoHostedOpts(oauth) {\n    return oauth.redirectSignIn !== undefined;\n}\nvar AuthErrorTypes;\n(function (AuthErrorTypes) {\n    AuthErrorTypes[\"NoConfig\"] = \"noConfig\";\n    AuthErrorTypes[\"MissingAuthConfig\"] = \"missingAuthConfig\";\n    AuthErrorTypes[\"EmptyUsername\"] = \"emptyUsername\";\n    AuthErrorTypes[\"InvalidUsername\"] = \"invalidUsername\";\n    AuthErrorTypes[\"EmptyPassword\"] = \"emptyPassword\";\n    AuthErrorTypes[\"EmptyCode\"] = \"emptyCode\";\n    AuthErrorTypes[\"SignUpError\"] = \"signUpError\";\n    AuthErrorTypes[\"NoMFA\"] = \"noMFA\";\n    AuthErrorTypes[\"InvalidMFA\"] = \"invalidMFA\";\n    AuthErrorTypes[\"EmptyChallengeResponse\"] = \"emptyChallengeResponse\";\n    AuthErrorTypes[\"NoUserSession\"] = \"noUserSession\";\n    AuthErrorTypes[\"Default\"] = \"default\";\n    AuthErrorTypes[\"DeviceConfig\"] = \"deviceConfig\";\n    AuthErrorTypes[\"NetworkError\"] = \"networkError\";\n    AuthErrorTypes[\"AutoSignInError\"] = \"autoSignInError\";\n})(AuthErrorTypes || (AuthErrorTypes = {}));\nfunction isUsernamePasswordOpts(obj) {\n    return !!obj.username;\n}\nvar GRAPHQL_AUTH_MODE;\n(function (GRAPHQL_AUTH_MODE) {\n    GRAPHQL_AUTH_MODE[\"API_KEY\"] = \"API_KEY\";\n    GRAPHQL_AUTH_MODE[\"AWS_IAM\"] = \"AWS_IAM\";\n    GRAPHQL_AUTH_MODE[\"OPENID_CONNECT\"] = \"OPENID_CONNECT\";\n    GRAPHQL_AUTH_MODE[\"AMAZON_COGNITO_USER_POOLS\"] = \"AMAZON_COGNITO_USER_POOLS\";\n    GRAPHQL_AUTH_MODE[\"AWS_LAMBDA\"] = \"AWS_LAMBDA\";\n})(GRAPHQL_AUTH_MODE || (GRAPHQL_AUTH_MODE = {}));\n//# sourceMappingURL=Auth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS90eXBlcy9BdXRoLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBFQUEwRTtBQUNwRTtBQUNQO0FBQ0EsNkNBQTZDLCtCQUErQjtBQUM1RTtBQUNPO0FBQ1A7QUFDQSw2Q0FBNkMsK0JBQStCO0FBQzVFO0FBQ087QUFDUDtBQUNBLDZDQUE2QywrQkFBK0I7QUFDNUU7QUFDTztBQUNQO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx3Q0FBd0M7QUFDbEM7QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhDQUE4QztBQUMvQyIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS90eXBlcy9BdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5leHBvcnQgdmFyIENvZ25pdG9Ib3N0ZWRVSUlkZW50aXR5UHJvdmlkZXI7XG4oZnVuY3Rpb24gKENvZ25pdG9Ib3N0ZWRVSUlkZW50aXR5UHJvdmlkZXIpIHtcbiAgICBDb2duaXRvSG9zdGVkVUlJZGVudGl0eVByb3ZpZGVyW1wiQ29nbml0b1wiXSA9IFwiQ09HTklUT1wiO1xuICAgIENvZ25pdG9Ib3N0ZWRVSUlkZW50aXR5UHJvdmlkZXJbXCJHb29nbGVcIl0gPSBcIkdvb2dsZVwiO1xuICAgIENvZ25pdG9Ib3N0ZWRVSUlkZW50aXR5UHJvdmlkZXJbXCJGYWNlYm9va1wiXSA9IFwiRmFjZWJvb2tcIjtcbiAgICBDb2duaXRvSG9zdGVkVUlJZGVudGl0eVByb3ZpZGVyW1wiQW1hem9uXCJdID0gXCJMb2dpbldpdGhBbWF6b25cIjtcbiAgICBDb2duaXRvSG9zdGVkVUlJZGVudGl0eVByb3ZpZGVyW1wiQXBwbGVcIl0gPSBcIlNpZ25JbldpdGhBcHBsZVwiO1xufSkoQ29nbml0b0hvc3RlZFVJSWRlbnRpdHlQcm92aWRlciB8fCAoQ29nbml0b0hvc3RlZFVJSWRlbnRpdHlQcm92aWRlciA9IHt9KSk7XG5leHBvcnQgZnVuY3Rpb24gaXNGZWRlcmF0ZWRTaWduSW5PcHRpb25zKG9iaikge1xuICAgIHZhciBrZXlzID0gWydwcm92aWRlciddO1xuICAgIHJldHVybiBvYmogJiYgISFrZXlzLmZpbmQoZnVuY3Rpb24gKGspIHsgcmV0dXJuIG9iai5oYXNPd25Qcm9wZXJ0eShrKTsgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNGZWRlcmF0ZWRTaWduSW5PcHRpb25zQ3VzdG9tKG9iaikge1xuICAgIHZhciBrZXlzID0gWydjdXN0b21Qcm92aWRlciddO1xuICAgIHJldHVybiBvYmogJiYgISFrZXlzLmZpbmQoZnVuY3Rpb24gKGspIHsgcmV0dXJuIG9iai5oYXNPd25Qcm9wZXJ0eShrKTsgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gaGFzQ3VzdG9tU3RhdGUob2JqKSB7XG4gICAgdmFyIGtleXMgPSBbJ2N1c3RvbVN0YXRlJ107XG4gICAgcmV0dXJuIG9iaiAmJiAhIWtleXMuZmluZChmdW5jdGlvbiAoaykgeyByZXR1cm4gb2JqLmhhc093blByb3BlcnR5KGspOyB9KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc0NvZ25pdG9Ib3N0ZWRPcHRzKG9hdXRoKSB7XG4gICAgcmV0dXJuIG9hdXRoLnJlZGlyZWN0U2lnbkluICE9PSB1bmRlZmluZWQ7XG59XG5leHBvcnQgdmFyIEF1dGhFcnJvclR5cGVzO1xuKGZ1bmN0aW9uIChBdXRoRXJyb3JUeXBlcykge1xuICAgIEF1dGhFcnJvclR5cGVzW1wiTm9Db25maWdcIl0gPSBcIm5vQ29uZmlnXCI7XG4gICAgQXV0aEVycm9yVHlwZXNbXCJNaXNzaW5nQXV0aENvbmZpZ1wiXSA9IFwibWlzc2luZ0F1dGhDb25maWdcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkVtcHR5VXNlcm5hbWVcIl0gPSBcImVtcHR5VXNlcm5hbWVcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkludmFsaWRVc2VybmFtZVwiXSA9IFwiaW52YWxpZFVzZXJuYW1lXCI7XG4gICAgQXV0aEVycm9yVHlwZXNbXCJFbXB0eVBhc3N3b3JkXCJdID0gXCJlbXB0eVBhc3N3b3JkXCI7XG4gICAgQXV0aEVycm9yVHlwZXNbXCJFbXB0eUNvZGVcIl0gPSBcImVtcHR5Q29kZVwiO1xuICAgIEF1dGhFcnJvclR5cGVzW1wiU2lnblVwRXJyb3JcIl0gPSBcInNpZ25VcEVycm9yXCI7XG4gICAgQXV0aEVycm9yVHlwZXNbXCJOb01GQVwiXSA9IFwibm9NRkFcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkludmFsaWRNRkFcIl0gPSBcImludmFsaWRNRkFcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkVtcHR5Q2hhbGxlbmdlUmVzcG9uc2VcIl0gPSBcImVtcHR5Q2hhbGxlbmdlUmVzcG9uc2VcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIk5vVXNlclNlc3Npb25cIl0gPSBcIm5vVXNlclNlc3Npb25cIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkRlZmF1bHRcIl0gPSBcImRlZmF1bHRcIjtcbiAgICBBdXRoRXJyb3JUeXBlc1tcIkRldmljZUNvbmZpZ1wiXSA9IFwiZGV2aWNlQ29uZmlnXCI7XG4gICAgQXV0aEVycm9yVHlwZXNbXCJOZXR3b3JrRXJyb3JcIl0gPSBcIm5ldHdvcmtFcnJvclwiO1xuICAgIEF1dGhFcnJvclR5cGVzW1wiQXV0b1NpZ25JbkVycm9yXCJdID0gXCJhdXRvU2lnbkluRXJyb3JcIjtcbn0pKEF1dGhFcnJvclR5cGVzIHx8IChBdXRoRXJyb3JUeXBlcyA9IHt9KSk7XG5leHBvcnQgZnVuY3Rpb24gaXNVc2VybmFtZVBhc3N3b3JkT3B0cyhvYmopIHtcbiAgICByZXR1cm4gISFvYmoudXNlcm5hbWU7XG59XG5leHBvcnQgdmFyIEdSQVBIUUxfQVVUSF9NT0RFO1xuKGZ1bmN0aW9uIChHUkFQSFFMX0FVVEhfTU9ERSkge1xuICAgIEdSQVBIUUxfQVVUSF9NT0RFW1wiQVBJX0tFWVwiXSA9IFwiQVBJX0tFWVwiO1xuICAgIEdSQVBIUUxfQVVUSF9NT0RFW1wiQVdTX0lBTVwiXSA9IFwiQVdTX0lBTVwiO1xuICAgIEdSQVBIUUxfQVVUSF9NT0RFW1wiT1BFTklEX0NPTk5FQ1RcIl0gPSBcIk9QRU5JRF9DT05ORUNUXCI7XG4gICAgR1JBUEhRTF9BVVRIX01PREVbXCJBTUFaT05fQ09HTklUT19VU0VSX1BPT0xTXCJdID0gXCJBTUFaT05fQ09HTklUT19VU0VSX1BPT0xTXCI7XG4gICAgR1JBUEhRTF9BVVRIX01PREVbXCJBV1NfTEFNQkRBXCJdID0gXCJBV1NfTEFNQkRBXCI7XG59KShHUkFQSFFMX0FVVEhfTU9ERSB8fCAoR1JBUEhRTF9BVVRIX01PREUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXV0aC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/types/Auth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/auth/lib-esm/urlListener.js":
/*!***************************************************************!*\
  !*** ./node_modules/@aws-amplify/auth/lib-esm/urlListener.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-amplify/core */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (callback) {\n    if ((0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__.browserOrNode)().isBrowser && window.location) {\n        var url = window.location.href;\n        callback({ url: url });\n    }\n    else if ((0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__.browserOrNode)().isNode) {\n        // continue building on ssr\n        (function () { }); // noop\n    }\n    else {\n        throw new Error('Not supported');\n    }\n});\n//# sourceMappingURL=urlListener.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2F1dGgvbGliLWVzbS91cmxMaXN0ZW5lci5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNrRDtBQUNsRCxpRUFBZ0I7QUFDaEIsUUFBUSxnRUFBYTtBQUNyQjtBQUNBLG1CQUFtQixVQUFVO0FBQzdCO0FBQ0EsYUFBYSxnRUFBYTtBQUMxQjtBQUNBLHdCQUF3QixHQUFHO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFFO0FBQ0giLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9hdXRoL2xpYi1lc20vdXJsTGlzdGVuZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDE3LTIwMTkgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGhcbiAqIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wL1xuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUlxuICogQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IGJyb3dzZXJPck5vZGUgfSBmcm9tICdAYXdzLWFtcGxpZnkvY29yZSc7XG5leHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgaWYgKGJyb3dzZXJPck5vZGUoKS5pc0Jyb3dzZXIgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgY2FsbGJhY2soeyB1cmw6IHVybCB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYnJvd3Nlck9yTm9kZSgpLmlzTm9kZSkge1xuICAgICAgICAvLyBjb250aW51ZSBidWlsZGluZyBvbiBzc3JcbiAgICAgICAgKGZ1bmN0aW9uICgpIHsgfSk7IC8vIG5vb3BcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IHN1cHBvcnRlZCcpO1xuICAgIH1cbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXJsTGlzdGVuZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/auth/lib-esm/urlListener.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js":
/*!***********************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Amplify.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Amplify: () => (/* binding */ Amplify),\n/* harmony export */   AmplifyClass: () => (/* binding */ AmplifyClass),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Amplify');\nvar AmplifyClass = /** @class */ (function () {\n    function AmplifyClass() {\n        // Everything that is `register`ed is tracked here\n        this._components = [];\n        this._config = {};\n        // All modules (with `getModuleName()`) are stored here for dependency injection\n        this._modules = {};\n        // for backward compatibility to avoid breaking change\n        // if someone is using like Amplify.Auth\n        this.Auth = null;\n        this.Analytics = null;\n        this.API = null;\n        this.Credentials = null;\n        this.Storage = null;\n        this.I18n = null;\n        this.Cache = null;\n        this.PubSub = null;\n        this.Interactions = null;\n        this.Pushnotification = null;\n        this.UI = null;\n        this.XR = null;\n        this.Predictions = null;\n        this.DataStore = null;\n        this.Geo = null;\n        this.Logger = _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger;\n        this.ServiceWorker = null;\n    }\n    AmplifyClass.prototype.register = function (comp) {\n        logger.debug('component registered in amplify', comp);\n        this._components.push(comp);\n        if (typeof comp.getModuleName === 'function') {\n            this._modules[comp.getModuleName()] = comp;\n            this[comp.getModuleName()] = comp;\n        }\n        else {\n            logger.debug('no getModuleName method for component', comp);\n        }\n        // Finally configure this new component(category) loaded\n        // With the new modularization changes in Amplify V3, all the Amplify\n        // component are not loaded/registered right away but when they are\n        // imported (and hence instantiated) in the client's app. This ensures\n        // that all new components imported get correctly configured with the\n        // configuration that Amplify.configure() was called with.\n        comp.configure(this._config);\n    };\n    AmplifyClass.prototype.configure = function (config) {\n        var _this = this;\n        if (!config)\n            return this._config;\n        this._config = Object.assign(this._config, config);\n        logger.debug('amplify config', this._config);\n        // Dependency Injection via property-setting.\n        // This avoids introducing a public method/interface/setter that's difficult to remove later.\n        // Plus, it reduces `if` statements within the `constructor` and `configure` of each module\n        Object.entries(this._modules).forEach(function (_a) {\n            var _b = __read(_a, 2), Name = _b[0], comp = _b[1];\n            // e.g. Auth.*\n            Object.keys(comp).forEach(function (property) {\n                // e.g. Auth[\"Credentials\"] = this._modules[\"Credentials\"] when set\n                if (_this._modules[property]) {\n                    comp[property] = _this._modules[property];\n                }\n            });\n        });\n        this._components.map(function (comp) {\n            comp.configure(_this._config);\n        });\n        return this._config;\n    };\n    AmplifyClass.prototype.addPluggable = function (pluggable) {\n        if (pluggable &&\n            pluggable['getCategory'] &&\n            typeof pluggable['getCategory'] === 'function') {\n            this._components.map(function (comp) {\n                if (comp['addPluggable'] &&\n                    typeof comp['addPluggable'] === 'function') {\n                    comp.addPluggable(pluggable);\n                }\n            });\n        }\n    };\n    return AmplifyClass;\n}());\n\nvar Amplify = new AmplifyClass();\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Amplify);\n//# sourceMappingURL=Amplify.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9BbXBsaWZ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxjQUFjLFNBQUksSUFBSSxTQUFJO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixNQUFNO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUN3RDtBQUN4RCxpQkFBaUIsa0RBQVc7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN1QjtBQUNqQjtBQUNQO0FBQ0E7QUFDQTtBQUNBLGlFQUFlLE9BQU8sRUFBQztBQUN2QiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9BbXBsaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbmltcG9ydCB7IENvbnNvbGVMb2dnZXIgYXMgTG9nZ2VyQ2xhc3MgfSBmcm9tICcuL0xvZ2dlcic7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlckNsYXNzKCdBbXBsaWZ5Jyk7XG52YXIgQW1wbGlmeUNsYXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFtcGxpZnlDbGFzcygpIHtcbiAgICAgICAgLy8gRXZlcnl0aGluZyB0aGF0IGlzIGByZWdpc3RlcmBlZCBpcyB0cmFja2VkIGhlcmVcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cyA9IFtdO1xuICAgICAgICB0aGlzLl9jb25maWcgPSB7fTtcbiAgICAgICAgLy8gQWxsIG1vZHVsZXMgKHdpdGggYGdldE1vZHVsZU5hbWUoKWApIGFyZSBzdG9yZWQgaGVyZSBmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb25cbiAgICAgICAgdGhpcy5fbW9kdWxlcyA9IHt9O1xuICAgICAgICAvLyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSB0byBhdm9pZCBicmVha2luZyBjaGFuZ2VcbiAgICAgICAgLy8gaWYgc29tZW9uZSBpcyB1c2luZyBsaWtlIEFtcGxpZnkuQXV0aFxuICAgICAgICB0aGlzLkF1dGggPSBudWxsO1xuICAgICAgICB0aGlzLkFuYWx5dGljcyA9IG51bGw7XG4gICAgICAgIHRoaXMuQVBJID0gbnVsbDtcbiAgICAgICAgdGhpcy5DcmVkZW50aWFscyA9IG51bGw7XG4gICAgICAgIHRoaXMuU3RvcmFnZSA9IG51bGw7XG4gICAgICAgIHRoaXMuSTE4biA9IG51bGw7XG4gICAgICAgIHRoaXMuQ2FjaGUgPSBudWxsO1xuICAgICAgICB0aGlzLlB1YlN1YiA9IG51bGw7XG4gICAgICAgIHRoaXMuSW50ZXJhY3Rpb25zID0gbnVsbDtcbiAgICAgICAgdGhpcy5QdXNobm90aWZpY2F0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5VSSA9IG51bGw7XG4gICAgICAgIHRoaXMuWFIgPSBudWxsO1xuICAgICAgICB0aGlzLlByZWRpY3Rpb25zID0gbnVsbDtcbiAgICAgICAgdGhpcy5EYXRhU3RvcmUgPSBudWxsO1xuICAgICAgICB0aGlzLkdlbyA9IG51bGw7XG4gICAgICAgIHRoaXMuTG9nZ2VyID0gTG9nZ2VyQ2xhc3M7XG4gICAgICAgIHRoaXMuU2VydmljZVdvcmtlciA9IG51bGw7XG4gICAgfVxuICAgIEFtcGxpZnlDbGFzcy5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY29tcCkge1xuICAgICAgICBsb2dnZXIuZGVidWcoJ2NvbXBvbmVudCByZWdpc3RlcmVkIGluIGFtcGxpZnknLCBjb21wKTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cy5wdXNoKGNvbXApO1xuICAgICAgICBpZiAodHlwZW9mIGNvbXAuZ2V0TW9kdWxlTmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5fbW9kdWxlc1tjb21wLmdldE1vZHVsZU5hbWUoKV0gPSBjb21wO1xuICAgICAgICAgICAgdGhpc1tjb21wLmdldE1vZHVsZU5hbWUoKV0gPSBjb21wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdubyBnZXRNb2R1bGVOYW1lIG1ldGhvZCBmb3IgY29tcG9uZW50JywgY29tcCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmluYWxseSBjb25maWd1cmUgdGhpcyBuZXcgY29tcG9uZW50KGNhdGVnb3J5KSBsb2FkZWRcbiAgICAgICAgLy8gV2l0aCB0aGUgbmV3IG1vZHVsYXJpemF0aW9uIGNoYW5nZXMgaW4gQW1wbGlmeSBWMywgYWxsIHRoZSBBbXBsaWZ5XG4gICAgICAgIC8vIGNvbXBvbmVudCBhcmUgbm90IGxvYWRlZC9yZWdpc3RlcmVkIHJpZ2h0IGF3YXkgYnV0IHdoZW4gdGhleSBhcmVcbiAgICAgICAgLy8gaW1wb3J0ZWQgKGFuZCBoZW5jZSBpbnN0YW50aWF0ZWQpIGluIHRoZSBjbGllbnQncyBhcHAuIFRoaXMgZW5zdXJlc1xuICAgICAgICAvLyB0aGF0IGFsbCBuZXcgY29tcG9uZW50cyBpbXBvcnRlZCBnZXQgY29ycmVjdGx5IGNvbmZpZ3VyZWQgd2l0aCB0aGVcbiAgICAgICAgLy8gY29uZmlndXJhdGlvbiB0aGF0IEFtcGxpZnkuY29uZmlndXJlKCkgd2FzIGNhbGxlZCB3aXRoLlxuICAgICAgICBjb21wLmNvbmZpZ3VyZSh0aGlzLl9jb25maWcpO1xuICAgIH07XG4gICAgQW1wbGlmeUNsYXNzLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghY29uZmlnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICAgICAgdGhpcy5fY29uZmlnID0gT2JqZWN0LmFzc2lnbih0aGlzLl9jb25maWcsIGNvbmZpZyk7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnYW1wbGlmeSBjb25maWcnLCB0aGlzLl9jb25maWcpO1xuICAgICAgICAvLyBEZXBlbmRlbmN5IEluamVjdGlvbiB2aWEgcHJvcGVydHktc2V0dGluZy5cbiAgICAgICAgLy8gVGhpcyBhdm9pZHMgaW50cm9kdWNpbmcgYSBwdWJsaWMgbWV0aG9kL2ludGVyZmFjZS9zZXR0ZXIgdGhhdCdzIGRpZmZpY3VsdCB0byByZW1vdmUgbGF0ZXIuXG4gICAgICAgIC8vIFBsdXMsIGl0IHJlZHVjZXMgYGlmYCBzdGF0ZW1lbnRzIHdpdGhpbiB0aGUgYGNvbnN0cnVjdG9yYCBhbmQgYGNvbmZpZ3VyZWAgb2YgZWFjaCBtb2R1bGVcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5fbW9kdWxlcykuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMiksIE5hbWUgPSBfYlswXSwgY29tcCA9IF9iWzFdO1xuICAgICAgICAgICAgLy8gZS5nLiBBdXRoLipcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGNvbXApLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgLy8gZS5nLiBBdXRoW1wiQ3JlZGVudGlhbHNcIl0gPSB0aGlzLl9tb2R1bGVzW1wiQ3JlZGVudGlhbHNcIl0gd2hlbiBzZXRcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX21vZHVsZXNbcHJvcGVydHldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBbcHJvcGVydHldID0gX3RoaXMuX21vZHVsZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50cy5tYXAoZnVuY3Rpb24gKGNvbXApIHtcbiAgICAgICAgICAgIGNvbXAuY29uZmlndXJlKF90aGlzLl9jb25maWcpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICB9O1xuICAgIEFtcGxpZnlDbGFzcy5wcm90b3R5cGUuYWRkUGx1Z2dhYmxlID0gZnVuY3Rpb24gKHBsdWdnYWJsZSkge1xuICAgICAgICBpZiAocGx1Z2dhYmxlICYmXG4gICAgICAgICAgICBwbHVnZ2FibGVbJ2dldENhdGVnb3J5J10gJiZcbiAgICAgICAgICAgIHR5cGVvZiBwbHVnZ2FibGVbJ2dldENhdGVnb3J5J10gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudHMubWFwKGZ1bmN0aW9uIChjb21wKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBbJ2FkZFBsdWdnYWJsZSddICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBjb21wWydhZGRQbHVnZ2FibGUnXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBjb21wLmFkZFBsdWdnYWJsZShwbHVnZ2FibGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQW1wbGlmeUNsYXNzO1xufSgpKTtcbmV4cG9ydCB7IEFtcGxpZnlDbGFzcyB9O1xuZXhwb3J0IHZhciBBbXBsaWZ5ID0gbmV3IEFtcGxpZnlDbGFzcygpO1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IEFtcGxpZnk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BbXBsaWZ5LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Credentials.js":
/*!***************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Credentials.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Credentials: () => (/* binding */ Credentials),\n/* harmony export */   CredentialsClass: () => (/* binding */ CredentialsClass),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _StorageHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./StorageHelper */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/StorageHelper/index.js\");\n/* harmony import */ var _JS__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./JS */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n/* harmony import */ var _OAuthHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OAuthHelper */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/index.js\");\n/* harmony import */ var _Util__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Util */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js\");\n/* harmony import */ var _Amplify__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Amplify */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Amplify.js\");\n/* harmony import */ var _aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aws-sdk/credential-provider-cognito-identity */ \"(ssr)/./node_modules/@aws-sdk/credential-provider-cognito-identity/dist/es/fromCognitoIdentity.js\");\n/* harmony import */ var _aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @aws-sdk/credential-provider-cognito-identity */ \"(ssr)/./node_modules/@aws-sdk/credential-provider-cognito-identity/dist/es/fromCognitoIdentityPool.js\");\n/* harmony import */ var _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @aws-sdk/client-cognito-identity */ \"(ssr)/./node_modules/@aws-sdk/client-cognito-identity/dist/es/commands/GetIdCommand.js\");\n/* harmony import */ var _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @aws-sdk/client-cognito-identity */ \"(ssr)/./node_modules/@aws-sdk/client-cognito-identity/dist/es/commands/GetCredentialsForIdentityCommand.js\");\n/* harmony import */ var _Util_CognitoIdentityClient__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Util/CognitoIdentityClient */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/CognitoIdentityClient.js\");\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\n\n\n\n\n\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Credentials');\nvar CREDENTIALS_TTL = 50 * 60 * 1000; // 50 min, can be modified on config if required in the future\nvar COGNITO_IDENTITY_KEY_PREFIX = 'CognitoIdentityId-';\nvar CredentialsClass = /** @class */ (function () {\n    function CredentialsClass(config) {\n        this._gettingCredPromise = null;\n        this._refreshHandlers = {};\n        // Allow `Auth` to be injected for SSR, but Auth isn't a required dependency for Credentials\n        this.Auth = undefined;\n        this.configure(config);\n        this._refreshHandlers['google'] = _OAuthHelper__WEBPACK_IMPORTED_MODULE_1__.GoogleOAuth.refreshGoogleToken;\n        this._refreshHandlers['facebook'] = _OAuthHelper__WEBPACK_IMPORTED_MODULE_1__.FacebookOAuth.refreshFacebookToken;\n    }\n    CredentialsClass.prototype.getModuleName = function () {\n        return 'Credentials';\n    };\n    CredentialsClass.prototype.getCredSource = function () {\n        return this._credentials_source;\n    };\n    CredentialsClass.prototype.configure = function (config) {\n        if (!config)\n            return this._config || {};\n        this._config = Object.assign({}, this._config, config);\n        var refreshHandlers = this._config.refreshHandlers;\n        // If the developer has provided an object of refresh handlers,\n        // then we can merge the provided handlers with the current handlers.\n        if (refreshHandlers) {\n            this._refreshHandlers = __assign(__assign({}, this._refreshHandlers), refreshHandlers);\n        }\n        this._storage = this._config.storage;\n        if (!this._storage) {\n            this._storage = new _StorageHelper__WEBPACK_IMPORTED_MODULE_2__.StorageHelper().getStorage();\n        }\n        this._storageSync = Promise.resolve();\n        if (typeof this._storage['sync'] === 'function') {\n            this._storageSync = this._storage['sync']();\n        }\n        return this._config;\n    };\n    CredentialsClass.prototype.get = function () {\n        logger.debug('getting credentials');\n        return this._pickupCredentials();\n    };\n    // currently we only store the guest identity in local storage\n    CredentialsClass.prototype._getCognitoIdentityIdStorageKey = function (identityPoolId) {\n        return \"\" + COGNITO_IDENTITY_KEY_PREFIX + identityPoolId;\n    };\n    CredentialsClass.prototype._pickupCredentials = function () {\n        logger.debug('picking up credentials');\n        if (!this._gettingCredPromise || !this._gettingCredPromise.isPending()) {\n            logger.debug('getting new cred promise');\n            this._gettingCredPromise = (0,_JS__WEBPACK_IMPORTED_MODULE_3__.makeQuerablePromise)(this._keepAlive());\n        }\n        else {\n            logger.debug('getting old cred promise');\n        }\n        return this._gettingCredPromise;\n    };\n    CredentialsClass.prototype._keepAlive = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var cred, _a, Auth, user_1, session, refreshToken_1, refreshRequest, err_1;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        logger.debug('checking if credentials exists and not expired');\n                        cred = this._credentials;\n                        if (cred && !this._isExpired(cred) && !this._isPastTTL()) {\n                            logger.debug('credentials not changed and not expired, directly return');\n                            return [2 /*return*/, Promise.resolve(cred)];\n                        }\n                        logger.debug('need to get a new credential or refresh the existing one');\n                        _a = this.Auth, Auth = _a === void 0 ? _Amplify__WEBPACK_IMPORTED_MODULE_4__.Amplify.Auth : _a;\n                        if (!Auth || typeof Auth.currentUserCredentials !== 'function') {\n                            return [2 /*return*/, Promise.reject('No Auth module registered in Amplify')];\n                        }\n                        if (!(!this._isExpired(cred) && this._isPastTTL())) return [3 /*break*/, 6];\n                        logger.debug('ttl has passed but token is not yet expired');\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 5, , 6]);\n                        return [4 /*yield*/, Auth.currentUserPoolUser()];\n                    case 2:\n                        user_1 = _b.sent();\n                        return [4 /*yield*/, Auth.currentSession()];\n                    case 3:\n                        session = _b.sent();\n                        refreshToken_1 = session.refreshToken;\n                        refreshRequest = new Promise(function (res, rej) {\n                            user_1.refreshSession(refreshToken_1, function (err, data) {\n                                return err ? rej(err) : res(data);\n                            });\n                        });\n                        return [4 /*yield*/, refreshRequest];\n                    case 4:\n                        _b.sent(); // note that rejections will be caught and handled in the catch block.\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _b.sent();\n                        // should not throw because user might just be on guest access or is authenticated through federation\n                        logger.debug('Error attempting to refreshing the session', err_1);\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/, Auth.currentUserCredentials()];\n                }\n            });\n        });\n    };\n    CredentialsClass.prototype.refreshFederatedToken = function (federatedInfo) {\n        logger.debug('Getting federated credentials');\n        var provider = federatedInfo.provider, user = federatedInfo.user, token = federatedInfo.token, identity_id = federatedInfo.identity_id;\n        var expires_at = federatedInfo.expires_at;\n        // Make sure expires_at is in millis\n        expires_at =\n            new Date(expires_at).getFullYear() === 1970\n                ? expires_at * 1000\n                : expires_at;\n        var that = this;\n        logger.debug('checking if federated jwt token expired');\n        if (expires_at > new Date().getTime()) {\n            // if not expired\n            logger.debug('token not expired');\n            return this._setCredentialsFromFederation({\n                provider: provider,\n                token: token,\n                user: user,\n                identity_id: identity_id,\n                expires_at: expires_at,\n            });\n        }\n        else {\n            // if refresh handler exists\n            if (that._refreshHandlers[provider] &&\n                typeof that._refreshHandlers[provider] === 'function') {\n                logger.debug('getting refreshed jwt token from federation provider');\n                return this._providerRefreshWithRetry({\n                    refreshHandler: that._refreshHandlers[provider],\n                    provider: provider,\n                    user: user,\n                });\n            }\n            else {\n                logger.debug('no refresh handler for provider:', provider);\n                this.clear();\n                return Promise.reject('no refresh handler for provider');\n            }\n        }\n    };\n    CredentialsClass.prototype._providerRefreshWithRetry = function (_a) {\n        var _this = this;\n        var refreshHandler = _a.refreshHandler, provider = _a.provider, user = _a.user;\n        var MAX_DELAY_MS = 10 * 1000;\n        // refreshHandler will retry network errors, otherwise it will\n        // return NonRetryableError to break out of jitteredExponentialRetry\n        return (0,_Util__WEBPACK_IMPORTED_MODULE_5__.jitteredExponentialRetry)(refreshHandler, [], MAX_DELAY_MS)\n            .then(function (data) {\n            logger.debug('refresh federated token sucessfully', data);\n            return _this._setCredentialsFromFederation({\n                provider: provider,\n                token: data.token,\n                user: user,\n                identity_id: data.identity_id,\n                expires_at: data.expires_at,\n            });\n        })\n            .catch(function (e) {\n            var isNetworkError = typeof e === 'string' &&\n                e.toLowerCase().lastIndexOf('network error', e.length) === 0;\n            if (!isNetworkError) {\n                _this.clear();\n            }\n            logger.debug('refresh federated token failed', e);\n            return Promise.reject('refreshing federation token failed: ' + e);\n        });\n    };\n    CredentialsClass.prototype._isExpired = function (credentials) {\n        if (!credentials) {\n            logger.debug('no credentials for expiration check');\n            return true;\n        }\n        logger.debug('are these credentials expired?', credentials);\n        var ts = Date.now();\n        /* returns date object.\n            https://github.com/aws/aws-sdk-js-v3/blob/v1.0.0-beta.1/packages/types/src/credentials.ts#L26\n        */\n        var expiration = credentials.expiration;\n        return expiration.getTime() <= ts;\n    };\n    CredentialsClass.prototype._isPastTTL = function () {\n        return this._nextCredentialsRefresh <= Date.now();\n    };\n    CredentialsClass.prototype._setCredentialsForGuest = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, identityPoolId, region, mandatorySignIn, identityId, _b, cognitoClient, credentials, cognitoIdentityParams, credentialsProvider;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        logger.debug('setting credentials for guest');\n                        _a = this._config, identityPoolId = _a.identityPoolId, region = _a.region, mandatorySignIn = _a.mandatorySignIn;\n                        if (mandatorySignIn) {\n                            return [2 /*return*/, Promise.reject('cannot get guest credentials when mandatory signin enabled')];\n                        }\n                        if (!identityPoolId) {\n                            logger.debug('No Cognito Identity pool provided for unauthenticated access');\n                            return [2 /*return*/, Promise.reject('No Cognito Identity pool provided for unauthenticated access')];\n                        }\n                        if (!region) {\n                            logger.debug('region is not configured for getting the credentials');\n                            return [2 /*return*/, Promise.reject('region is not configured for getting the credentials')];\n                        }\n                        _b = this;\n                        return [4 /*yield*/, this._getGuestIdentityId()];\n                    case 1:\n                        identityId = (_b._identityId = _c.sent());\n                        cognitoClient = (0,_Util_CognitoIdentityClient__WEBPACK_IMPORTED_MODULE_6__.createCognitoIdentityClient)({\n                            region: region,\n                        });\n                        credentials = undefined;\n                        if (identityId) {\n                            cognitoIdentityParams = {\n                                identityId: identityId,\n                                client: cognitoClient,\n                            };\n                            credentials = (0,_aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_7__.fromCognitoIdentity)(cognitoIdentityParams)();\n                        }\n                        else {\n                            credentialsProvider = function () { return __awaiter(_this, void 0, void 0, function () {\n                                var IdentityId, cognitoIdentityParams, credentialsFromCognitoIdentity;\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, cognitoClient.send(new _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_8__.GetIdCommand({\n                                                IdentityPoolId: identityPoolId,\n                                            }))];\n                                        case 1:\n                                            IdentityId = (_a.sent()).IdentityId;\n                                            this._identityId = IdentityId;\n                                            cognitoIdentityParams = {\n                                                client: cognitoClient,\n                                                identityId: IdentityId,\n                                            };\n                                            credentialsFromCognitoIdentity = (0,_aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_7__.fromCognitoIdentity)(cognitoIdentityParams);\n                                            return [2 /*return*/, credentialsFromCognitoIdentity()];\n                                    }\n                                });\n                            }); };\n                            credentials = credentialsProvider().catch(function (err) { return __awaiter(_this, void 0, void 0, function () {\n                                return __generator(this, function (_a) {\n                                    throw err;\n                                });\n                            }); });\n                        }\n                        return [2 /*return*/, this._loadCredentials(credentials, 'guest', false, null)\n                                .then(function (res) {\n                                return res;\n                            })\n                                .catch(function (e) { return __awaiter(_this, void 0, void 0, function () {\n                                var credentialsProvider;\n                                var _this = this;\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0:\n                                            if (!(e.name === 'ResourceNotFoundException' &&\n                                                e.message === \"Identity '\" + identityId + \"' not found.\")) return [3 /*break*/, 2];\n                                            logger.debug('Failed to load guest credentials');\n                                            return [4 /*yield*/, this._removeGuestIdentityId()];\n                                        case 1:\n                                            _a.sent();\n                                            credentialsProvider = function () { return __awaiter(_this, void 0, void 0, function () {\n                                                var IdentityId, cognitoIdentityParams, credentialsFromCognitoIdentity;\n                                                return __generator(this, function (_a) {\n                                                    switch (_a.label) {\n                                                        case 0: return [4 /*yield*/, cognitoClient.send(new _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_8__.GetIdCommand({\n                                                                IdentityPoolId: identityPoolId,\n                                                            }))];\n                                                        case 1:\n                                                            IdentityId = (_a.sent()).IdentityId;\n                                                            this._identityId = IdentityId;\n                                                            cognitoIdentityParams = {\n                                                                client: cognitoClient,\n                                                                identityId: IdentityId,\n                                                            };\n                                                            credentialsFromCognitoIdentity = (0,_aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_7__.fromCognitoIdentity)(cognitoIdentityParams);\n                                                            return [2 /*return*/, credentialsFromCognitoIdentity()];\n                                                    }\n                                                });\n                                            }); };\n                                            credentials = credentialsProvider().catch(function (err) { return __awaiter(_this, void 0, void 0, function () {\n                                                return __generator(this, function (_a) {\n                                                    throw err;\n                                                });\n                                            }); });\n                                            return [2 /*return*/, this._loadCredentials(credentials, 'guest', false, null)];\n                                        case 2: return [2 /*return*/, e];\n                                    }\n                                });\n                            }); })];\n                }\n            });\n        });\n    };\n    CredentialsClass.prototype._setCredentialsFromFederation = function (params) {\n        var provider = params.provider, token = params.token, identity_id = params.identity_id;\n        var domains = {\n            google: 'accounts.google.com',\n            facebook: 'graph.facebook.com',\n            amazon: 'www.amazon.com',\n            developer: 'cognito-identity.amazonaws.com',\n        };\n        // Use custom provider url instead of the predefined ones\n        var domain = domains[provider] || provider;\n        if (!domain) {\n            return Promise.reject('You must specify a federated provider');\n        }\n        var logins = {};\n        logins[domain] = token;\n        var _a = this._config, identityPoolId = _a.identityPoolId, region = _a.region;\n        if (!identityPoolId) {\n            logger.debug('No Cognito Federated Identity pool provided');\n            return Promise.reject('No Cognito Federated Identity pool provided');\n        }\n        if (!region) {\n            logger.debug('region is not configured for getting the credentials');\n            return Promise.reject('region is not configured for getting the credentials');\n        }\n        var cognitoClient = (0,_Util_CognitoIdentityClient__WEBPACK_IMPORTED_MODULE_6__.createCognitoIdentityClient)({\n            region: region,\n        });\n        var credentials = undefined;\n        if (identity_id) {\n            var cognitoIdentityParams = {\n                identityId: identity_id,\n                logins: logins,\n                client: cognitoClient,\n            };\n            credentials = (0,_aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_7__.fromCognitoIdentity)(cognitoIdentityParams)();\n        }\n        else {\n            var cognitoIdentityParams = {\n                logins: logins,\n                identityPoolId: identityPoolId,\n                client: cognitoClient,\n            };\n            credentials = (0,_aws_sdk_credential_provider_cognito_identity__WEBPACK_IMPORTED_MODULE_9__.fromCognitoIdentityPool)(cognitoIdentityParams)();\n        }\n        return this._loadCredentials(credentials, 'federated', true, params);\n    };\n    CredentialsClass.prototype._setCredentialsFromSession = function (session) {\n        var _this = this;\n        logger.debug('set credentials from session');\n        var idToken = session.getIdToken().getJwtToken();\n        var _a = this._config, region = _a.region, userPoolId = _a.userPoolId, identityPoolId = _a.identityPoolId;\n        if (!identityPoolId) {\n            logger.debug('No Cognito Federated Identity pool provided');\n            return Promise.reject('No Cognito Federated Identity pool provided');\n        }\n        if (!region) {\n            logger.debug('region is not configured for getting the credentials');\n            return Promise.reject('region is not configured for getting the credentials');\n        }\n        var key = 'cognito-idp.' + region + '.amazonaws.com/' + userPoolId;\n        var logins = {};\n        logins[key] = idToken;\n        var cognitoClient = (0,_Util_CognitoIdentityClient__WEBPACK_IMPORTED_MODULE_6__.createCognitoIdentityClient)({\n            region: region,\n        });\n        /*\n            Retreiving identityId with GetIdCommand to mimic the behavior in the following code in aws-sdk-v3:\n            https://git.io/JeDxU\n\n            Note: Retreive identityId from CredentialsProvider once aws-sdk-js v3 supports this.\n        */\n        var credentialsProvider = function () { return __awaiter(_this, void 0, void 0, function () {\n            var guestIdentityId, generatedOrRetrievedIdentityId, IdentityId, _a, _b, AccessKeyId, Expiration, SecretKey, SessionToken, primaryIdentityId;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, this._getGuestIdentityId()];\n                    case 1:\n                        guestIdentityId = _c.sent();\n                        if (!!guestIdentityId) return [3 /*break*/, 3];\n                        return [4 /*yield*/, cognitoClient.send(new _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_8__.GetIdCommand({\n                                IdentityPoolId: identityPoolId,\n                                Logins: logins,\n                            }))];\n                    case 2:\n                        IdentityId = (_c.sent()).IdentityId;\n                        generatedOrRetrievedIdentityId = IdentityId;\n                        _c.label = 3;\n                    case 3: return [4 /*yield*/, cognitoClient.send(new _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_10__.GetCredentialsForIdentityCommand({\n                            IdentityId: guestIdentityId || generatedOrRetrievedIdentityId,\n                            Logins: logins,\n                        }))];\n                    case 4:\n                        _a = _c.sent(), _b = _a.Credentials, AccessKeyId = _b.AccessKeyId, Expiration = _b.Expiration, SecretKey = _b.SecretKey, SessionToken = _b.SessionToken, primaryIdentityId = _a.IdentityId;\n                        this._identityId = primaryIdentityId;\n                        if (!guestIdentityId) return [3 /*break*/, 6];\n                        // if guestIdentity is found and used by GetCredentialsForIdentity\n                        // it will be linked to the logins provided, and disqualified as an unauth identity\n                        logger.debug(\"The guest identity \" + guestIdentityId + \" has been successfully linked to the logins\");\n                        if (guestIdentityId === primaryIdentityId) {\n                            logger.debug(\"The guest identity \" + guestIdentityId + \" has become the primary identity\");\n                        }\n                        // remove it from local storage to avoid being used as a guest Identity by _setCredentialsForGuest\n                        return [4 /*yield*/, this._removeGuestIdentityId()];\n                    case 5:\n                        // remove it from local storage to avoid being used as a guest Identity by _setCredentialsForGuest\n                        _c.sent();\n                        _c.label = 6;\n                    case 6: \n                    // https://github.com/aws/aws-sdk-js-v3/blob/main/packages/credential-provider-cognito-identity/src/fromCognitoIdentity.ts#L40\n                    return [2 /*return*/, {\n                            accessKeyId: AccessKeyId,\n                            secretAccessKey: SecretKey,\n                            sessionToken: SessionToken,\n                            expiration: Expiration,\n                            identityId: primaryIdentityId,\n                        }];\n                }\n            });\n        }); };\n        var credentials = credentialsProvider().catch(function (err) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw err;\n            });\n        }); });\n        return this._loadCredentials(credentials, 'userPool', true, null);\n    };\n    CredentialsClass.prototype._loadCredentials = function (credentials, source, authenticated, info) {\n        var _this = this;\n        var that = this;\n        return new Promise(function (res, rej) {\n            credentials\n                .then(function (credentials) { return __awaiter(_this, void 0, void 0, function () {\n                var user, provider, token, expires_at, identity_id;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            logger.debug('Load credentials successfully', credentials);\n                            if (this._identityId && !credentials.identityId) {\n                                credentials['identityId'] = this._identityId;\n                            }\n                            that._credentials = credentials;\n                            that._credentials.authenticated = authenticated;\n                            that._credentials_source = source;\n                            that._nextCredentialsRefresh = new Date().getTime() + CREDENTIALS_TTL;\n                            if (source === 'federated') {\n                                user = Object.assign({ id: this._credentials.identityId }, info.user);\n                                provider = info.provider, token = info.token, expires_at = info.expires_at, identity_id = info.identity_id;\n                                try {\n                                    this._storage.setItem('aws-amplify-federatedInfo', JSON.stringify({\n                                        provider: provider,\n                                        token: token,\n                                        user: user,\n                                        expires_at: expires_at,\n                                        identity_id: identity_id,\n                                    }));\n                                }\n                                catch (e) {\n                                    logger.debug('Failed to put federated info into auth storage', e);\n                                }\n                            }\n                            if (!(source === 'guest')) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this._setGuestIdentityId(credentials.identityId)];\n                        case 1:\n                            _a.sent();\n                            _a.label = 2;\n                        case 2:\n                            res(that._credentials);\n                            return [2 /*return*/];\n                    }\n                });\n            }); })\n                .catch(function (err) {\n                if (err) {\n                    logger.debug('Failed to load credentials', credentials);\n                    logger.debug('Error loading credentials', err);\n                    rej(err);\n                    return;\n                }\n            });\n        });\n    };\n    CredentialsClass.prototype.set = function (params, source) {\n        if (source === 'session') {\n            return this._setCredentialsFromSession(params);\n        }\n        else if (source === 'federation') {\n            return this._setCredentialsFromFederation(params);\n        }\n        else if (source === 'guest') {\n            return this._setCredentialsForGuest();\n        }\n        else {\n            logger.debug('no source specified for setting credentials');\n            return Promise.reject('invalid source');\n        }\n    };\n    CredentialsClass.prototype.clear = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this._credentials = null;\n                this._credentials_source = null;\n                logger.debug('removing aws-amplify-federatedInfo from storage');\n                this._storage.removeItem('aws-amplify-federatedInfo');\n                return [2 /*return*/];\n            });\n        });\n    };\n    /* operations on local stored guest identity */\n    CredentialsClass.prototype._getGuestIdentityId = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var identityPoolId, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        identityPoolId = this._config.identityPoolId;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/, this._storage.getItem(this._getCognitoIdentityIdStorageKey(identityPoolId))];\n                    case 3:\n                        e_1 = _a.sent();\n                        logger.debug('Failed to get the cached guest identityId', e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CredentialsClass.prototype._setGuestIdentityId = function (identityId) {\n        return __awaiter(this, void 0, void 0, function () {\n            var identityPoolId, e_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        identityPoolId = this._config.identityPoolId;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this._storageSync];\n                    case 2:\n                        _a.sent();\n                        this._storage.setItem(this._getCognitoIdentityIdStorageKey(identityPoolId), identityId);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_2 = _a.sent();\n                        logger.debug('Failed to cache guest identityId', e_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CredentialsClass.prototype._removeGuestIdentityId = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var identityPoolId;\n            return __generator(this, function (_a) {\n                identityPoolId = this._config.identityPoolId;\n                logger.debug(\"removing \" + this._getCognitoIdentityIdStorageKey(identityPoolId) + \" from storage\");\n                this._storage.removeItem(this._getCognitoIdentityIdStorageKey(identityPoolId));\n                return [2 /*return*/];\n            });\n        });\n    };\n    /**\n     * Compact version of credentials\n     * @param {Object} credentials\n     * @return {Object} - Credentials\n     */\n    CredentialsClass.prototype.shear = function (credentials) {\n        return {\n            accessKeyId: credentials.accessKeyId,\n            sessionToken: credentials.sessionToken,\n            secretAccessKey: credentials.secretAccessKey,\n            identityId: credentials.identityId,\n            authenticated: credentials.authenticated,\n        };\n    };\n    return CredentialsClass;\n}());\n\nvar Credentials = new CredentialsClass(null);\n_Amplify__WEBPACK_IMPORTED_MODULE_4__.Amplify.register(Credentials);\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Credentials);\n//# sourceMappingURL=Credentials.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9DcmVkZW50aWFscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1QjtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBSSxJQUFJLFNBQUk7QUFDN0IsNEJBQTRCLCtEQUErRCxpQkFBaUI7QUFDNUc7QUFDQSxvQ0FBb0MsTUFBTSwrQkFBK0IsWUFBWTtBQUNyRixtQ0FBbUMsTUFBTSxtQ0FBbUMsWUFBWTtBQUN4RixnQ0FBZ0M7QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQSxtQkFBbUIsU0FBSSxJQUFJLFNBQUk7QUFDL0IsY0FBYyw2QkFBNkIsMEJBQTBCLGNBQWMscUJBQXFCO0FBQ3hHLGlCQUFpQixvREFBb0QscUVBQXFFLGNBQWM7QUFDeEosdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEMsbUNBQW1DLFNBQVM7QUFDNUMsbUNBQW1DLFdBQVcsVUFBVTtBQUN4RCwwQ0FBMEMsY0FBYztBQUN4RDtBQUNBLDhHQUE4RyxPQUFPO0FBQ3JILGlGQUFpRixpQkFBaUI7QUFDbEcseURBQXlELGdCQUFnQixRQUFRO0FBQ2pGLCtDQUErQyxnQkFBZ0IsZ0JBQWdCO0FBQy9FO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQSxVQUFVLFlBQVksYUFBYSxTQUFTLFVBQVU7QUFDdEQsb0NBQW9DLFNBQVM7QUFDN0M7QUFDQTtBQUNtRDtBQUNIO0FBQ0w7QUFDZ0I7QUFDVDtBQUNkO0FBQzBFO0FBQ1g7QUFDeEI7QUFDM0UsaUJBQWlCLGtEQUFNO0FBQ3ZCLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHFEQUFXO0FBQ3JELDRDQUE0Qyx1REFBYTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RDtBQUN4RDtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MseURBQWE7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsd0RBQW1CO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELDZDQUFPO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qix5QkFBeUI7QUFDekI7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsK0RBQXdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3Qyx3RkFBMkI7QUFDbkU7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLGtHQUFtQjtBQUM3RDtBQUNBO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLDRGQUE0RiwwRUFBWTtBQUN4RztBQUNBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxrR0FBbUI7QUFDaEc7QUFDQTtBQUNBLGlDQUFpQztBQUNqQyw2QkFBNkI7QUFDN0IsdUZBQXVGO0FBQ3ZGO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsNkJBQTZCLElBQUk7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0Isc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0Y7QUFDaEY7QUFDQTtBQUNBO0FBQ0EsNEdBQTRHLDBFQUFZO0FBQ3hIO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkZBQTZGLGtHQUFtQjtBQUNoSDtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pELDZDQUE2QztBQUM3Qyx1R0FBdUc7QUFDdkc7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRCw2Q0FBNkMsSUFBSTtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsNkJBQTZCLElBQUk7QUFDakM7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdGQUEyQjtBQUN2RDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixrR0FBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0dBQXVCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHdGQUEyQjtBQUN2RDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSwwRUFBWTtBQUNoRjtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLCtGQUFnQztBQUN4RztBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsdUVBQXVFO0FBQ3ZFO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUyxJQUFJO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsa0NBQWtDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhLElBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUMyQjtBQUNyQjtBQUNQLDZDQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsV0FBVyxFQUFDO0FBQzNCIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL0NyZWRlbnRpYWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odCkge1xuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpXG4gICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xuaW1wb3J0IHsgQ29uc29sZUxvZ2dlciBhcyBMb2dnZXIgfSBmcm9tICcuL0xvZ2dlcic7XG5pbXBvcnQgeyBTdG9yYWdlSGVscGVyIH0gZnJvbSAnLi9TdG9yYWdlSGVscGVyJztcbmltcG9ydCB7IG1ha2VRdWVyYWJsZVByb21pc2UgfSBmcm9tICcuL0pTJztcbmltcG9ydCB7IEZhY2Vib29rT0F1dGgsIEdvb2dsZU9BdXRoIH0gZnJvbSAnLi9PQXV0aEhlbHBlcic7XG5pbXBvcnQgeyBqaXR0ZXJlZEV4cG9uZW50aWFsUmV0cnkgfSBmcm9tICcuL1V0aWwnO1xuaW1wb3J0IHsgQW1wbGlmeSB9IGZyb20gJy4vQW1wbGlmeSc7XG5pbXBvcnQgeyBmcm9tQ29nbml0b0lkZW50aXR5LCBmcm9tQ29nbml0b0lkZW50aXR5UG9vbCwgfSBmcm9tICdAYXdzLXNkay9jcmVkZW50aWFsLXByb3ZpZGVyLWNvZ25pdG8taWRlbnRpdHknO1xuaW1wb3J0IHsgR2V0SWRDb21tYW5kLCBHZXRDcmVkZW50aWFsc0ZvcklkZW50aXR5Q29tbWFuZCwgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtY29nbml0by1pZGVudGl0eSc7XG5pbXBvcnQgeyBjcmVhdGVDb2duaXRvSWRlbnRpdHlDbGllbnQgfSBmcm9tICcuL1V0aWwvQ29nbml0b0lkZW50aXR5Q2xpZW50JztcbnZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdDcmVkZW50aWFscycpO1xudmFyIENSRURFTlRJQUxTX1RUTCA9IDUwICogNjAgKiAxMDAwOyAvLyA1MCBtaW4sIGNhbiBiZSBtb2RpZmllZCBvbiBjb25maWcgaWYgcmVxdWlyZWQgaW4gdGhlIGZ1dHVyZVxudmFyIENPR05JVE9fSURFTlRJVFlfS0VZX1BSRUZJWCA9ICdDb2duaXRvSWRlbnRpdHlJZC0nO1xudmFyIENyZWRlbnRpYWxzQ2xhc3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3JlZGVudGlhbHNDbGFzcyhjb25maWcpIHtcbiAgICAgICAgdGhpcy5fZ2V0dGluZ0NyZWRQcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVmcmVzaEhhbmRsZXJzID0ge307XG4gICAgICAgIC8vIEFsbG93IGBBdXRoYCB0byBiZSBpbmplY3RlZCBmb3IgU1NSLCBidXQgQXV0aCBpc24ndCBhIHJlcXVpcmVkIGRlcGVuZGVuY3kgZm9yIENyZWRlbnRpYWxzXG4gICAgICAgIHRoaXMuQXV0aCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoY29uZmlnKTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaEhhbmRsZXJzWydnb29nbGUnXSA9IEdvb2dsZU9BdXRoLnJlZnJlc2hHb29nbGVUb2tlbjtcbiAgICAgICAgdGhpcy5fcmVmcmVzaEhhbmRsZXJzWydmYWNlYm9vayddID0gRmFjZWJvb2tPQXV0aC5yZWZyZXNoRmFjZWJvb2tUb2tlbjtcbiAgICB9XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuZ2V0TW9kdWxlTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdDcmVkZW50aWFscyc7XG4gICAgfTtcbiAgICBDcmVkZW50aWFsc0NsYXNzLnByb3RvdHlwZS5nZXRDcmVkU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlZGVudGlhbHNfc291cmNlO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuY29uZmlndXJlID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICBpZiAoIWNvbmZpZylcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb25maWcgfHwge307XG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuX2NvbmZpZywgY29uZmlnKTtcbiAgICAgICAgdmFyIHJlZnJlc2hIYW5kbGVycyA9IHRoaXMuX2NvbmZpZy5yZWZyZXNoSGFuZGxlcnM7XG4gICAgICAgIC8vIElmIHRoZSBkZXZlbG9wZXIgaGFzIHByb3ZpZGVkIGFuIG9iamVjdCBvZiByZWZyZXNoIGhhbmRsZXJzLFxuICAgICAgICAvLyB0aGVuIHdlIGNhbiBtZXJnZSB0aGUgcHJvdmlkZWQgaGFuZGxlcnMgd2l0aCB0aGUgY3VycmVudCBoYW5kbGVycy5cbiAgICAgICAgaWYgKHJlZnJlc2hIYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy5fcmVmcmVzaEhhbmRsZXJzID0gX19hc3NpZ24oX19hc3NpZ24oe30sIHRoaXMuX3JlZnJlc2hIYW5kbGVycyksIHJlZnJlc2hIYW5kbGVycyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3RvcmFnZSA9IHRoaXMuX2NvbmZpZy5zdG9yYWdlO1xuICAgICAgICBpZiAoIXRoaXMuX3N0b3JhZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0b3JhZ2UgPSBuZXcgU3RvcmFnZUhlbHBlcigpLmdldFN0b3JhZ2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zdG9yYWdlU3luYyA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuX3N0b3JhZ2VbJ3N5bmMnXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5fc3RvcmFnZVN5bmMgPSB0aGlzLl9zdG9yYWdlWydzeW5jJ10oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBsb2dnZXIuZGVidWcoJ2dldHRpbmcgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BpY2t1cENyZWRlbnRpYWxzKCk7XG4gICAgfTtcbiAgICAvLyBjdXJyZW50bHkgd2Ugb25seSBzdG9yZSB0aGUgZ3Vlc3QgaWRlbnRpdHkgaW4gbG9jYWwgc3RvcmFnZVxuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9nZXRDb2duaXRvSWRlbnRpdHlJZFN0b3JhZ2VLZXkgPSBmdW5jdGlvbiAoaWRlbnRpdHlQb29sSWQpIHtcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBDT0dOSVRPX0lERU5USVRZX0tFWV9QUkVGSVggKyBpZGVudGl0eVBvb2xJZDtcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9waWNrdXBDcmVkZW50aWFscyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdwaWNraW5nIHVwIGNyZWRlbnRpYWxzJyk7XG4gICAgICAgIGlmICghdGhpcy5fZ2V0dGluZ0NyZWRQcm9taXNlIHx8ICF0aGlzLl9nZXR0aW5nQ3JlZFByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZ2V0dGluZyBuZXcgY3JlZCBwcm9taXNlJyk7XG4gICAgICAgICAgICB0aGlzLl9nZXR0aW5nQ3JlZFByb21pc2UgPSBtYWtlUXVlcmFibGVQcm9taXNlKHRoaXMuX2tlZXBBbGl2ZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZ2V0dGluZyBvbGQgY3JlZCBwcm9taXNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldHRpbmdDcmVkUHJvbWlzZTtcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9rZWVwQWxpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjcmVkLCBfYSwgQXV0aCwgdXNlcl8xLCBzZXNzaW9uLCByZWZyZXNoVG9rZW5fMSwgcmVmcmVzaFJlcXVlc3QsIGVycl8xO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdjaGVja2luZyBpZiBjcmVkZW50aWFscyBleGlzdHMgYW5kIG5vdCBleHBpcmVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVkID0gdGhpcy5fY3JlZGVudGlhbHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3JlZCAmJiAhdGhpcy5faXNFeHBpcmVkKGNyZWQpICYmICF0aGlzLl9pc1Bhc3RUVEwoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY3JlZGVudGlhbHMgbm90IGNoYW5nZWQgYW5kIG5vdCBleHBpcmVkLCBkaXJlY3RseSByZXR1cm4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZXNvbHZlKGNyZWQpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnbmVlZCB0byBnZXQgYSBuZXcgY3JlZGVudGlhbCBvciByZWZyZXNoIHRoZSBleGlzdGluZyBvbmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy5BdXRoLCBBdXRoID0gX2EgPT09IHZvaWQgMCA/IEFtcGxpZnkuQXV0aCA6IF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLmN1cnJlbnRVc2VyQ3JlZGVudGlhbHMgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZWplY3QoJ05vIEF1dGggbW9kdWxlIHJlZ2lzdGVyZWQgaW4gQW1wbGlmeScpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCF0aGlzLl9pc0V4cGlyZWQoY3JlZCkgJiYgdGhpcy5faXNQYXN0VFRMKCkpKSByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygndHRsIGhhcyBwYXNzZWQgYnV0IHRva2VuIGlzIG5vdCB5ZXQgZXhwaXJlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50cnlzLnB1c2goWzEsIDUsICwgNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aC5jdXJyZW50VXNlclBvb2xVc2VyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyXzEgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmN1cnJlbnRTZXNzaW9uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuXzEgPSBzZXNzaW9uLnJlZnJlc2hUb2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hSZXF1ZXN0ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl8xLnJlZnJlc2hTZXNzaW9uKHJlZnJlc2hUb2tlbl8xLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnIgPyByZWooZXJyKSA6IHJlcyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVmcmVzaFJlcXVlc3RdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7IC8vIG5vdGUgdGhhdCByZWplY3Rpb25zIHdpbGwgYmUgY2F1Z2h0IGFuZCBoYW5kbGVkIGluIHRoZSBjYXRjaCBibG9jay5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3VsZCBub3QgdGhyb3cgYmVjYXVzZSB1c2VyIG1pZ2h0IGp1c3QgYmUgb24gZ3Vlc3QgYWNjZXNzIG9yIGlzIGF1dGhlbnRpY2F0ZWQgdGhyb3VnaCBmZWRlcmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0Vycm9yIGF0dGVtcHRpbmcgdG8gcmVmcmVzaGluZyB0aGUgc2Vzc2lvbicsIGVycl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovLCBBdXRoLmN1cnJlbnRVc2VyQ3JlZGVudGlhbHMoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUucmVmcmVzaEZlZGVyYXRlZFRva2VuID0gZnVuY3Rpb24gKGZlZGVyYXRlZEluZm8pIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdHZXR0aW5nIGZlZGVyYXRlZCBjcmVkZW50aWFscycpO1xuICAgICAgICB2YXIgcHJvdmlkZXIgPSBmZWRlcmF0ZWRJbmZvLnByb3ZpZGVyLCB1c2VyID0gZmVkZXJhdGVkSW5mby51c2VyLCB0b2tlbiA9IGZlZGVyYXRlZEluZm8udG9rZW4sIGlkZW50aXR5X2lkID0gZmVkZXJhdGVkSW5mby5pZGVudGl0eV9pZDtcbiAgICAgICAgdmFyIGV4cGlyZXNfYXQgPSBmZWRlcmF0ZWRJbmZvLmV4cGlyZXNfYXQ7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSBleHBpcmVzX2F0IGlzIGluIG1pbGxpc1xuICAgICAgICBleHBpcmVzX2F0ID1cbiAgICAgICAgICAgIG5ldyBEYXRlKGV4cGlyZXNfYXQpLmdldEZ1bGxZZWFyKCkgPT09IDE5NzBcbiAgICAgICAgICAgICAgICA/IGV4cGlyZXNfYXQgKiAxMDAwXG4gICAgICAgICAgICAgICAgOiBleHBpcmVzX2F0O1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnY2hlY2tpbmcgaWYgZmVkZXJhdGVkIGp3dCB0b2tlbiBleHBpcmVkJyk7XG4gICAgICAgIGlmIChleHBpcmVzX2F0ID4gbmV3IERhdGUoKS5nZXRUaW1lKCkpIHtcbiAgICAgICAgICAgIC8vIGlmIG5vdCBleHBpcmVkXG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3Rva2VuIG5vdCBleHBpcmVkJyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0Q3JlZGVudGlhbHNGcm9tRmVkZXJhdGlvbih7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgIHRva2VuOiB0b2tlbixcbiAgICAgICAgICAgICAgICB1c2VyOiB1c2VyLFxuICAgICAgICAgICAgICAgIGlkZW50aXR5X2lkOiBpZGVudGl0eV9pZCxcbiAgICAgICAgICAgICAgICBleHBpcmVzX2F0OiBleHBpcmVzX2F0LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiByZWZyZXNoIGhhbmRsZXIgZXhpc3RzXG4gICAgICAgICAgICBpZiAodGhhdC5fcmVmcmVzaEhhbmRsZXJzW3Byb3ZpZGVyXSAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiB0aGF0Ll9yZWZyZXNoSGFuZGxlcnNbcHJvdmlkZXJdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdnZXR0aW5nIHJlZnJlc2hlZCBqd3QgdG9rZW4gZnJvbSBmZWRlcmF0aW9uIHByb3ZpZGVyJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVyUmVmcmVzaFdpdGhSZXRyeSh7XG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hIYW5kbGVyOiB0aGF0Ll9yZWZyZXNoSGFuZGxlcnNbcHJvdmlkZXJdLFxuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcjogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHVzZXIsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ25vIHJlZnJlc2ggaGFuZGxlciBmb3IgcHJvdmlkZXI6JywgcHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ25vIHJlZnJlc2ggaGFuZGxlciBmb3IgcHJvdmlkZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuX3Byb3ZpZGVyUmVmcmVzaFdpdGhSZXRyeSA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcmVmcmVzaEhhbmRsZXIgPSBfYS5yZWZyZXNoSGFuZGxlciwgcHJvdmlkZXIgPSBfYS5wcm92aWRlciwgdXNlciA9IF9hLnVzZXI7XG4gICAgICAgIHZhciBNQVhfREVMQVlfTVMgPSAxMCAqIDEwMDA7XG4gICAgICAgIC8vIHJlZnJlc2hIYW5kbGVyIHdpbGwgcmV0cnkgbmV0d29yayBlcnJvcnMsIG90aGVyd2lzZSBpdCB3aWxsXG4gICAgICAgIC8vIHJldHVybiBOb25SZXRyeWFibGVFcnJvciB0byBicmVhayBvdXQgb2Ygaml0dGVyZWRFeHBvbmVudGlhbFJldHJ5XG4gICAgICAgIHJldHVybiBqaXR0ZXJlZEV4cG9uZW50aWFsUmV0cnkocmVmcmVzaEhhbmRsZXIsIFtdLCBNQVhfREVMQVlfTVMpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdyZWZyZXNoIGZlZGVyYXRlZCB0b2tlbiBzdWNlc3NmdWxseScsIGRhdGEpO1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9zZXRDcmVkZW50aWFsc0Zyb21GZWRlcmF0aW9uKHtcbiAgICAgICAgICAgICAgICBwcm92aWRlcjogcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgdG9rZW46IGRhdGEudG9rZW4sXG4gICAgICAgICAgICAgICAgdXNlcjogdXNlcixcbiAgICAgICAgICAgICAgICBpZGVudGl0eV9pZDogZGF0YS5pZGVudGl0eV9pZCxcbiAgICAgICAgICAgICAgICBleHBpcmVzX2F0OiBkYXRhLmV4cGlyZXNfYXQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGlzTmV0d29ya0Vycm9yID0gdHlwZW9mIGUgPT09ICdzdHJpbmcnICYmXG4gICAgICAgICAgICAgICAgZS50b0xvd2VyQ2FzZSgpLmxhc3RJbmRleE9mKCduZXR3b3JrIGVycm9yJywgZS5sZW5ndGgpID09PSAwO1xuICAgICAgICAgICAgaWYgKCFpc05ldHdvcmtFcnJvcikge1xuICAgICAgICAgICAgICAgIF90aGlzLmNsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3JlZnJlc2ggZmVkZXJhdGVkIHRva2VuIGZhaWxlZCcsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdyZWZyZXNoaW5nIGZlZGVyYXRpb24gdG9rZW4gZmFpbGVkOiAnICsgZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuX2lzRXhwaXJlZCA9IGZ1bmN0aW9uIChjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ25vIGNyZWRlbnRpYWxzIGZvciBleHBpcmF0aW9uIGNoZWNrJyk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIuZGVidWcoJ2FyZSB0aGVzZSBjcmVkZW50aWFscyBleHBpcmVkPycsIGNyZWRlbnRpYWxzKTtcbiAgICAgICAgdmFyIHRzID0gRGF0ZS5ub3coKTtcbiAgICAgICAgLyogcmV0dXJucyBkYXRlIG9iamVjdC5cbiAgICAgICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9hd3MvYXdzLXNkay1qcy12My9ibG9iL3YxLjAuMC1iZXRhLjEvcGFja2FnZXMvdHlwZXMvc3JjL2NyZWRlbnRpYWxzLnRzI0wyNlxuICAgICAgICAqL1xuICAgICAgICB2YXIgZXhwaXJhdGlvbiA9IGNyZWRlbnRpYWxzLmV4cGlyYXRpb247XG4gICAgICAgIHJldHVybiBleHBpcmF0aW9uLmdldFRpbWUoKSA8PSB0cztcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9pc1Bhc3RUVEwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uZXh0Q3JlZGVudGlhbHNSZWZyZXNoIDw9IERhdGUubm93KCk7XG4gICAgfTtcbiAgICBDcmVkZW50aWFsc0NsYXNzLnByb3RvdHlwZS5fc2V0Q3JlZGVudGlhbHNGb3JHdWVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hLCBpZGVudGl0eVBvb2xJZCwgcmVnaW9uLCBtYW5kYXRvcnlTaWduSW4sIGlkZW50aXR5SWQsIF9iLCBjb2duaXRvQ2xpZW50LCBjcmVkZW50aWFscywgY29nbml0b0lkZW50aXR5UGFyYW1zLCBjcmVkZW50aWFsc1Byb3ZpZGVyO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnc2V0dGluZyBjcmVkZW50aWFscyBmb3IgZ3Vlc3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy5fY29uZmlnLCBpZGVudGl0eVBvb2xJZCA9IF9hLmlkZW50aXR5UG9vbElkLCByZWdpb24gPSBfYS5yZWdpb24sIG1hbmRhdG9yeVNpZ25JbiA9IF9hLm1hbmRhdG9yeVNpZ25JbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5kYXRvcnlTaWduSW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZWplY3QoJ2Nhbm5vdCBnZXQgZ3Vlc3QgY3JlZGVudGlhbHMgd2hlbiBtYW5kYXRvcnkgc2lnbmluIGVuYWJsZWQnKV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlkZW50aXR5UG9vbElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdObyBDb2duaXRvIElkZW50aXR5IHBvb2wgcHJvdmlkZWQgZm9yIHVuYXV0aGVudGljYXRlZCBhY2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZWplY3QoJ05vIENvZ25pdG8gSWRlbnRpdHkgcG9vbCBwcm92aWRlZCBmb3IgdW5hdXRoZW50aWNhdGVkIGFjY2VzcycpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdyZWdpb24gaXMgbm90IGNvbmZpZ3VyZWQgZm9yIGdldHRpbmcgdGhlIGNyZWRlbnRpYWxzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFByb21pc2UucmVqZWN0KCdyZWdpb24gaXMgbm90IGNvbmZpZ3VyZWQgZm9yIGdldHRpbmcgdGhlIGNyZWRlbnRpYWxzJyldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fZ2V0R3Vlc3RJZGVudGl0eUlkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZGVudGl0eUlkID0gKF9iLl9pZGVudGl0eUlkID0gX2Muc2VudCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZ25pdG9DbGllbnQgPSBjcmVhdGVDb2duaXRvSWRlbnRpdHlDbGllbnQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFscyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZGVudGl0eUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29nbml0b0lkZW50aXR5UGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZGVudGl0eUlkOiBpZGVudGl0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQ6IGNvZ25pdG9DbGllbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFscyA9IGZyb21Db2duaXRvSWRlbnRpdHkoY29nbml0b0lkZW50aXR5UGFyYW1zKSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHNQcm92aWRlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIElkZW50aXR5SWQsIGNvZ25pdG9JZGVudGl0eVBhcmFtcywgY3JlZGVudGlhbHNGcm9tQ29nbml0b0lkZW50aXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBjb2duaXRvQ2xpZW50LnNlbmQobmV3IEdldElkQ29tbWFuZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZGVudGl0eVBvb2xJZDogaWRlbnRpdHlQb29sSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZGVudGl0eUlkID0gKF9hLnNlbnQoKSkuSWRlbnRpdHlJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faWRlbnRpdHlJZCA9IElkZW50aXR5SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZ25pdG9JZGVudGl0eVBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudDogY29nbml0b0NsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkZW50aXR5SWQ6IElkZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzRnJvbUNvZ25pdG9JZGVudGl0eSA9IGZyb21Db2duaXRvSWRlbnRpdHkoY29nbml0b0lkZW50aXR5UGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGNyZWRlbnRpYWxzRnJvbUNvZ25pdG9JZGVudGl0eSgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBjcmVkZW50aWFsc1Byb3ZpZGVyKCkuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9sb2FkQ3JlZGVudGlhbHMoY3JlZGVudGlhbHMsICdndWVzdCcsIGZhbHNlLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjcmVkZW50aWFsc1Byb3ZpZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlLm5hbWUgPT09ICdSZXNvdXJjZU5vdEZvdW5kRXhjZXB0aW9uJyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5tZXNzYWdlID09PSBcIklkZW50aXR5ICdcIiArIGlkZW50aXR5SWQgKyBcIicgbm90IGZvdW5kLlwiKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIGxvYWQgZ3Vlc3QgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fcmVtb3ZlR3Vlc3RJZGVudGl0eUlkKCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsc1Byb3ZpZGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIElkZW50aXR5SWQsIGNvZ25pdG9JZGVudGl0eVBhcmFtcywgY3JlZGVudGlhbHNGcm9tQ29nbml0b0lkZW50aXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBjb2duaXRvQ2xpZW50LnNlbmQobmV3IEdldElkQ29tbWFuZCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSWRlbnRpdHlQb29sSWQ6IGlkZW50aXR5UG9vbElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSWRlbnRpdHlJZCA9IChfYS5zZW50KCkpLklkZW50aXR5SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pZGVudGl0eUlkID0gSWRlbnRpdHlJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZ25pdG9JZGVudGl0eVBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQ6IGNvZ25pdG9DbGllbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlJZDogSWRlbnRpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsc0Zyb21Db2duaXRvSWRlbnRpdHkgPSBmcm9tQ29nbml0b0lkZW50aXR5KGNvZ25pdG9JZGVudGl0eVBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgY3JlZGVudGlhbHNGcm9tQ29nbml0b0lkZW50aXR5KCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBjcmVkZW50aWFsc1Byb3ZpZGVyKCkuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9sb2FkQ3JlZGVudGlhbHMoY3JlZGVudGlhbHMsICdndWVzdCcsIGZhbHNlLCBudWxsKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qLywgZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuX3NldENyZWRlbnRpYWxzRnJvbUZlZGVyYXRpb24gPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBwcm92aWRlciA9IHBhcmFtcy5wcm92aWRlciwgdG9rZW4gPSBwYXJhbXMudG9rZW4sIGlkZW50aXR5X2lkID0gcGFyYW1zLmlkZW50aXR5X2lkO1xuICAgICAgICB2YXIgZG9tYWlucyA9IHtcbiAgICAgICAgICAgIGdvb2dsZTogJ2FjY291bnRzLmdvb2dsZS5jb20nLFxuICAgICAgICAgICAgZmFjZWJvb2s6ICdncmFwaC5mYWNlYm9vay5jb20nLFxuICAgICAgICAgICAgYW1hem9uOiAnd3d3LmFtYXpvbi5jb20nLFxuICAgICAgICAgICAgZGV2ZWxvcGVyOiAnY29nbml0by1pZGVudGl0eS5hbWF6b25hd3MuY29tJyxcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVXNlIGN1c3RvbSBwcm92aWRlciB1cmwgaW5zdGVhZCBvZiB0aGUgcHJlZGVmaW5lZCBvbmVzXG4gICAgICAgIHZhciBkb21haW4gPSBkb21haW5zW3Byb3ZpZGVyXSB8fCBwcm92aWRlcjtcbiAgICAgICAgaWYgKCFkb21haW4pIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnWW91IG11c3Qgc3BlY2lmeSBhIGZlZGVyYXRlZCBwcm92aWRlcicpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsb2dpbnMgPSB7fTtcbiAgICAgICAgbG9naW5zW2RvbWFpbl0gPSB0b2tlbjtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5fY29uZmlnLCBpZGVudGl0eVBvb2xJZCA9IF9hLmlkZW50aXR5UG9vbElkLCByZWdpb24gPSBfYS5yZWdpb247XG4gICAgICAgIGlmICghaWRlbnRpdHlQb29sSWQpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnTm8gQ29nbml0byBGZWRlcmF0ZWQgSWRlbnRpdHkgcG9vbCBwcm92aWRlZCcpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdObyBDb2duaXRvIEZlZGVyYXRlZCBJZGVudGl0eSBwb29sIHByb3ZpZGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZWdpb24pIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygncmVnaW9uIGlzIG5vdCBjb25maWd1cmVkIGZvciBnZXR0aW5nIHRoZSBjcmVkZW50aWFscycpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdyZWdpb24gaXMgbm90IGNvbmZpZ3VyZWQgZm9yIGdldHRpbmcgdGhlIGNyZWRlbnRpYWxzJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvZ25pdG9DbGllbnQgPSBjcmVhdGVDb2duaXRvSWRlbnRpdHlDbGllbnQoe1xuICAgICAgICAgICAgcmVnaW9uOiByZWdpb24sXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY3JlZGVudGlhbHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChpZGVudGl0eV9pZCkge1xuICAgICAgICAgICAgdmFyIGNvZ25pdG9JZGVudGl0eVBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBpZGVudGl0eUlkOiBpZGVudGl0eV9pZCxcbiAgICAgICAgICAgICAgICBsb2dpbnM6IGxvZ2lucyxcbiAgICAgICAgICAgICAgICBjbGllbnQ6IGNvZ25pdG9DbGllbnQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBmcm9tQ29nbml0b0lkZW50aXR5KGNvZ25pdG9JZGVudGl0eVBhcmFtcykoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjb2duaXRvSWRlbnRpdHlQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgbG9naW5zOiBsb2dpbnMsXG4gICAgICAgICAgICAgICAgaWRlbnRpdHlQb29sSWQ6IGlkZW50aXR5UG9vbElkLFxuICAgICAgICAgICAgICAgIGNsaWVudDogY29nbml0b0NsaWVudCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjcmVkZW50aWFscyA9IGZyb21Db2duaXRvSWRlbnRpdHlQb29sKGNvZ25pdG9JZGVudGl0eVBhcmFtcykoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbG9hZENyZWRlbnRpYWxzKGNyZWRlbnRpYWxzLCAnZmVkZXJhdGVkJywgdHJ1ZSwgcGFyYW1zKTtcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9zZXRDcmVkZW50aWFsc0Zyb21TZXNzaW9uID0gZnVuY3Rpb24gKHNlc3Npb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdzZXQgY3JlZGVudGlhbHMgZnJvbSBzZXNzaW9uJyk7XG4gICAgICAgIHZhciBpZFRva2VuID0gc2Vzc2lvbi5nZXRJZFRva2VuKCkuZ2V0Snd0VG9rZW4oKTtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5fY29uZmlnLCByZWdpb24gPSBfYS5yZWdpb24sIHVzZXJQb29sSWQgPSBfYS51c2VyUG9vbElkLCBpZGVudGl0eVBvb2xJZCA9IF9hLmlkZW50aXR5UG9vbElkO1xuICAgICAgICBpZiAoIWlkZW50aXR5UG9vbElkKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ05vIENvZ25pdG8gRmVkZXJhdGVkIElkZW50aXR5IHBvb2wgcHJvdmlkZWQnKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnTm8gQ29nbml0byBGZWRlcmF0ZWQgSWRlbnRpdHkgcG9vbCBwcm92aWRlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVnaW9uKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3JlZ2lvbiBpcyBub3QgY29uZmlndXJlZCBmb3IgZ2V0dGluZyB0aGUgY3JlZGVudGlhbHMnKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgncmVnaW9uIGlzIG5vdCBjb25maWd1cmVkIGZvciBnZXR0aW5nIHRoZSBjcmVkZW50aWFscycpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBrZXkgPSAnY29nbml0by1pZHAuJyArIHJlZ2lvbiArICcuYW1hem9uYXdzLmNvbS8nICsgdXNlclBvb2xJZDtcbiAgICAgICAgdmFyIGxvZ2lucyA9IHt9O1xuICAgICAgICBsb2dpbnNba2V5XSA9IGlkVG9rZW47XG4gICAgICAgIHZhciBjb2duaXRvQ2xpZW50ID0gY3JlYXRlQ29nbml0b0lkZW50aXR5Q2xpZW50KHtcbiAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICB9KTtcbiAgICAgICAgLypcbiAgICAgICAgICAgIFJldHJlaXZpbmcgaWRlbnRpdHlJZCB3aXRoIEdldElkQ29tbWFuZCB0byBtaW1pYyB0aGUgYmVoYXZpb3IgaW4gdGhlIGZvbGxvd2luZyBjb2RlIGluIGF3cy1zZGstdjM6XG4gICAgICAgICAgICBodHRwczovL2dpdC5pby9KZUR4VVxuXG4gICAgICAgICAgICBOb3RlOiBSZXRyZWl2ZSBpZGVudGl0eUlkIGZyb20gQ3JlZGVudGlhbHNQcm92aWRlciBvbmNlIGF3cy1zZGstanMgdjMgc3VwcG9ydHMgdGhpcy5cbiAgICAgICAgKi9cbiAgICAgICAgdmFyIGNyZWRlbnRpYWxzUHJvdmlkZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZ3Vlc3RJZGVudGl0eUlkLCBnZW5lcmF0ZWRPclJldHJpZXZlZElkZW50aXR5SWQsIElkZW50aXR5SWQsIF9hLCBfYiwgQWNjZXNzS2V5SWQsIEV4cGlyYXRpb24sIFNlY3JldEtleSwgU2Vzc2lvblRva2VuLCBwcmltYXJ5SWRlbnRpdHlJZDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fZ2V0R3Vlc3RJZGVudGl0eUlkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBndWVzdElkZW50aXR5SWQgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFndWVzdElkZW50aXR5SWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29nbml0b0NsaWVudC5zZW5kKG5ldyBHZXRJZENvbW1hbmQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZGVudGl0eVBvb2xJZDogaWRlbnRpdHlQb29sSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2luczogbG9naW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIElkZW50aXR5SWQgPSAoX2Muc2VudCgpKS5JZGVudGl0eUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVkT3JSZXRyaWV2ZWRJZGVudGl0eUlkID0gSWRlbnRpdHlJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCBjb2duaXRvQ2xpZW50LnNlbmQobmV3IEdldENyZWRlbnRpYWxzRm9ySWRlbnRpdHlDb21tYW5kKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJZGVudGl0eUlkOiBndWVzdElkZW50aXR5SWQgfHwgZ2VuZXJhdGVkT3JSZXRyaWV2ZWRJZGVudGl0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2luczogbG9naW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBfYy5zZW50KCksIF9iID0gX2EuQ3JlZGVudGlhbHMsIEFjY2Vzc0tleUlkID0gX2IuQWNjZXNzS2V5SWQsIEV4cGlyYXRpb24gPSBfYi5FeHBpcmF0aW9uLCBTZWNyZXRLZXkgPSBfYi5TZWNyZXRLZXksIFNlc3Npb25Ub2tlbiA9IF9iLlNlc3Npb25Ub2tlbiwgcHJpbWFyeUlkZW50aXR5SWQgPSBfYS5JZGVudGl0eUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faWRlbnRpdHlJZCA9IHByaW1hcnlJZGVudGl0eUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFndWVzdElkZW50aXR5SWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgZ3Vlc3RJZGVudGl0eSBpcyBmb3VuZCBhbmQgdXNlZCBieSBHZXRDcmVkZW50aWFsc0ZvcklkZW50aXR5XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIGJlIGxpbmtlZCB0byB0aGUgbG9naW5zIHByb3ZpZGVkLCBhbmQgZGlzcXVhbGlmaWVkIGFzIGFuIHVuYXV0aCBpZGVudGl0eVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiVGhlIGd1ZXN0IGlkZW50aXR5IFwiICsgZ3Vlc3RJZGVudGl0eUlkICsgXCIgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGxpbmtlZCB0byB0aGUgbG9naW5zXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGd1ZXN0SWRlbnRpdHlJZCA9PT0gcHJpbWFyeUlkZW50aXR5SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJUaGUgZ3Vlc3QgaWRlbnRpdHkgXCIgKyBndWVzdElkZW50aXR5SWQgKyBcIiBoYXMgYmVjb21lIHRoZSBwcmltYXJ5IGlkZW50aXR5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGl0IGZyb20gbG9jYWwgc3RvcmFnZSB0byBhdm9pZCBiZWluZyB1c2VkIGFzIGEgZ3Vlc3QgSWRlbnRpdHkgYnkgX3NldENyZWRlbnRpYWxzRm9yR3Vlc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3JlbW92ZUd1ZXN0SWRlbnRpdHlJZCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGl0IGZyb20gbG9jYWwgc3RvcmFnZSB0byBhdm9pZCBiZWluZyB1c2VkIGFzIGEgZ3Vlc3QgSWRlbnRpdHkgYnkgX3NldENyZWRlbnRpYWxzRm9yR3Vlc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiBcbiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2F3cy9hd3Mtc2RrLWpzLXYzL2Jsb2IvbWFpbi9wYWNrYWdlcy9jcmVkZW50aWFsLXByb3ZpZGVyLWNvZ25pdG8taWRlbnRpdHkvc3JjL2Zyb21Db2duaXRvSWRlbnRpdHkudHMjTDQwXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzS2V5SWQ6IEFjY2Vzc0tleUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY3JldEFjY2Vzc0tleTogU2VjcmV0S2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25Ub2tlbjogU2Vzc2lvblRva2VuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb246IEV4cGlyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlJZDogcHJpbWFyeUlkZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH07XG4gICAgICAgIHZhciBjcmVkZW50aWFscyA9IGNyZWRlbnRpYWxzUHJvdmlkZXIoKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRDcmVkZW50aWFscyhjcmVkZW50aWFscywgJ3VzZXJQb29sJywgdHJ1ZSwgbnVsbCk7XG4gICAgfTtcbiAgICBDcmVkZW50aWFsc0NsYXNzLnByb3RvdHlwZS5fbG9hZENyZWRlbnRpYWxzID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzLCBzb3VyY2UsIGF1dGhlbnRpY2F0ZWQsIGluZm8pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICBjcmVkZW50aWFsc1xuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjcmVkZW50aWFscykgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyLCBwcm92aWRlciwgdG9rZW4sIGV4cGlyZXNfYXQsIGlkZW50aXR5X2lkO1xuICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnTG9hZCBjcmVkZW50aWFscyBzdWNjZXNzZnVsbHknLCBjcmVkZW50aWFscyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lkZW50aXR5SWQgJiYgIWNyZWRlbnRpYWxzLmlkZW50aXR5SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHNbJ2lkZW50aXR5SWQnXSA9IHRoaXMuX2lkZW50aXR5SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2NyZWRlbnRpYWxzID0gY3JlZGVudGlhbHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fY3JlZGVudGlhbHMuYXV0aGVudGljYXRlZCA9IGF1dGhlbnRpY2F0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fY3JlZGVudGlhbHNfc291cmNlID0gc291cmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX25leHRDcmVkZW50aWFsc1JlZnJlc2ggPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIENSRURFTlRJQUxTX1RUTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlID09PSAnZmVkZXJhdGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gT2JqZWN0LmFzc2lnbih7IGlkOiB0aGlzLl9jcmVkZW50aWFscy5pZGVudGl0eUlkIH0sIGluZm8udXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gaW5mby5wcm92aWRlciwgdG9rZW4gPSBpbmZvLnRva2VuLCBleHBpcmVzX2F0ID0gaW5mby5leHBpcmVzX2F0LCBpZGVudGl0eV9pZCA9IGluZm8uaWRlbnRpdHlfaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdG9yYWdlLnNldEl0ZW0oJ2F3cy1hbXBsaWZ5LWZlZGVyYXRlZEluZm8nLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiB0b2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB1c2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZXNfYXQ6IGV4cGlyZXNfYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlfaWQ6IGlkZW50aXR5X2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZhaWxlZCB0byBwdXQgZmVkZXJhdGVkIGluZm8gaW50byBhdXRoIHN0b3JhZ2UnLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzb3VyY2UgPT09ICdndWVzdCcpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zZXRHdWVzdElkZW50aXR5SWQoY3JlZGVudGlhbHMuaWRlbnRpdHlJZCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHRoYXQuX2NyZWRlbnRpYWxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pOyB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZhaWxlZCB0byBsb2FkIGNyZWRlbnRpYWxzJywgY3JlZGVudGlhbHMpO1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0Vycm9yIGxvYWRpbmcgY3JlZGVudGlhbHMnLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChwYXJhbXMsIHNvdXJjZSkge1xuICAgICAgICBpZiAoc291cmNlID09PSAnc2Vzc2lvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZXRDcmVkZW50aWFsc0Zyb21TZXNzaW9uKHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc291cmNlID09PSAnZmVkZXJhdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZXRDcmVkZW50aWFsc0Zyb21GZWRlcmF0aW9uKHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc291cmNlID09PSAnZ3Vlc3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0Q3JlZGVudGlhbHNGb3JHdWVzdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdubyBzb3VyY2Ugc3BlY2lmaWVkIGZvciBzZXR0aW5nIGNyZWRlbnRpYWxzJyk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ2ludmFsaWQgc291cmNlJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlZGVudGlhbHMgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NyZWRlbnRpYWxzX3NvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdyZW1vdmluZyBhd3MtYW1wbGlmeS1mZWRlcmF0ZWRJbmZvIGZyb20gc3RvcmFnZScpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0b3JhZ2UucmVtb3ZlSXRlbSgnYXdzLWFtcGxpZnktZmVkZXJhdGVkSW5mbycpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qIG9wZXJhdGlvbnMgb24gbG9jYWwgc3RvcmVkIGd1ZXN0IGlkZW50aXR5ICovXG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuX2dldEd1ZXN0SWRlbnRpdHlJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlkZW50aXR5UG9vbElkLCBlXzE7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZGVudGl0eVBvb2xJZCA9IHRoaXMuX2NvbmZpZy5pZGVudGl0eVBvb2xJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3N0b3JhZ2VTeW5jXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuX3N0b3JhZ2UuZ2V0SXRlbSh0aGlzLl9nZXRDb2duaXRvSWRlbnRpdHlJZFN0b3JhZ2VLZXkoaWRlbnRpdHlQb29sSWQpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmFpbGVkIHRvIGdldCB0aGUgY2FjaGVkIGd1ZXN0IGlkZW50aXR5SWQnLCBlXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENyZWRlbnRpYWxzQ2xhc3MucHJvdG90eXBlLl9zZXRHdWVzdElkZW50aXR5SWQgPSBmdW5jdGlvbiAoaWRlbnRpdHlJZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaWRlbnRpdHlQb29sSWQsIGVfMjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkZW50aXR5UG9vbElkID0gdGhpcy5fY29uZmlnLmlkZW50aXR5UG9vbElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc3RvcmFnZVN5bmNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdG9yYWdlLnNldEl0ZW0odGhpcy5fZ2V0Q29nbml0b0lkZW50aXR5SWRTdG9yYWdlS2V5KGlkZW50aXR5UG9vbElkKSwgaWRlbnRpdHlJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8yID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gY2FjaGUgZ3Vlc3QgaWRlbnRpdHlJZCcsIGVfMik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuX3JlbW92ZUd1ZXN0SWRlbnRpdHlJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlkZW50aXR5UG9vbElkO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIGlkZW50aXR5UG9vbElkID0gdGhpcy5fY29uZmlnLmlkZW50aXR5UG9vbElkO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcInJlbW92aW5nIFwiICsgdGhpcy5fZ2V0Q29nbml0b0lkZW50aXR5SWRTdG9yYWdlS2V5KGlkZW50aXR5UG9vbElkKSArIFwiIGZyb20gc3RvcmFnZVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5fZ2V0Q29nbml0b0lkZW50aXR5SWRTdG9yYWdlS2V5KGlkZW50aXR5UG9vbElkKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29tcGFjdCB2ZXJzaW9uIG9mIGNyZWRlbnRpYWxzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNyZWRlbnRpYWxzXG4gICAgICogQHJldHVybiB7T2JqZWN0fSAtIENyZWRlbnRpYWxzXG4gICAgICovXG4gICAgQ3JlZGVudGlhbHNDbGFzcy5wcm90b3R5cGUuc2hlYXIgPSBmdW5jdGlvbiAoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFjY2Vzc0tleUlkOiBjcmVkZW50aWFscy5hY2Nlc3NLZXlJZCxcbiAgICAgICAgICAgIHNlc3Npb25Ub2tlbjogY3JlZGVudGlhbHMuc2Vzc2lvblRva2VuLFxuICAgICAgICAgICAgc2VjcmV0QWNjZXNzS2V5OiBjcmVkZW50aWFscy5zZWNyZXRBY2Nlc3NLZXksXG4gICAgICAgICAgICBpZGVudGl0eUlkOiBjcmVkZW50aWFscy5pZGVudGl0eUlkLFxuICAgICAgICAgICAgYXV0aGVudGljYXRlZDogY3JlZGVudGlhbHMuYXV0aGVudGljYXRlZCxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBDcmVkZW50aWFsc0NsYXNzO1xufSgpKTtcbmV4cG9ydCB7IENyZWRlbnRpYWxzQ2xhc3MgfTtcbmV4cG9ydCB2YXIgQ3JlZGVudGlhbHMgPSBuZXcgQ3JlZGVudGlhbHNDbGFzcyhudWxsKTtcbkFtcGxpZnkucmVnaXN0ZXIoQ3JlZGVudGlhbHMpO1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IENyZWRlbnRpYWxzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q3JlZGVudGlhbHMuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Credentials.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Hub.js":
/*!*******************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Hub.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Hub: () => (/* binding */ Hub),\n/* harmony export */   HubClass: () => (/* binding */ HubClass),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (undefined && undefined.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Hub');\nvar AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined' &&\n    typeof Symbol.for === 'function'\n    ? Symbol.for('amplify_default')\n    : '@@amplify_default');\nfunction isLegacyCallback(callback) {\n    return callback.onHubCapsule !== undefined;\n}\nvar HubClass = /** @class */ (function () {\n    function HubClass(name) {\n        this.listeners = [];\n        this.patterns = [];\n        this.protectedChannels = [\n            'core',\n            'auth',\n            'api',\n            'analytics',\n            'interactions',\n            'pubsub',\n            'storage',\n            'ui',\n            'xr',\n        ];\n        this.name = name;\n    }\n    // Note - Need to pass channel as a reference for removal to work and not anonymous function\n    HubClass.prototype.remove = function (channel, listener) {\n        if (channel instanceof RegExp) {\n            var pattern_1 = this.patterns.find(function (_a) {\n                var pattern = _a.pattern;\n                return pattern.source === channel.source;\n            });\n            if (!pattern_1) {\n                logger.warn(\"No listeners for \" + channel);\n                return;\n            }\n            this.patterns = __spread(this.patterns.filter(function (x) { return x !== pattern_1; }));\n        }\n        else {\n            var holder = this.listeners[channel];\n            if (!holder) {\n                logger.warn(\"No listeners for \" + channel);\n                return;\n            }\n            this.listeners[channel] = __spread(holder.filter(function (_a) {\n                var callback = _a.callback;\n                return callback !== listener;\n            }));\n        }\n    };\n    HubClass.prototype.dispatch = function (channel, payload, source, ampSymbol) {\n        if (source === void 0) { source = ''; }\n        if (this.protectedChannels.indexOf(channel) > -1) {\n            var hasAccess = ampSymbol === AMPLIFY_SYMBOL;\n            if (!hasAccess) {\n                logger.warn(\"WARNING: \" + channel + \" is protected and dispatching on it can have unintended consequences\");\n            }\n        }\n        var capsule = {\n            channel: channel,\n            payload: __assign({}, payload),\n            source: source,\n            patternInfo: [],\n        };\n        try {\n            this._toListeners(capsule);\n        }\n        catch (e) {\n            logger.error(e);\n        }\n    };\n    HubClass.prototype.listen = function (channel, callback, listenerName) {\n        var _this = this;\n        if (listenerName === void 0) { listenerName = 'noname'; }\n        var cb;\n        // Check for legacy onHubCapsule callback for backwards compatability\n        if (isLegacyCallback(callback)) {\n            logger.warn(\"WARNING onHubCapsule is Deprecated. Please pass in a callback.\");\n            cb = callback.onHubCapsule.bind(callback);\n        }\n        else if (typeof callback !== 'function') {\n            throw new Error('No callback supplied to Hub');\n        }\n        else {\n            cb = callback;\n        }\n        if (channel instanceof RegExp) {\n            this.patterns.push({\n                pattern: channel,\n                callback: cb,\n            });\n        }\n        else {\n            var holder = this.listeners[channel];\n            if (!holder) {\n                holder = [];\n                this.listeners[channel] = holder;\n            }\n            holder.push({\n                name: listenerName,\n                callback: cb,\n            });\n        }\n        return function () {\n            _this.remove(channel, cb);\n        };\n    };\n    HubClass.prototype._toListeners = function (capsule) {\n        var channel = capsule.channel, payload = capsule.payload;\n        var holder = this.listeners[channel];\n        if (holder) {\n            holder.forEach(function (listener) {\n                logger.debug(\"Dispatching to \" + channel + \" with \", payload);\n                try {\n                    listener.callback(capsule);\n                }\n                catch (e) {\n                    logger.error(e);\n                }\n            });\n        }\n        if (this.patterns.length > 0) {\n            if (!payload.message) {\n                logger.warn(\"Cannot perform pattern matching without a message key\");\n                return;\n            }\n            var payloadStr_1 = payload.message;\n            this.patterns.forEach(function (pattern) {\n                var match = payloadStr_1.match(pattern.pattern);\n                if (match) {\n                    var _a = __read(match), groups = _a.slice(1);\n                    var dispatchingCapsule = __assign(__assign({}, capsule), { patternInfo: groups });\n                    try {\n                        pattern.callback(dispatchingCapsule);\n                    }\n                    catch (e) {\n                        logger.error(e);\n                    }\n                }\n            });\n        }\n    };\n    return HubClass;\n}());\n\n/*We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events.*/\nvar Hub = new HubClass('__default__');\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Hub);\n//# sourceMappingURL=Hub.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9IdWIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1QjtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFNBQUksSUFBSSxTQUFJO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixNQUFNO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1Qiw2QkFBNkIsc0JBQXNCO0FBQ25EO0FBQ0E7QUFDbUQ7QUFDbkQsaUJBQWlCLGtEQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSx5QkFBeUI7QUFDbEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxjQUFjLHFCQUFxQjtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ21CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsR0FBRyxFQUFDO0FBQ25CIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL0h1Yi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTctMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbnZhciBfX3NwcmVhZCA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWQpIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xuICAgIHJldHVybiBhcjtcbn07XG5pbXBvcnQgeyBDb25zb2xlTG9nZ2VyIGFzIExvZ2dlciB9IGZyb20gJy4vTG9nZ2VyJztcbnZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdIdWInKTtcbnZhciBBTVBMSUZZX1NZTUJPTCA9ICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJlxuICAgIHR5cGVvZiBTeW1ib2wuZm9yID09PSAnZnVuY3Rpb24nXG4gICAgPyBTeW1ib2wuZm9yKCdhbXBsaWZ5X2RlZmF1bHQnKVxuICAgIDogJ0BAYW1wbGlmeV9kZWZhdWx0Jyk7XG5mdW5jdGlvbiBpc0xlZ2FjeUNhbGxiYWNrKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrLm9uSHViQ2Fwc3VsZSAhPT0gdW5kZWZpbmVkO1xufVxudmFyIEh1YkNsYXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEh1YkNsYXNzKG5hbWUpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wYXR0ZXJucyA9IFtdO1xuICAgICAgICB0aGlzLnByb3RlY3RlZENoYW5uZWxzID0gW1xuICAgICAgICAgICAgJ2NvcmUnLFxuICAgICAgICAgICAgJ2F1dGgnLFxuICAgICAgICAgICAgJ2FwaScsXG4gICAgICAgICAgICAnYW5hbHl0aWNzJyxcbiAgICAgICAgICAgICdpbnRlcmFjdGlvbnMnLFxuICAgICAgICAgICAgJ3B1YnN1YicsXG4gICAgICAgICAgICAnc3RvcmFnZScsXG4gICAgICAgICAgICAndWknLFxuICAgICAgICAgICAgJ3hyJyxcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB9XG4gICAgLy8gTm90ZSAtIE5lZWQgdG8gcGFzcyBjaGFubmVsIGFzIGEgcmVmZXJlbmNlIGZvciByZW1vdmFsIHRvIHdvcmsgYW5kIG5vdCBhbm9ueW1vdXMgZnVuY3Rpb25cbiAgICBIdWJDbGFzcy5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGNoYW5uZWwsIGxpc3RlbmVyKSB7XG4gICAgICAgIGlmIChjaGFubmVsIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICAgICAgICB2YXIgcGF0dGVybl8xID0gdGhpcy5wYXR0ZXJucy5maW5kKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gX2EucGF0dGVybjtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybi5zb3VyY2UgPT09IGNoYW5uZWwuc291cmNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXBhdHRlcm5fMSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiTm8gbGlzdGVuZXJzIGZvciBcIiArIGNoYW5uZWwpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGF0dGVybnMgPSBfX3NwcmVhZCh0aGlzLnBhdHRlcm5zLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4geCAhPT0gcGF0dGVybl8xOyB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgaG9sZGVyID0gdGhpcy5saXN0ZW5lcnNbY2hhbm5lbF07XG4gICAgICAgICAgICBpZiAoIWhvbGRlcikge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiTm8gbGlzdGVuZXJzIGZvciBcIiArIGNoYW5uZWwpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2NoYW5uZWxdID0gX19zcHJlYWQoaG9sZGVyLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBfYS5jYWxsYmFjaztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sgIT09IGxpc3RlbmVyO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBIdWJDbGFzcy5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoY2hhbm5lbCwgcGF5bG9hZCwgc291cmNlLCBhbXBTeW1ib2wpIHtcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gdm9pZCAwKSB7IHNvdXJjZSA9ICcnOyB9XG4gICAgICAgIGlmICh0aGlzLnByb3RlY3RlZENoYW5uZWxzLmluZGV4T2YoY2hhbm5lbCkgPiAtMSkge1xuICAgICAgICAgICAgdmFyIGhhc0FjY2VzcyA9IGFtcFN5bWJvbCA9PT0gQU1QTElGWV9TWU1CT0w7XG4gICAgICAgICAgICBpZiAoIWhhc0FjY2Vzcykge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiV0FSTklORzogXCIgKyBjaGFubmVsICsgXCIgaXMgcHJvdGVjdGVkIGFuZCBkaXNwYXRjaGluZyBvbiBpdCBjYW4gaGF2ZSB1bmludGVuZGVkIGNvbnNlcXVlbmNlc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgY2Fwc3VsZSA9IHtcbiAgICAgICAgICAgIGNoYW5uZWw6IGNoYW5uZWwsXG4gICAgICAgICAgICBwYXlsb2FkOiBfX2Fzc2lnbih7fSwgcGF5bG9hZCksXG4gICAgICAgICAgICBzb3VyY2U6IHNvdXJjZSxcbiAgICAgICAgICAgIHBhdHRlcm5JbmZvOiBbXSxcbiAgICAgICAgfTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX3RvTGlzdGVuZXJzKGNhcHN1bGUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEh1YkNsYXNzLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAoY2hhbm5lbCwgY2FsbGJhY2ssIGxpc3RlbmVyTmFtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAobGlzdGVuZXJOYW1lID09PSB2b2lkIDApIHsgbGlzdGVuZXJOYW1lID0gJ25vbmFtZSc7IH1cbiAgICAgICAgdmFyIGNiO1xuICAgICAgICAvLyBDaGVjayBmb3IgbGVnYWN5IG9uSHViQ2Fwc3VsZSBjYWxsYmFjayBmb3IgYmFja3dhcmRzIGNvbXBhdGFiaWxpdHlcbiAgICAgICAgaWYgKGlzTGVnYWN5Q2FsbGJhY2soY2FsbGJhY2spKSB7XG4gICAgICAgICAgICBsb2dnZXIud2FybihcIldBUk5JTkcgb25IdWJDYXBzdWxlIGlzIERlcHJlY2F0ZWQuIFBsZWFzZSBwYXNzIGluIGEgY2FsbGJhY2suXCIpO1xuICAgICAgICAgICAgY2IgPSBjYWxsYmFjay5vbkh1YkNhcHN1bGUuYmluZChjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGNhbGxiYWNrIHN1cHBsaWVkIHRvIEh1YicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY2IgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbm5lbCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgICAgICAgdGhpcy5wYXR0ZXJucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiBjaGFubmVsLFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBjYixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGhvbGRlciA9IHRoaXMubGlzdGVuZXJzW2NoYW5uZWxdO1xuICAgICAgICAgICAgaWYgKCFob2xkZXIpIHtcbiAgICAgICAgICAgICAgICBob2xkZXIgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1tjaGFubmVsXSA9IGhvbGRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhvbGRlci5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBsaXN0ZW5lck5hbWUsXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGNiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZShjaGFubmVsLCBjYik7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBIdWJDbGFzcy5wcm90b3R5cGUuX3RvTGlzdGVuZXJzID0gZnVuY3Rpb24gKGNhcHN1bGUpIHtcbiAgICAgICAgdmFyIGNoYW5uZWwgPSBjYXBzdWxlLmNoYW5uZWwsIHBheWxvYWQgPSBjYXBzdWxlLnBheWxvYWQ7XG4gICAgICAgIHZhciBob2xkZXIgPSB0aGlzLmxpc3RlbmVyc1tjaGFubmVsXTtcbiAgICAgICAgaWYgKGhvbGRlcikge1xuICAgICAgICAgICAgaG9sZGVyLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFwiRGlzcGF0Y2hpbmcgdG8gXCIgKyBjaGFubmVsICsgXCIgd2l0aCBcIiwgcGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIuY2FsbGJhY2soY2Fwc3VsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXR0ZXJucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAoIXBheWxvYWQubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKFwiQ2Fubm90IHBlcmZvcm0gcGF0dGVybiBtYXRjaGluZyB3aXRob3V0IGEgbWVzc2FnZSBrZXlcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBheWxvYWRTdHJfMSA9IHBheWxvYWQubWVzc2FnZTtcbiAgICAgICAgICAgIHRoaXMucGF0dGVybnMuZm9yRWFjaChmdW5jdGlvbiAocGF0dGVybikge1xuICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IHBheWxvYWRTdHJfMS5tYXRjaChwYXR0ZXJuLnBhdHRlcm4pO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2EgPSBfX3JlYWQobWF0Y2gpLCBncm91cHMgPSBfYS5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3BhdGNoaW5nQ2Fwc3VsZSA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBjYXBzdWxlKSwgeyBwYXR0ZXJuSW5mbzogZ3JvdXBzIH0pO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybi5jYWxsYmFjayhkaXNwYXRjaGluZ0NhcHN1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEh1YkNsYXNzO1xufSgpKTtcbmV4cG9ydCB7IEh1YkNsYXNzIH07XG4vKldlIGV4cG9ydCBhIF9fZGVmYXVsdF9fIGluc3RhbmNlIG9mIEh1YkNsYXNzIHRvIHVzZSBpdCBhcyBhXG5wc2V1ZG8gU2luZ2xldG9uIGZvciB0aGUgbWFpbiBtZXNzYWdpbmcgYnVzLCBob3dldmVyIHlvdSBjYW4gc3RpbGwgY3JlYXRlXG55b3VyIG93biBpbnN0YW5jZSBvZiBIdWJDbGFzcygpIGZvciBhIHNlcGFyYXRlIFwicHJpdmF0ZSBidXNcIiBvZiBldmVudHMuKi9cbmV4cG9ydCB2YXIgSHViID0gbmV3IEh1YkNsYXNzKCdfX2RlZmF1bHRfXycpO1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IEh1Yjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUh1Yi5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Hub.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js":
/*!******************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/JS.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JS: () => (/* binding */ JS),\n/* harmony export */   browserOrNode: () => (/* binding */ browserOrNode),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   filenameToContentType: () => (/* binding */ filenameToContentType),\n/* harmony export */   generateRandomString: () => (/* binding */ generateRandomString),\n/* harmony export */   isEmpty: () => (/* binding */ isEmpty),\n/* harmony export */   isStrictObject: () => (/* binding */ isStrictObject),\n/* harmony export */   isTextFile: () => (/* binding */ isTextFile),\n/* harmony export */   isWebWorker: () => (/* binding */ isWebWorker),\n/* harmony export */   makeQuerablePromise: () => (/* binding */ makeQuerablePromise),\n/* harmony export */   objectLessAttributes: () => (/* binding */ objectLessAttributes),\n/* harmony export */   sortByField: () => (/* binding */ sortByField),\n/* harmony export */   transferKeyToLowerCase: () => (/* binding */ transferKeyToLowerCase),\n/* harmony export */   transferKeyToUpperCase: () => (/* binding */ transferKeyToUpperCase)\n/* harmony export */ });\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar MIME_MAP = [\n    { type: 'text/plain', ext: 'txt' },\n    { type: 'text/html', ext: 'html' },\n    { type: 'text/javascript', ext: 'js' },\n    { type: 'text/css', ext: 'css' },\n    { type: 'text/csv', ext: 'csv' },\n    { type: 'text/yaml', ext: 'yml' },\n    { type: 'text/yaml', ext: 'yaml' },\n    { type: 'text/calendar', ext: 'ics' },\n    { type: 'text/calendar', ext: 'ical' },\n    { type: 'image/apng', ext: 'apng' },\n    { type: 'image/bmp', ext: 'bmp' },\n    { type: 'image/gif', ext: 'gif' },\n    { type: 'image/x-icon', ext: 'ico' },\n    { type: 'image/x-icon', ext: 'cur' },\n    { type: 'image/jpeg', ext: 'jpg' },\n    { type: 'image/jpeg', ext: 'jpeg' },\n    { type: 'image/jpeg', ext: 'jfif' },\n    { type: 'image/jpeg', ext: 'pjp' },\n    { type: 'image/jpeg', ext: 'pjpeg' },\n    { type: 'image/png', ext: 'png' },\n    { type: 'image/svg+xml', ext: 'svg' },\n    { type: 'image/tiff', ext: 'tif' },\n    { type: 'image/tiff', ext: 'tiff' },\n    { type: 'image/webp', ext: 'webp' },\n    { type: 'application/json', ext: 'json' },\n    { type: 'application/xml', ext: 'xml' },\n    { type: 'application/x-sh', ext: 'sh' },\n    { type: 'application/zip', ext: 'zip' },\n    { type: 'application/x-rar-compressed', ext: 'rar' },\n    { type: 'application/x-tar', ext: 'tar' },\n    { type: 'application/x-bzip', ext: 'bz' },\n    { type: 'application/x-bzip2', ext: 'bz2' },\n    { type: 'application/pdf', ext: 'pdf' },\n    { type: 'application/java-archive', ext: 'jar' },\n    { type: 'application/msword', ext: 'doc' },\n    { type: 'application/vnd.ms-excel', ext: 'xls' },\n    { type: 'application/vnd.ms-excel', ext: 'xlsx' },\n    { type: 'message/rfc822', ext: 'eml' },\n];\nvar isEmpty = function (obj) {\n    if (obj === void 0) { obj = {}; }\n    return Object.keys(obj).length === 0;\n};\nvar sortByField = function (list, field, dir) {\n    if (!list || !list.sort) {\n        return false;\n    }\n    var dirX = dir && dir === 'desc' ? -1 : 1;\n    list.sort(function (a, b) {\n        var a_val = a[field];\n        var b_val = b[field];\n        if (typeof b_val === 'undefined') {\n            return typeof a_val === 'undefined' ? 0 : 1 * dirX;\n        }\n        if (typeof a_val === 'undefined') {\n            return -1 * dirX;\n        }\n        if (a_val < b_val) {\n            return -1 * dirX;\n        }\n        if (a_val > b_val) {\n            return 1 * dirX;\n        }\n        return 0;\n    });\n    return true;\n};\nvar objectLessAttributes = function (obj, less) {\n    var ret = Object.assign({}, obj);\n    if (less) {\n        if (typeof less === 'string') {\n            delete ret[less];\n        }\n        else {\n            less.forEach(function (attr) {\n                delete ret[attr];\n            });\n        }\n    }\n    return ret;\n};\nvar filenameToContentType = function (filename, defVal) {\n    if (defVal === void 0) { defVal = 'application/octet-stream'; }\n    var name = filename.toLowerCase();\n    var filtered = MIME_MAP.filter(function (mime) { return name.endsWith('.' + mime.ext); });\n    return filtered.length > 0 ? filtered[0].type : defVal;\n};\nvar isTextFile = function (contentType) {\n    var type = contentType.toLowerCase();\n    if (type.startsWith('text/')) {\n        return true;\n    }\n    return ('application/json' === type ||\n        'application/xml' === type ||\n        'application/sh' === type);\n};\nvar generateRandomString = function () {\n    var result = '';\n    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    for (var i = 32; i > 0; i -= 1) {\n        result += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return result;\n};\nvar makeQuerablePromise = function (promise) {\n    if (promise.isResolved)\n        return promise;\n    var isPending = true;\n    var isRejected = false;\n    var isFullfilled = false;\n    var result = promise.then(function (data) {\n        isFullfilled = true;\n        isPending = false;\n        return data;\n    }, function (e) {\n        isRejected = true;\n        isPending = false;\n        throw e;\n    });\n    result.isFullfilled = function () { return isFullfilled; };\n    result.isPending = function () { return isPending; };\n    result.isRejected = function () { return isRejected; };\n    return result;\n};\nvar isWebWorker = function () {\n    if (typeof self === 'undefined') {\n        return false;\n    }\n    var selfContext = self;\n    return typeof selfContext.WorkerGlobalScope !== 'undefined' &&\n        self instanceof selfContext.WorkerGlobalScope;\n};\nvar browserOrNode = function () {\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    var isNode = typeof process !== 'undefined' &&\n        process.versions != null &&\n        process.versions.node != null;\n    return {\n        isBrowser: isBrowser,\n        isNode: isNode,\n    };\n};\n/**\n * transfer the first letter of the keys to lowercase\n * @param {Object} obj - the object need to be transferred\n * @param {Array} whiteListForItself - whitelist itself from being transferred\n * @param {Array} whiteListForChildren - whitelist its children keys from being transferred\n */\nvar transferKeyToLowerCase = function (obj, whiteListForItself, whiteListForChildren) {\n    if (whiteListForItself === void 0) { whiteListForItself = []; }\n    if (whiteListForChildren === void 0) { whiteListForChildren = []; }\n    if (!isStrictObject(obj))\n        return obj;\n    var ret = {};\n    for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            var transferedKey = whiteListForItself.includes(key)\n                ? key\n                : key[0].toLowerCase() + key.slice(1);\n            ret[transferedKey] = whiteListForChildren.includes(key)\n                ? obj[key]\n                : transferKeyToLowerCase(obj[key], whiteListForItself, whiteListForChildren);\n        }\n    }\n    return ret;\n};\n/**\n * transfer the first letter of the keys to lowercase\n * @param {Object} obj - the object need to be transferred\n * @param {Array} whiteListForItself - whitelist itself from being transferred\n * @param {Array} whiteListForChildren - whitelist its children keys from being transferred\n */\nvar transferKeyToUpperCase = function (obj, whiteListForItself, whiteListForChildren) {\n    if (whiteListForItself === void 0) { whiteListForItself = []; }\n    if (whiteListForChildren === void 0) { whiteListForChildren = []; }\n    if (!isStrictObject(obj))\n        return obj;\n    var ret = {};\n    for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            var transferredKey = whiteListForItself.includes(key)\n                ? key\n                : key[0].toUpperCase() + key.slice(1);\n            ret[transferredKey] = whiteListForChildren.includes(key)\n                ? obj[key]\n                : transferKeyToUpperCase(obj[key], whiteListForItself, whiteListForChildren);\n        }\n    }\n    return ret;\n};\n/**\n * Return true if the object is a strict object\n * which means it's not Array, Function, Number, String, Boolean or Null\n * @param obj the Object\n */\nvar isStrictObject = function (obj) {\n    return (obj instanceof Object &&\n        !(obj instanceof Array) &&\n        !(obj instanceof Function) &&\n        !(obj instanceof Number) &&\n        !(obj instanceof String) &&\n        !(obj instanceof Boolean));\n};\n/**\n * @deprecated use per-function imports\n */\nvar JS = /** @class */ (function () {\n    function JS() {\n    }\n    JS.isEmpty = isEmpty;\n    JS.sortByField = sortByField;\n    JS.objectLessAttributes = objectLessAttributes;\n    JS.filenameToContentType = filenameToContentType;\n    JS.isTextFile = isTextFile;\n    JS.generateRandomString = generateRandomString;\n    JS.makeQuerablePromise = makeQuerablePromise;\n    JS.isWebWorker = isWebWorker;\n    JS.browserOrNode = browserOrNode;\n    JS.transferKeyToLowerCase = transferKeyToLowerCase;\n    JS.transferKeyToUpperCase = transferKeyToUpperCase;\n    JS.isStrictObject = isStrictObject;\n    return JS;\n}());\n\n/**\n * @deprecated use per-function imports\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (JS);\n//# sourceMappingURL=JS.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9KUy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxvQ0FBb0M7QUFDMUMsTUFBTSw4QkFBOEI7QUFDcEMsTUFBTSw4QkFBOEI7QUFDcEMsTUFBTSwrQkFBK0I7QUFDckMsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxtQ0FBbUM7QUFDekMsTUFBTSxvQ0FBb0M7QUFDMUMsTUFBTSxpQ0FBaUM7QUFDdkMsTUFBTSwrQkFBK0I7QUFDckMsTUFBTSwrQkFBK0I7QUFDckMsTUFBTSxrQ0FBa0M7QUFDeEMsTUFBTSxrQ0FBa0M7QUFDeEMsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxpQ0FBaUM7QUFDdkMsTUFBTSxpQ0FBaUM7QUFDdkMsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxrQ0FBa0M7QUFDeEMsTUFBTSwrQkFBK0I7QUFDckMsTUFBTSxtQ0FBbUM7QUFDekMsTUFBTSxnQ0FBZ0M7QUFDdEMsTUFBTSxpQ0FBaUM7QUFDdkMsTUFBTSxpQ0FBaUM7QUFDdkMsTUFBTSx1Q0FBdUM7QUFDN0MsTUFBTSxxQ0FBcUM7QUFDM0MsTUFBTSxxQ0FBcUM7QUFDM0MsTUFBTSxxQ0FBcUM7QUFDM0MsTUFBTSxrREFBa0Q7QUFDeEQsTUFBTSx1Q0FBdUM7QUFDN0MsTUFBTSx1Q0FBdUM7QUFDN0MsTUFBTSx5Q0FBeUM7QUFDL0MsTUFBTSxxQ0FBcUM7QUFDM0MsTUFBTSw4Q0FBOEM7QUFDcEQsTUFBTSx3Q0FBd0M7QUFDOUMsTUFBTSw4Q0FBOEM7QUFDcEQsTUFBTSwrQ0FBK0M7QUFDckQsTUFBTSxvQ0FBb0M7QUFDMUM7QUFDTztBQUNQLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDTztBQUNQLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsNkJBQTZCO0FBQzdCO0FBQ0EscURBQXFELHVDQUF1QztBQUM1RjtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EscUJBQXFCLE9BQU87QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsd0NBQXdDO0FBQ3hDLHFDQUFxQztBQUNyQyxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQjtBQUNPO0FBQ1AseUNBQXlDO0FBQ3pDLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEI7QUFDTztBQUNQLHlDQUF5QztBQUN6QywyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDYTtBQUNkO0FBQ0E7QUFDQTtBQUNBLGlFQUFlLEVBQUUsRUFBQztBQUNsQiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9KUy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTctMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xudmFyIE1JTUVfTUFQID0gW1xuICAgIHsgdHlwZTogJ3RleHQvcGxhaW4nLCBleHQ6ICd0eHQnIH0sXG4gICAgeyB0eXBlOiAndGV4dC9odG1sJywgZXh0OiAnaHRtbCcgfSxcbiAgICB7IHR5cGU6ICd0ZXh0L2phdmFzY3JpcHQnLCBleHQ6ICdqcycgfSxcbiAgICB7IHR5cGU6ICd0ZXh0L2NzcycsIGV4dDogJ2NzcycgfSxcbiAgICB7IHR5cGU6ICd0ZXh0L2NzdicsIGV4dDogJ2NzdicgfSxcbiAgICB7IHR5cGU6ICd0ZXh0L3lhbWwnLCBleHQ6ICd5bWwnIH0sXG4gICAgeyB0eXBlOiAndGV4dC95YW1sJywgZXh0OiAneWFtbCcgfSxcbiAgICB7IHR5cGU6ICd0ZXh0L2NhbGVuZGFyJywgZXh0OiAnaWNzJyB9LFxuICAgIHsgdHlwZTogJ3RleHQvY2FsZW5kYXInLCBleHQ6ICdpY2FsJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL2FwbmcnLCBleHQ6ICdhcG5nJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL2JtcCcsIGV4dDogJ2JtcCcgfSxcbiAgICB7IHR5cGU6ICdpbWFnZS9naWYnLCBleHQ6ICdnaWYnIH0sXG4gICAgeyB0eXBlOiAnaW1hZ2UveC1pY29uJywgZXh0OiAnaWNvJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL3gtaWNvbicsIGV4dDogJ2N1cicgfSxcbiAgICB7IHR5cGU6ICdpbWFnZS9qcGVnJywgZXh0OiAnanBnJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL2pwZWcnLCBleHQ6ICdqcGVnJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL2pwZWcnLCBleHQ6ICdqZmlmJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL2pwZWcnLCBleHQ6ICdwanAnIH0sXG4gICAgeyB0eXBlOiAnaW1hZ2UvanBlZycsIGV4dDogJ3BqcGVnJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL3BuZycsIGV4dDogJ3BuZycgfSxcbiAgICB7IHR5cGU6ICdpbWFnZS9zdmcreG1sJywgZXh0OiAnc3ZnJyB9LFxuICAgIHsgdHlwZTogJ2ltYWdlL3RpZmYnLCBleHQ6ICd0aWYnIH0sXG4gICAgeyB0eXBlOiAnaW1hZ2UvdGlmZicsIGV4dDogJ3RpZmYnIH0sXG4gICAgeyB0eXBlOiAnaW1hZ2Uvd2VicCcsIGV4dDogJ3dlYnAnIH0sXG4gICAgeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicsIGV4dDogJ2pzb24nIH0sXG4gICAgeyB0eXBlOiAnYXBwbGljYXRpb24veG1sJywgZXh0OiAneG1sJyB9LFxuICAgIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3gtc2gnLCBleHQ6ICdzaCcgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi96aXAnLCBleHQ6ICd6aXAnIH0sXG4gICAgeyB0eXBlOiAnYXBwbGljYXRpb24veC1yYXItY29tcHJlc3NlZCcsIGV4dDogJ3JhcicgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi94LXRhcicsIGV4dDogJ3RhcicgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi94LWJ6aXAnLCBleHQ6ICdieicgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi94LWJ6aXAyJywgZXh0OiAnYnoyJyB9LFxuICAgIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3BkZicsIGV4dDogJ3BkZicgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qYXZhLWFyY2hpdmUnLCBleHQ6ICdqYXInIH0sXG4gICAgeyB0eXBlOiAnYXBwbGljYXRpb24vbXN3b3JkJywgZXh0OiAnZG9jJyB9LFxuICAgIHsgdHlwZTogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsIGV4dDogJ3hscycgfSxcbiAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLCBleHQ6ICd4bHN4JyB9LFxuICAgIHsgdHlwZTogJ21lc3NhZ2UvcmZjODIyJywgZXh0OiAnZW1sJyB9LFxuXTtcbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICBpZiAob2JqID09PSB2b2lkIDApIHsgb2JqID0ge307IH1cbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7XG59O1xuZXhwb3J0IHZhciBzb3J0QnlGaWVsZCA9IGZ1bmN0aW9uIChsaXN0LCBmaWVsZCwgZGlyKSB7XG4gICAgaWYgKCFsaXN0IHx8ICFsaXN0LnNvcnQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgZGlyWCA9IGRpciAmJiBkaXIgPT09ICdkZXNjJyA/IC0xIDogMTtcbiAgICBsaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFfdmFsID0gYVtmaWVsZF07XG4gICAgICAgIHZhciBiX3ZhbCA9IGJbZmllbGRdO1xuICAgICAgICBpZiAodHlwZW9mIGJfdmFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhX3ZhbCA9PT0gJ3VuZGVmaW5lZCcgPyAwIDogMSAqIGRpclg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBhX3ZhbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiAtMSAqIGRpclg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFfdmFsIDwgYl92YWwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMSAqIGRpclg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFfdmFsID4gYl92YWwpIHtcbiAgICAgICAgICAgIHJldHVybiAxICogZGlyWDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5leHBvcnQgdmFyIG9iamVjdExlc3NBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKG9iaiwgbGVzcykge1xuICAgIHZhciByZXQgPSBPYmplY3QuYXNzaWduKHt9LCBvYmopO1xuICAgIGlmIChsZXNzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbGVzcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGRlbGV0ZSByZXRbbGVzc107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXNzLmZvckVhY2goZnVuY3Rpb24gKGF0dHIpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgcmV0W2F0dHJdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5leHBvcnQgdmFyIGZpbGVuYW1lVG9Db250ZW50VHlwZSA9IGZ1bmN0aW9uIChmaWxlbmFtZSwgZGVmVmFsKSB7XG4gICAgaWYgKGRlZlZhbCA9PT0gdm9pZCAwKSB7IGRlZlZhbCA9ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOyB9XG4gICAgdmFyIG5hbWUgPSBmaWxlbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBmaWx0ZXJlZCA9IE1JTUVfTUFQLmZpbHRlcihmdW5jdGlvbiAobWltZSkgeyByZXR1cm4gbmFtZS5lbmRzV2l0aCgnLicgKyBtaW1lLmV4dCk7IH0pO1xuICAgIHJldHVybiBmaWx0ZXJlZC5sZW5ndGggPiAwID8gZmlsdGVyZWRbMF0udHlwZSA6IGRlZlZhbDtcbn07XG5leHBvcnQgdmFyIGlzVGV4dEZpbGUgPSBmdW5jdGlvbiAoY29udGVudFR5cGUpIHtcbiAgICB2YXIgdHlwZSA9IGNvbnRlbnRUeXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKHR5cGUuc3RhcnRzV2l0aCgndGV4dC8nKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuICgnYXBwbGljYXRpb24vanNvbicgPT09IHR5cGUgfHxcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3htbCcgPT09IHR5cGUgfHxcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3NoJyA9PT0gdHlwZSk7XG59O1xuZXhwb3J0IHZhciBnZW5lcmF0ZVJhbmRvbVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgdmFyIGNoYXJzID0gJzAxMjM0NTY3ODlhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJztcbiAgICBmb3IgKHZhciBpID0gMzI7IGkgPiAwOyBpIC09IDEpIHtcbiAgICAgICAgcmVzdWx0ICs9IGNoYXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzLmxlbmd0aCldO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbmV4cG9ydCB2YXIgbWFrZVF1ZXJhYmxlUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgaWYgKHByb21pc2UuaXNSZXNvbHZlZClcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgdmFyIGlzUGVuZGluZyA9IHRydWU7XG4gICAgdmFyIGlzUmVqZWN0ZWQgPSBmYWxzZTtcbiAgICB2YXIgaXNGdWxsZmlsbGVkID0gZmFsc2U7XG4gICAgdmFyIHJlc3VsdCA9IHByb21pc2UudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpc0Z1bGxmaWxsZWQgPSB0cnVlO1xuICAgICAgICBpc1BlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaXNSZWplY3RlZCA9IHRydWU7XG4gICAgICAgIGlzUGVuZGluZyA9IGZhbHNlO1xuICAgICAgICB0aHJvdyBlO1xuICAgIH0pO1xuICAgIHJlc3VsdC5pc0Z1bGxmaWxsZWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBpc0Z1bGxmaWxsZWQ7IH07XG4gICAgcmVzdWx0LmlzUGVuZGluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGlzUGVuZGluZzsgfTtcbiAgICByZXN1bHQuaXNSZWplY3RlZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGlzUmVqZWN0ZWQ7IH07XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5leHBvcnQgdmFyIGlzV2ViV29ya2VyID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh0eXBlb2Ygc2VsZiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgc2VsZkNvbnRleHQgPSBzZWxmO1xuICAgIHJldHVybiB0eXBlb2Ygc2VsZkNvbnRleHQuV29ya2VyR2xvYmFsU2NvcGUgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIHNlbGYgaW5zdGFuY2VvZiBzZWxmQ29udGV4dC5Xb3JrZXJHbG9iYWxTY29wZTtcbn07XG5leHBvcnQgdmFyIGJyb3dzZXJPck5vZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGlzQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiB3aW5kb3cuZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnO1xuICAgIHZhciBpc05vZGUgPSB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgcHJvY2Vzcy52ZXJzaW9ucyAhPSBudWxsICYmXG4gICAgICAgIHByb2Nlc3MudmVyc2lvbnMubm9kZSAhPSBudWxsO1xuICAgIHJldHVybiB7XG4gICAgICAgIGlzQnJvd3NlcjogaXNCcm93c2VyLFxuICAgICAgICBpc05vZGU6IGlzTm9kZSxcbiAgICB9O1xufTtcbi8qKlxuICogdHJhbnNmZXIgdGhlIGZpcnN0IGxldHRlciBvZiB0aGUga2V5cyB0byBsb3dlcmNhc2VcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmogLSB0aGUgb2JqZWN0IG5lZWQgdG8gYmUgdHJhbnNmZXJyZWRcbiAqIEBwYXJhbSB7QXJyYXl9IHdoaXRlTGlzdEZvckl0c2VsZiAtIHdoaXRlbGlzdCBpdHNlbGYgZnJvbSBiZWluZyB0cmFuc2ZlcnJlZFxuICogQHBhcmFtIHtBcnJheX0gd2hpdGVMaXN0Rm9yQ2hpbGRyZW4gLSB3aGl0ZWxpc3QgaXRzIGNoaWxkcmVuIGtleXMgZnJvbSBiZWluZyB0cmFuc2ZlcnJlZFxuICovXG5leHBvcnQgdmFyIHRyYW5zZmVyS2V5VG9Mb3dlckNhc2UgPSBmdW5jdGlvbiAob2JqLCB3aGl0ZUxpc3RGb3JJdHNlbGYsIHdoaXRlTGlzdEZvckNoaWxkcmVuKSB7XG4gICAgaWYgKHdoaXRlTGlzdEZvckl0c2VsZiA9PT0gdm9pZCAwKSB7IHdoaXRlTGlzdEZvckl0c2VsZiA9IFtdOyB9XG4gICAgaWYgKHdoaXRlTGlzdEZvckNoaWxkcmVuID09PSB2b2lkIDApIHsgd2hpdGVMaXN0Rm9yQ2hpbGRyZW4gPSBbXTsgfVxuICAgIGlmICghaXNTdHJpY3RPYmplY3Qob2JqKSlcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB2YXIgcmV0ID0ge307XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc2ZlcmVkS2V5ID0gd2hpdGVMaXN0Rm9ySXRzZWxmLmluY2x1ZGVzKGtleSlcbiAgICAgICAgICAgICAgICA/IGtleVxuICAgICAgICAgICAgICAgIDoga2V5WzBdLnRvTG93ZXJDYXNlKCkgKyBrZXkuc2xpY2UoMSk7XG4gICAgICAgICAgICByZXRbdHJhbnNmZXJlZEtleV0gPSB3aGl0ZUxpc3RGb3JDaGlsZHJlbi5pbmNsdWRlcyhrZXkpXG4gICAgICAgICAgICAgICAgPyBvYmpba2V5XVxuICAgICAgICAgICAgICAgIDogdHJhbnNmZXJLZXlUb0xvd2VyQ2FzZShvYmpba2V5XSwgd2hpdGVMaXN0Rm9ySXRzZWxmLCB3aGl0ZUxpc3RGb3JDaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG4vKipcbiAqIHRyYW5zZmVyIHRoZSBmaXJzdCBsZXR0ZXIgb2YgdGhlIGtleXMgdG8gbG93ZXJjYXNlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gdGhlIG9iamVjdCBuZWVkIHRvIGJlIHRyYW5zZmVycmVkXG4gKiBAcGFyYW0ge0FycmF5fSB3aGl0ZUxpc3RGb3JJdHNlbGYgLSB3aGl0ZWxpc3QgaXRzZWxmIGZyb20gYmVpbmcgdHJhbnNmZXJyZWRcbiAqIEBwYXJhbSB7QXJyYXl9IHdoaXRlTGlzdEZvckNoaWxkcmVuIC0gd2hpdGVsaXN0IGl0cyBjaGlsZHJlbiBrZXlzIGZyb20gYmVpbmcgdHJhbnNmZXJyZWRcbiAqL1xuZXhwb3J0IHZhciB0cmFuc2ZlcktleVRvVXBwZXJDYXNlID0gZnVuY3Rpb24gKG9iaiwgd2hpdGVMaXN0Rm9ySXRzZWxmLCB3aGl0ZUxpc3RGb3JDaGlsZHJlbikge1xuICAgIGlmICh3aGl0ZUxpc3RGb3JJdHNlbGYgPT09IHZvaWQgMCkgeyB3aGl0ZUxpc3RGb3JJdHNlbGYgPSBbXTsgfVxuICAgIGlmICh3aGl0ZUxpc3RGb3JDaGlsZHJlbiA9PT0gdm9pZCAwKSB7IHdoaXRlTGlzdEZvckNoaWxkcmVuID0gW107IH1cbiAgICBpZiAoIWlzU3RyaWN0T2JqZWN0KG9iaikpXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgdmFyIHJldCA9IHt9O1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNmZXJyZWRLZXkgPSB3aGl0ZUxpc3RGb3JJdHNlbGYuaW5jbHVkZXMoa2V5KVxuICAgICAgICAgICAgICAgID8ga2V5XG4gICAgICAgICAgICAgICAgOiBrZXlbMF0udG9VcHBlckNhc2UoKSArIGtleS5zbGljZSgxKTtcbiAgICAgICAgICAgIHJldFt0cmFuc2ZlcnJlZEtleV0gPSB3aGl0ZUxpc3RGb3JDaGlsZHJlbi5pbmNsdWRlcyhrZXkpXG4gICAgICAgICAgICAgICAgPyBvYmpba2V5XVxuICAgICAgICAgICAgICAgIDogdHJhbnNmZXJLZXlUb1VwcGVyQ2FzZShvYmpba2V5XSwgd2hpdGVMaXN0Rm9ySXRzZWxmLCB3aGl0ZUxpc3RGb3JDaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBvYmplY3QgaXMgYSBzdHJpY3Qgb2JqZWN0XG4gKiB3aGljaCBtZWFucyBpdCdzIG5vdCBBcnJheSwgRnVuY3Rpb24sIE51bWJlciwgU3RyaW5nLCBCb29sZWFuIG9yIE51bGxcbiAqIEBwYXJhbSBvYmogdGhlIE9iamVjdFxuICovXG5leHBvcnQgdmFyIGlzU3RyaWN0T2JqZWN0ID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiAob2JqIGluc3RhbmNlb2YgT2JqZWN0ICYmXG4gICAgICAgICEob2JqIGluc3RhbmNlb2YgQXJyYXkpICYmXG4gICAgICAgICEob2JqIGluc3RhbmNlb2YgRnVuY3Rpb24pICYmXG4gICAgICAgICEob2JqIGluc3RhbmNlb2YgTnVtYmVyKSAmJlxuICAgICAgICAhKG9iaiBpbnN0YW5jZW9mIFN0cmluZykgJiZcbiAgICAgICAgIShvYmogaW5zdGFuY2VvZiBCb29sZWFuKSk7XG59O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgcGVyLWZ1bmN0aW9uIGltcG9ydHNcbiAqL1xudmFyIEpTID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEpTKCkge1xuICAgIH1cbiAgICBKUy5pc0VtcHR5ID0gaXNFbXB0eTtcbiAgICBKUy5zb3J0QnlGaWVsZCA9IHNvcnRCeUZpZWxkO1xuICAgIEpTLm9iamVjdExlc3NBdHRyaWJ1dGVzID0gb2JqZWN0TGVzc0F0dHJpYnV0ZXM7XG4gICAgSlMuZmlsZW5hbWVUb0NvbnRlbnRUeXBlID0gZmlsZW5hbWVUb0NvbnRlbnRUeXBlO1xuICAgIEpTLmlzVGV4dEZpbGUgPSBpc1RleHRGaWxlO1xuICAgIEpTLmdlbmVyYXRlUmFuZG9tU3RyaW5nID0gZ2VuZXJhdGVSYW5kb21TdHJpbmc7XG4gICAgSlMubWFrZVF1ZXJhYmxlUHJvbWlzZSA9IG1ha2VRdWVyYWJsZVByb21pc2U7XG4gICAgSlMuaXNXZWJXb3JrZXIgPSBpc1dlYldvcmtlcjtcbiAgICBKUy5icm93c2VyT3JOb2RlID0gYnJvd3Nlck9yTm9kZTtcbiAgICBKUy50cmFuc2ZlcktleVRvTG93ZXJDYXNlID0gdHJhbnNmZXJLZXlUb0xvd2VyQ2FzZTtcbiAgICBKUy50cmFuc2ZlcktleVRvVXBwZXJDYXNlID0gdHJhbnNmZXJLZXlUb1VwcGVyQ2FzZTtcbiAgICBKUy5pc1N0cmljdE9iamVjdCA9IGlzU3RyaWN0T2JqZWN0O1xuICAgIHJldHVybiBKUztcbn0oKSk7XG5leHBvcnQgeyBKUyB9O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgcGVyLWZ1bmN0aW9uIGltcG9ydHNcbiAqL1xuZXhwb3J0IGRlZmF1bHQgSlM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1KUy5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js":
/*!************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConsoleLogger: () => (/* binding */ ConsoleLogger),\n/* harmony export */   LOG_TYPE: () => (/* binding */ LOG_TYPE)\n/* harmony export */ });\n/* harmony import */ var _Util_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Util/Constants */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js\");\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __values = (undefined && undefined.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (undefined && undefined.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\n\nvar LOG_LEVELS = {\n    VERBOSE: 1,\n    DEBUG: 2,\n    INFO: 3,\n    WARN: 4,\n    ERROR: 5,\n};\nvar LOG_TYPE;\n(function (LOG_TYPE) {\n    LOG_TYPE[\"DEBUG\"] = \"DEBUG\";\n    LOG_TYPE[\"ERROR\"] = \"ERROR\";\n    LOG_TYPE[\"INFO\"] = \"INFO\";\n    LOG_TYPE[\"WARN\"] = \"WARN\";\n    LOG_TYPE[\"VERBOSE\"] = \"VERBOSE\";\n})(LOG_TYPE || (LOG_TYPE = {}));\n/**\n * Write logs\n * @class Logger\n */\nvar ConsoleLogger = /** @class */ (function () {\n    /**\n     * @constructor\n     * @param {string} name - Name of the logger\n     */\n    function ConsoleLogger(name, level) {\n        if (level === void 0) { level = LOG_TYPE.WARN; }\n        this.name = name;\n        this.level = level;\n        this._pluggables = [];\n    }\n    ConsoleLogger.prototype._padding = function (n) {\n        return n < 10 ? '0' + n : '' + n;\n    };\n    ConsoleLogger.prototype._ts = function () {\n        var dt = new Date();\n        return ([this._padding(dt.getMinutes()), this._padding(dt.getSeconds())].join(':') +\n            '.' +\n            dt.getMilliseconds());\n    };\n    ConsoleLogger.prototype.configure = function (config) {\n        if (!config)\n            return this._config;\n        this._config = config;\n        return this._config;\n    };\n    /**\n     * Write log\n     * @method\n     * @memeberof Logger\n     * @param {LOG_TYPE|string} type - log type, default INFO\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype._log = function (type) {\n        var e_1, _a;\n        var msg = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            msg[_i - 1] = arguments[_i];\n        }\n        var logger_level_name = this.level;\n        if (ConsoleLogger.LOG_LEVEL) {\n            logger_level_name = ConsoleLogger.LOG_LEVEL;\n        }\n        if (typeof window !== 'undefined' && window.LOG_LEVEL) {\n            logger_level_name = window.LOG_LEVEL;\n        }\n        var logger_level = LOG_LEVELS[logger_level_name];\n        var type_level = LOG_LEVELS[type];\n        if (!(type_level >= logger_level)) {\n            // Do nothing if type is not greater than or equal to logger level (handle undefined)\n            return;\n        }\n        var log = console.log.bind(console);\n        if (type === LOG_TYPE.ERROR && console.error) {\n            log = console.error.bind(console);\n        }\n        if (type === LOG_TYPE.WARN && console.warn) {\n            log = console.warn.bind(console);\n        }\n        var prefix = \"[\" + type + \"] \" + this._ts() + \" \" + this.name;\n        var message = '';\n        if (msg.length === 1 && typeof msg[0] === 'string') {\n            message = prefix + \" - \" + msg[0];\n            log(message);\n        }\n        else if (msg.length === 1) {\n            message = prefix + \" \" + msg[0];\n            log(prefix, msg[0]);\n        }\n        else if (typeof msg[0] === 'string') {\n            var obj = msg.slice(1);\n            if (obj.length === 1) {\n                obj = obj[0];\n            }\n            message = prefix + \" - \" + msg[0] + \" \" + obj;\n            log(prefix + \" - \" + msg[0], obj);\n        }\n        else {\n            message = prefix + \" \" + msg;\n            log(prefix, msg);\n        }\n        try {\n            for (var _b = __values(this._pluggables), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var plugin = _c.value;\n                var logEvent = { message: message, timestamp: Date.now() };\n                plugin.pushLogs([logEvent]);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    /**\n     * Write General log. Default to INFO\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.log = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.INFO], msg));\n    };\n    /**\n     * Write INFO log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.info = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.INFO], msg));\n    };\n    /**\n     * Write WARN log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.warn = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.WARN], msg));\n    };\n    /**\n     * Write ERROR log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.error = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.ERROR], msg));\n    };\n    /**\n     * Write DEBUG log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.debug = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.DEBUG], msg));\n    };\n    /**\n     * Write VERBOSE log\n     * @method\n     * @memeberof Logger\n     * @param {string|object} msg - Logging message or object\n     */\n    ConsoleLogger.prototype.verbose = function () {\n        var msg = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            msg[_i] = arguments[_i];\n        }\n        this._log.apply(this, __spread([LOG_TYPE.VERBOSE], msg));\n    };\n    ConsoleLogger.prototype.addPluggable = function (pluggable) {\n        if (pluggable && pluggable.getCategoryName() === _Util_Constants__WEBPACK_IMPORTED_MODULE_0__.AWS_CLOUDWATCH_CATEGORY) {\n            this._pluggables.push(pluggable);\n            pluggable.configure(this._config);\n        }\n    };\n    ConsoleLogger.prototype.listPluggables = function () {\n        return this._pluggables;\n    };\n    ConsoleLogger.LOG_LEVEL = null;\n    return ConsoleLogger;\n}());\n\n//# sourceMappingURL=ConsoleLogger.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9Mb2dnZXIvQ29uc29sZUxvZ2dlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBSSxJQUFJLFNBQUk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsU0FBSSxJQUFJLFNBQUk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFNBQUksSUFBSSxTQUFJO0FBQzVCLDZCQUE2QixzQkFBc0I7QUFDbkQ7QUFDQTtBQUM0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0QkFBNEI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxpQkFBaUI7QUFDaEMsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsVUFBVTtBQUNoRjtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGVBQWU7QUFDOUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGVBQWU7QUFDOUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsb0VBQXVCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDd0I7QUFDekIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vTG9nZ2VyL0NvbnNvbGVMb2dnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDE3LTIwMTkgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGhcbiAqIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wL1xuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUlxuICogQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbnZhciBfX3NwcmVhZCA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWQpIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xuICAgIHJldHVybiBhcjtcbn07XG5pbXBvcnQgeyBBV1NfQ0xPVURXQVRDSF9DQVRFR09SWSB9IGZyb20gJy4uL1V0aWwvQ29uc3RhbnRzJztcbnZhciBMT0dfTEVWRUxTID0ge1xuICAgIFZFUkJPU0U6IDEsXG4gICAgREVCVUc6IDIsXG4gICAgSU5GTzogMyxcbiAgICBXQVJOOiA0LFxuICAgIEVSUk9SOiA1LFxufTtcbmV4cG9ydCB2YXIgTE9HX1RZUEU7XG4oZnVuY3Rpb24gKExPR19UWVBFKSB7XG4gICAgTE9HX1RZUEVbXCJERUJVR1wiXSA9IFwiREVCVUdcIjtcbiAgICBMT0dfVFlQRVtcIkVSUk9SXCJdID0gXCJFUlJPUlwiO1xuICAgIExPR19UWVBFW1wiSU5GT1wiXSA9IFwiSU5GT1wiO1xuICAgIExPR19UWVBFW1wiV0FSTlwiXSA9IFwiV0FSTlwiO1xuICAgIExPR19UWVBFW1wiVkVSQk9TRVwiXSA9IFwiVkVSQk9TRVwiO1xufSkoTE9HX1RZUEUgfHwgKExPR19UWVBFID0ge30pKTtcbi8qKlxuICogV3JpdGUgbG9nc1xuICogQGNsYXNzIExvZ2dlclxuICovXG52YXIgQ29uc29sZUxvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIE5hbWUgb2YgdGhlIGxvZ2dlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENvbnNvbGVMb2dnZXIobmFtZSwgbGV2ZWwpIHtcbiAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBMT0dfVFlQRS5XQVJOOyB9XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgdGhpcy5fcGx1Z2dhYmxlcyA9IFtdO1xuICAgIH1cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5fcGFkZGluZyA9IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHJldHVybiBuIDwgMTAgPyAnMCcgKyBuIDogJycgKyBuO1xuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUuX3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZHQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXR1cm4gKFt0aGlzLl9wYWRkaW5nKGR0LmdldE1pbnV0ZXMoKSksIHRoaXMuX3BhZGRpbmcoZHQuZ2V0U2Vjb25kcygpKV0uam9pbignOicpICtcbiAgICAgICAgICAgICcuJyArXG4gICAgICAgICAgICBkdC5nZXRNaWxsaXNlY29uZHMoKSk7XG4gICAgfTtcbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5jb25maWd1cmUgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIGlmICghY29uZmlnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgbG9nXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1lYmVyb2YgTG9nZ2VyXG4gICAgICogQHBhcmFtIHtMT0dfVFlQRXxzdHJpbmd9IHR5cGUgLSBsb2cgdHlwZSwgZGVmYXVsdCBJTkZPXG4gICAgICogQHBhcmFtIHtzdHJpbmd8b2JqZWN0fSBtc2cgLSBMb2dnaW5nIG1lc3NhZ2Ugb3Igb2JqZWN0XG4gICAgICovXG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUuX2xvZyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHZhciBlXzEsIF9hO1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvZ2dlcl9sZXZlbF9uYW1lID0gdGhpcy5sZXZlbDtcbiAgICAgICAgaWYgKENvbnNvbGVMb2dnZXIuTE9HX0xFVkVMKSB7XG4gICAgICAgICAgICBsb2dnZXJfbGV2ZWxfbmFtZSA9IENvbnNvbGVMb2dnZXIuTE9HX0xFVkVMO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTE9HX0xFVkVMKSB7XG4gICAgICAgICAgICBsb2dnZXJfbGV2ZWxfbmFtZSA9IHdpbmRvdy5MT0dfTEVWRUw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvZ2dlcl9sZXZlbCA9IExPR19MRVZFTFNbbG9nZ2VyX2xldmVsX25hbWVdO1xuICAgICAgICB2YXIgdHlwZV9sZXZlbCA9IExPR19MRVZFTFNbdHlwZV07XG4gICAgICAgIGlmICghKHR5cGVfbGV2ZWwgPj0gbG9nZ2VyX2xldmVsKSkge1xuICAgICAgICAgICAgLy8gRG8gbm90aGluZyBpZiB0eXBlIGlzIG5vdCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gbG9nZ2VyIGxldmVsIChoYW5kbGUgdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsb2cgPSBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpO1xuICAgICAgICBpZiAodHlwZSA9PT0gTE9HX1RZUEUuRVJST1IgJiYgY29uc29sZS5lcnJvcikge1xuICAgICAgICAgICAgbG9nID0gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBMT0dfVFlQRS5XQVJOICYmIGNvbnNvbGUud2Fybikge1xuICAgICAgICAgICAgbG9nID0gY29uc29sZS53YXJuLmJpbmQoY29uc29sZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWZpeCA9IFwiW1wiICsgdHlwZSArIFwiXSBcIiArIHRoaXMuX3RzKCkgKyBcIiBcIiArIHRoaXMubmFtZTtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSAnJztcbiAgICAgICAgaWYgKG1zZy5sZW5ndGggPT09IDEgJiYgdHlwZW9mIG1zZ1swXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiAtIFwiICsgbXNnWzBdO1xuICAgICAgICAgICAgbG9nKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1zZy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiBcIiArIG1zZ1swXTtcbiAgICAgICAgICAgIGxvZyhwcmVmaXgsIG1zZ1swXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG1zZ1swXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSBtc2cuc2xpY2UoMSk7XG4gICAgICAgICAgICBpZiAob2JqLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIG9iaiA9IG9ialswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiAtIFwiICsgbXNnWzBdICsgXCIgXCIgKyBvYmo7XG4gICAgICAgICAgICBsb2cocHJlZml4ICsgXCIgLSBcIiArIG1zZ1swXSwgb2JqKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBwcmVmaXggKyBcIiBcIiArIG1zZztcbiAgICAgICAgICAgIGxvZyhwcmVmaXgsIG1zZyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXModGhpcy5fcGx1Z2dhYmxlcyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luID0gX2MudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGxvZ0V2ZW50ID0geyBtZXNzYWdlOiBtZXNzYWdlLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfTtcbiAgICAgICAgICAgICAgICBwbHVnaW4ucHVzaExvZ3MoW2xvZ0V2ZW50XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgR2VuZXJhbCBsb2cuIERlZmF1bHQgdG8gSU5GT1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1zZyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgbXNnW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbG9nLmFwcGx5KHRoaXMsIF9fc3ByZWFkKFtMT0dfVFlQRS5JTkZPXSwgbXNnKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXcml0ZSBJTkZPIGxvZ1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBtc2cgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIG1zZ1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvZy5hcHBseSh0aGlzLCBfX3NwcmVhZChbTE9HX1RZUEUuSU5GT10sIG1zZykpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgV0FSTiBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLldBUk5dLCBtc2cpKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFdyaXRlIEVSUk9SIGxvZ1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtZWJlcm9mIExvZ2dlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gbXNnIC0gTG9nZ2luZyBtZXNzYWdlIG9yIG9iamVjdFxuICAgICAqL1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLkVSUk9SXSwgbXNnKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXcml0ZSBERUJVRyBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1zZyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgbXNnW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbG9nLmFwcGx5KHRoaXMsIF9fc3ByZWFkKFtMT0dfVFlQRS5ERUJVR10sIG1zZykpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogV3JpdGUgVkVSQk9TRSBsb2dcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWViZXJvZiBMb2dnZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IG1zZyAtIExvZ2dpbmcgbWVzc2FnZSBvciBvYmplY3RcbiAgICAgKi9cbiAgICBDb25zb2xlTG9nZ2VyLnByb3RvdHlwZS52ZXJib3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbXNnID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBtc2dbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2cuYXBwbHkodGhpcywgX19zcHJlYWQoW0xPR19UWVBFLlZFUkJPU0VdLCBtc2cpKTtcbiAgICB9O1xuICAgIENvbnNvbGVMb2dnZXIucHJvdG90eXBlLmFkZFBsdWdnYWJsZSA9IGZ1bmN0aW9uIChwbHVnZ2FibGUpIHtcbiAgICAgICAgaWYgKHBsdWdnYWJsZSAmJiBwbHVnZ2FibGUuZ2V0Q2F0ZWdvcnlOYW1lKCkgPT09IEFXU19DTE9VRFdBVENIX0NBVEVHT1JZKSB7XG4gICAgICAgICAgICB0aGlzLl9wbHVnZ2FibGVzLnB1c2gocGx1Z2dhYmxlKTtcbiAgICAgICAgICAgIHBsdWdnYWJsZS5jb25maWd1cmUodGhpcy5fY29uZmlnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5wcm90b3R5cGUubGlzdFBsdWdnYWJsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wbHVnZ2FibGVzO1xuICAgIH07XG4gICAgQ29uc29sZUxvZ2dlci5MT0dfTEVWRUwgPSBudWxsO1xuICAgIHJldHVybiBDb25zb2xlTG9nZ2VyO1xufSgpKTtcbmV4cG9ydCB7IENvbnNvbGVMb2dnZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnNvbGVMb2dnZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/FacebookOAuth.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/FacebookOAuth.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FacebookOAuth: () => (/* binding */ FacebookOAuth),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _JS__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../JS */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n/* harmony import */ var _Util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Util */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('CognitoCredentials');\nvar waitForInit = new Promise(function (res, rej) {\n    if (!(0,_JS__WEBPACK_IMPORTED_MODULE_1__.browserOrNode)().isBrowser) {\n        logger.debug('not in the browser, directly resolved');\n        return res();\n    }\n    var fb = window['FB'];\n    if (fb) {\n        logger.debug('FB SDK already loaded');\n        return res();\n    }\n    else {\n        setTimeout(function () {\n            return res();\n        }, 2000);\n    }\n});\nvar FacebookOAuth = /** @class */ (function () {\n    function FacebookOAuth() {\n        this.initialized = false;\n        this.refreshFacebookToken = this.refreshFacebookToken.bind(this);\n        this._refreshFacebookTokenImpl = this._refreshFacebookTokenImpl.bind(this);\n    }\n    FacebookOAuth.prototype.refreshFacebookToken = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!this.initialized) return [3 /*break*/, 2];\n                        logger.debug('need to wait for the Facebook SDK loaded');\n                        return [4 /*yield*/, waitForInit];\n                    case 1:\n                        _a.sent();\n                        this.initialized = true;\n                        logger.debug('finish waiting');\n                        _a.label = 2;\n                    case 2: return [2 /*return*/, this._refreshFacebookTokenImpl()];\n                }\n            });\n        });\n    };\n    FacebookOAuth.prototype._refreshFacebookTokenImpl = function () {\n        var fb = null;\n        if ((0,_JS__WEBPACK_IMPORTED_MODULE_1__.browserOrNode)().isBrowser)\n            fb = window['FB'];\n        if (!fb) {\n            var errorMessage = 'no fb sdk available';\n            logger.debug(errorMessage);\n            return Promise.reject(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError(errorMessage));\n        }\n        return new Promise(function (res, rej) {\n            fb.getLoginStatus(function (fbResponse) {\n                if (!fbResponse || !fbResponse.authResponse) {\n                    var errorMessage = 'no response from facebook when refreshing the jwt token';\n                    logger.debug(errorMessage);\n                    // There is no definitive indication for a network error in\n                    // fbResponse, so we are treating it as an invalid token.\n                    rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError(errorMessage));\n                }\n                else {\n                    var response = fbResponse.authResponse;\n                    var accessToken = response.accessToken, expiresIn = response.expiresIn;\n                    var date = new Date();\n                    var expires_at = expiresIn * 1000 + date.getTime();\n                    if (!accessToken) {\n                        var errorMessage = 'the jwtToken is undefined';\n                        logger.debug(errorMessage);\n                        rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError(errorMessage));\n                    }\n                    res({\n                        token: accessToken,\n                        expires_at: expires_at,\n                    });\n                }\n            }, { scope: 'public_profile,email' });\n        });\n    };\n    return FacebookOAuth;\n}());\n\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (FacebookOAuth);\n//# sourceMappingURL=FacebookOAuth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9PQXV0aEhlbHBlci9GYWNlYm9va09BdXRoLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsbUJBQW1CLFNBQUksSUFBSSxTQUFJO0FBQy9CLGNBQWMsNkJBQTZCLDBCQUEwQixjQUFjLHFCQUFxQjtBQUN4RyxpQkFBaUIsb0RBQW9ELHFFQUFxRSxjQUFjO0FBQ3hKLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLG1DQUFtQyxTQUFTO0FBQzVDLG1DQUFtQyxXQUFXLFVBQVU7QUFDeEQsMENBQTBDLGNBQWM7QUFDeEQ7QUFDQSw4R0FBOEcsT0FBTztBQUNySCxpRkFBaUYsaUJBQWlCO0FBQ2xHLHlEQUF5RCxnQkFBZ0IsUUFBUTtBQUNqRiwrQ0FBK0MsZ0JBQWdCLGdCQUFnQjtBQUMvRTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0EsVUFBVSxZQUFZLGFBQWEsU0FBUyxVQUFVO0FBQ3RELG9DQUFvQyxTQUFTO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDb0Q7QUFDZDtBQUNNO0FBQzVDLGlCQUFpQixrREFBTTtBQUN2QjtBQUNBLFNBQVMsa0RBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFlBQVksa0RBQWE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msb0RBQWlCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0RBQWlCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxvREFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxhQUFhLElBQUksK0JBQStCO0FBQ2hELFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUN3QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxhQUFhLEVBQUM7QUFDN0IiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vT0F1dGhIZWxwZXIvRmFjZWJvb2tPQXV0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xuLypcbiAqIENvcHlyaWdodCAyMDE3LTIwMTcgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLiBZb3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGhcbiAqIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YgdGhlIExpY2Vuc2UgaXMgbG9jYXRlZCBhdFxuICpcbiAqICAgICBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wL1xuICpcbiAqIG9yIGluIHRoZSBcImxpY2Vuc2VcIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUlxuICogQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXG4gKiBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IENvbnNvbGVMb2dnZXIgYXMgTG9nZ2VyIH0gZnJvbSAnLi4vTG9nZ2VyJztcbmltcG9ydCB7IGJyb3dzZXJPck5vZGUgfSBmcm9tICcuLi9KUyc7XG5pbXBvcnQgeyBOb25SZXRyeWFibGVFcnJvciB9IGZyb20gJy4uL1V0aWwnO1xudmFyIGxvZ2dlciA9IG5ldyBMb2dnZXIoJ0NvZ25pdG9DcmVkZW50aWFscycpO1xudmFyIHdhaXRGb3JJbml0ID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgaWYgKCFicm93c2VyT3JOb2RlKCkuaXNCcm93c2VyKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1Zygnbm90IGluIHRoZSBicm93c2VyLCBkaXJlY3RseSByZXNvbHZlZCcpO1xuICAgICAgICByZXR1cm4gcmVzKCk7XG4gICAgfVxuICAgIHZhciBmYiA9IHdpbmRvd1snRkInXTtcbiAgICBpZiAoZmIpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdGQiBTREsgYWxyZWFkeSBsb2FkZWQnKTtcbiAgICAgICAgcmV0dXJuIHJlcygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzKCk7XG4gICAgICAgIH0sIDIwMDApO1xuICAgIH1cbn0pO1xudmFyIEZhY2Vib29rT0F1dGggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmFjZWJvb2tPQXV0aCgpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlZnJlc2hGYWNlYm9va1Rva2VuID0gdGhpcy5yZWZyZXNoRmFjZWJvb2tUb2tlbi5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9yZWZyZXNoRmFjZWJvb2tUb2tlbkltcGwgPSB0aGlzLl9yZWZyZXNoRmFjZWJvb2tUb2tlbkltcGwuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgRmFjZWJvb2tPQXV0aC5wcm90b3R5cGUucmVmcmVzaEZhY2Vib29rVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMuaW5pdGlhbGl6ZWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCduZWVkIHRvIHdhaXQgZm9yIHRoZSBGYWNlYm9vayBTREsgbG9hZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB3YWl0Rm9ySW5pdF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdmaW5pc2ggd2FpdGluZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9yZWZyZXNoRmFjZWJvb2tUb2tlbkltcGwoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmFjZWJvb2tPQXV0aC5wcm90b3R5cGUuX3JlZnJlc2hGYWNlYm9va1Rva2VuSW1wbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZiID0gbnVsbDtcbiAgICAgICAgaWYgKGJyb3dzZXJPck5vZGUoKS5pc0Jyb3dzZXIpXG4gICAgICAgICAgICBmYiA9IHdpbmRvd1snRkInXTtcbiAgICAgICAgaWYgKCFmYikge1xuICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9ICdubyBmYiBzZGsgYXZhaWxhYmxlJztcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhlcnJvck1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBOb25SZXRyeWFibGVFcnJvcihlcnJvck1lc3NhZ2UpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICBmYi5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbiAoZmJSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGlmICghZmJSZXNwb25zZSB8fCAhZmJSZXNwb25zZS5hdXRoUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9ICdubyByZXNwb25zZSBmcm9tIGZhY2Vib29rIHdoZW4gcmVmcmVzaGluZyB0aGUgand0IHRva2VuJztcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGRlZmluaXRpdmUgaW5kaWNhdGlvbiBmb3IgYSBuZXR3b3JrIGVycm9yIGluXG4gICAgICAgICAgICAgICAgICAgIC8vIGZiUmVzcG9uc2UsIHNvIHdlIGFyZSB0cmVhdGluZyBpdCBhcyBhbiBpbnZhbGlkIHRva2VuLlxuICAgICAgICAgICAgICAgICAgICByZWoobmV3IE5vblJldHJ5YWJsZUVycm9yKGVycm9yTWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZmJSZXNwb25zZS5hdXRoUmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhY2Nlc3NUb2tlbiA9IHJlc3BvbnNlLmFjY2Vzc1Rva2VuLCBleHBpcmVzSW4gPSByZXNwb25zZS5leHBpcmVzSW47XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4cGlyZXNfYXQgPSBleHBpcmVzSW4gKiAxMDAwICsgZGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSAndGhlIGp3dFRva2VuIGlzIHVuZGVmaW5lZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlaihuZXcgTm9uUmV0cnlhYmxlRXJyb3IoZXJyb3JNZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuOiBhY2Nlc3NUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZXNfYXQ6IGV4cGlyZXNfYXQsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHsgc2NvcGU6ICdwdWJsaWNfcHJvZmlsZSxlbWFpbCcgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEZhY2Vib29rT0F1dGg7XG59KCkpO1xuZXhwb3J0IHsgRmFjZWJvb2tPQXV0aCB9O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IEZhY2Vib29rT0F1dGg7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1GYWNlYm9va09BdXRoLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/FacebookOAuth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/GoogleOAuth.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/GoogleOAuth.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GoogleOAuth: () => (/* binding */ GoogleOAuth),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\n/* harmony import */ var _JS__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../JS */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n/* harmony import */ var _Util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Util */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('CognitoCredentials');\nvar waitForInit = new Promise(function (res, rej) {\n    if (!(0,_JS__WEBPACK_IMPORTED_MODULE_1__.browserOrNode)().isBrowser) {\n        logger.debug('not in the browser, directly resolved');\n        return res();\n    }\n    var ga = window['gapi'] && window['gapi'].auth2 ? window['gapi'].auth2 : null;\n    if (ga) {\n        logger.debug('google api already loaded');\n        return res();\n    }\n    else {\n        setTimeout(function () {\n            return res();\n        }, 2000);\n    }\n});\nvar GoogleOAuth = /** @class */ (function () {\n    function GoogleOAuth() {\n        this.initialized = false;\n        this.refreshGoogleToken = this.refreshGoogleToken.bind(this);\n        this._refreshGoogleTokenImpl = this._refreshGoogleTokenImpl.bind(this);\n    }\n    GoogleOAuth.prototype.refreshGoogleToken = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!this.initialized) return [3 /*break*/, 2];\n                        logger.debug('need to wait for the Google SDK loaded');\n                        return [4 /*yield*/, waitForInit];\n                    case 1:\n                        _a.sent();\n                        this.initialized = true;\n                        logger.debug('finish waiting');\n                        _a.label = 2;\n                    case 2: return [2 /*return*/, this._refreshGoogleTokenImpl()];\n                }\n            });\n        });\n    };\n    GoogleOAuth.prototype._refreshGoogleTokenImpl = function () {\n        var ga = null;\n        if ((0,_JS__WEBPACK_IMPORTED_MODULE_1__.browserOrNode)().isBrowser)\n            ga = window['gapi'] && window['gapi'].auth2 ? window['gapi'].auth2 : null;\n        if (!ga) {\n            logger.debug('no gapi auth2 available');\n            return Promise.reject('no gapi auth2 available');\n        }\n        return new Promise(function (res, rej) {\n            ga.getAuthInstance()\n                .then(function (googleAuth) {\n                if (!googleAuth) {\n                    logger.debug('google Auth undefined');\n                    rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError('google Auth undefined'));\n                }\n                var googleUser = googleAuth.currentUser.get();\n                // refresh the token\n                if (googleUser.isSignedIn()) {\n                    logger.debug('refreshing the google access token');\n                    googleUser\n                        .reloadAuthResponse()\n                        .then(function (authResponse) {\n                        var id_token = authResponse.id_token, expires_at = authResponse.expires_at;\n                        res({ token: id_token, expires_at: expires_at });\n                    })\n                        .catch(function (err) {\n                        if (err && err.error === 'network_error') {\n                            // Not using NonRetryableError so handler will be retried\n                            rej('Network error reloading google auth response');\n                        }\n                        else {\n                            rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError('Failed to reload google auth response'));\n                        }\n                    });\n                }\n                else {\n                    rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError('User is not signed in with Google'));\n                }\n            })\n                .catch(function (err) {\n                logger.debug('Failed to refresh google token', err);\n                rej(new _Util__WEBPACK_IMPORTED_MODULE_2__.NonRetryableError('Failed to refresh google token'));\n            });\n        });\n    };\n    return GoogleOAuth;\n}());\n\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (GoogleOAuth);\n//# sourceMappingURL=GoogleOAuth.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9PQXV0aEhlbHBlci9Hb29nbGVPQXV0aC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3Qiw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBLG1CQUFtQixTQUFJLElBQUksU0FBSTtBQUMvQixjQUFjLDZCQUE2QiwwQkFBMEIsY0FBYyxxQkFBcUI7QUFDeEcsaUJBQWlCLG9EQUFvRCxxRUFBcUUsY0FBYztBQUN4Six1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QyxtQ0FBbUMsU0FBUztBQUM1QyxtQ0FBbUMsV0FBVyxVQUFVO0FBQ3hELDBDQUEwQyxjQUFjO0FBQ3hEO0FBQ0EsOEdBQThHLE9BQU87QUFDckgsaUZBQWlGLGlCQUFpQjtBQUNsRyx5REFBeUQsZ0JBQWdCLFFBQVE7QUFDakYsK0NBQStDLGdCQUFnQixnQkFBZ0I7QUFDL0U7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBLFVBQVUsWUFBWSxhQUFhLFNBQVMsVUFBVTtBQUN0RCxvQ0FBb0MsU0FBUztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ29EO0FBQ2Q7QUFDTTtBQUM1QyxpQkFBaUIsa0RBQU07QUFDdkI7QUFDQSxTQUFTLGtEQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtEQUFhO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLG9EQUFpQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIseUNBQXlDO0FBQ3ZFLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msb0RBQWlCO0FBQ3JEO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSw0QkFBNEIsb0RBQWlCO0FBQzdDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSx3QkFBd0Isb0RBQWlCO0FBQ3pDLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDc0I7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsV0FBVyxFQUFDO0FBQzNCIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL09BdXRoSGVscGVyL0dvb2dsZU9BdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG4vKlxuICogQ29weXJpZ2h0IDIwMTctMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgQ29uc29sZUxvZ2dlciBhcyBMb2dnZXIgfSBmcm9tICcuLi9Mb2dnZXInO1xuaW1wb3J0IHsgYnJvd3Nlck9yTm9kZSB9IGZyb20gJy4uL0pTJztcbmltcG9ydCB7IE5vblJldHJ5YWJsZUVycm9yIH0gZnJvbSAnLi4vVXRpbCc7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignQ29nbml0b0NyZWRlbnRpYWxzJyk7XG52YXIgd2FpdEZvckluaXQgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHtcbiAgICBpZiAoIWJyb3dzZXJPck5vZGUoKS5pc0Jyb3dzZXIpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdub3QgaW4gdGhlIGJyb3dzZXIsIGRpcmVjdGx5IHJlc29sdmVkJyk7XG4gICAgICAgIHJldHVybiByZXMoKTtcbiAgICB9XG4gICAgdmFyIGdhID0gd2luZG93WydnYXBpJ10gJiYgd2luZG93WydnYXBpJ10uYXV0aDIgPyB3aW5kb3dbJ2dhcGknXS5hdXRoMiA6IG51bGw7XG4gICAgaWYgKGdhKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnZ29vZ2xlIGFwaSBhbHJlYWR5IGxvYWRlZCcpO1xuICAgICAgICByZXR1cm4gcmVzKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMoKTtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgfVxufSk7XG52YXIgR29vZ2xlT0F1dGggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR29vZ2xlT0F1dGgoKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZWZyZXNoR29vZ2xlVG9rZW4gPSB0aGlzLnJlZnJlc2hHb29nbGVUb2tlbi5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9yZWZyZXNoR29vZ2xlVG9rZW5JbXBsID0gdGhpcy5fcmVmcmVzaEdvb2dsZVRva2VuSW1wbC5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICBHb29nbGVPQXV0aC5wcm90b3R5cGUucmVmcmVzaEdvb2dsZVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLmluaXRpYWxpemVkKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnbmVlZCB0byB3YWl0IGZvciB0aGUgR29vZ2xlIFNESyBsb2FkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHdhaXRGb3JJbml0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2ZpbmlzaCB3YWl0aW5nJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuX3JlZnJlc2hHb29nbGVUb2tlbkltcGwoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgR29vZ2xlT0F1dGgucHJvdG90eXBlLl9yZWZyZXNoR29vZ2xlVG9rZW5JbXBsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ2EgPSBudWxsO1xuICAgICAgICBpZiAoYnJvd3Nlck9yTm9kZSgpLmlzQnJvd3NlcilcbiAgICAgICAgICAgIGdhID0gd2luZG93WydnYXBpJ10gJiYgd2luZG93WydnYXBpJ10uYXV0aDIgPyB3aW5kb3dbJ2dhcGknXS5hdXRoMiA6IG51bGw7XG4gICAgICAgIGlmICghZ2EpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygnbm8gZ2FwaSBhdXRoMiBhdmFpbGFibGUnKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnbm8gZ2FwaSBhdXRoMiBhdmFpbGFibGUnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlcywgcmVqKSB7XG4gICAgICAgICAgICBnYS5nZXRBdXRoSW5zdGFuY2UoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChnb29nbGVBdXRoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFnb29nbGVBdXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnZ29vZ2xlIEF1dGggdW5kZWZpbmVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlaihuZXcgTm9uUmV0cnlhYmxlRXJyb3IoJ2dvb2dsZSBBdXRoIHVuZGVmaW5lZCcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGdvb2dsZVVzZXIgPSBnb29nbGVBdXRoLmN1cnJlbnRVc2VyLmdldCgpO1xuICAgICAgICAgICAgICAgIC8vIHJlZnJlc2ggdGhlIHRva2VuXG4gICAgICAgICAgICAgICAgaWYgKGdvb2dsZVVzZXIuaXNTaWduZWRJbigpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygncmVmcmVzaGluZyB0aGUgZ29vZ2xlIGFjY2VzcyB0b2tlbicpO1xuICAgICAgICAgICAgICAgICAgICBnb29nbGVVc2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVsb2FkQXV0aFJlc3BvbnNlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChhdXRoUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZF90b2tlbiA9IGF1dGhSZXNwb25zZS5pZF90b2tlbiwgZXhwaXJlc19hdCA9IGF1dGhSZXNwb25zZS5leHBpcmVzX2F0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHsgdG9rZW46IGlkX3Rva2VuLCBleHBpcmVzX2F0OiBleHBpcmVzX2F0IH0pO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIgJiYgZXJyLmVycm9yID09PSAnbmV0d29ya19lcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgdXNpbmcgTm9uUmV0cnlhYmxlRXJyb3Igc28gaGFuZGxlciB3aWxsIGJlIHJldHJpZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooJ05ldHdvcmsgZXJyb3IgcmVsb2FkaW5nIGdvb2dsZSBhdXRoIHJlc3BvbnNlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWoobmV3IE5vblJldHJ5YWJsZUVycm9yKCdGYWlsZWQgdG8gcmVsb2FkIGdvb2dsZSBhdXRoIHJlc3BvbnNlJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlaihuZXcgTm9uUmV0cnlhYmxlRXJyb3IoJ1VzZXIgaXMgbm90IHNpZ25lZCBpbiB3aXRoIEdvb2dsZScpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGYWlsZWQgdG8gcmVmcmVzaCBnb29nbGUgdG9rZW4nLCBlcnIpO1xuICAgICAgICAgICAgICAgIHJlaihuZXcgTm9uUmV0cnlhYmxlRXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIGdvb2dsZSB0b2tlbicpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBHb29nbGVPQXV0aDtcbn0oKSk7XG5leHBvcnQgeyBHb29nbGVPQXV0aCB9O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IEdvb2dsZU9BdXRoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9R29vZ2xlT0F1dGguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/GoogleOAuth.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/index.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/index.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FacebookOAuth: () => (/* binding */ FacebookOAuth),\n/* harmony export */   GoogleOAuth: () => (/* binding */ GoogleOAuth)\n/* harmony export */ });\n/* harmony import */ var _GoogleOAuth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GoogleOAuth */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/GoogleOAuth.js\");\n/* harmony import */ var _FacebookOAuth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FacebookOAuth */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/FacebookOAuth.js\");\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n\nvar GoogleOAuth = new _GoogleOAuth__WEBPACK_IMPORTED_MODULE_0__.GoogleOAuth();\nvar FacebookOAuth = new _FacebookOAuth__WEBPACK_IMPORTED_MODULE_1__.FacebookOAuth();\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9PQXV0aEhlbHBlci9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2dFO0FBQ007QUFDL0Qsc0JBQXNCLHFEQUFnQjtBQUN0Qyx3QkFBd0IseURBQWtCO0FBQ2pEIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL09BdXRoSGVscGVyL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBHb29nbGVPQXV0aCBhcyBHb29nbGVPQXV0aENsYXNzIH0gZnJvbSAnLi9Hb29nbGVPQXV0aCc7XG5pbXBvcnQgeyBGYWNlYm9va09BdXRoIGFzIEZhY2Vib29rT0F1dGhDbGFzcyB9IGZyb20gJy4vRmFjZWJvb2tPQXV0aCc7XG5leHBvcnQgdmFyIEdvb2dsZU9BdXRoID0gbmV3IEdvb2dsZU9BdXRoQ2xhc3MoKTtcbmV4cG9ydCB2YXIgRmFjZWJvb2tPQXV0aCA9IG5ldyBGYWNlYm9va09BdXRoQ2xhc3MoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/OAuthHelper/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Parser.js":
/*!**********************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Parser.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Parser: () => (/* binding */ Parser),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   parseMobileHubConfig: () => (/* binding */ parseMobileHubConfig)\n/* harmony export */ });\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Logger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\nvar logger = new _Logger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Parser');\nvar parseMobileHubConfig = function (config) {\n    var amplifyConfig = {};\n    // Analytics\n    if (config['aws_mobile_analytics_app_id']) {\n        var Analytics = {\n            AWSPinpoint: {\n                appId: config['aws_mobile_analytics_app_id'],\n                region: config['aws_mobile_analytics_app_region'],\n            },\n        };\n        amplifyConfig.Analytics = Analytics;\n    }\n    // Auth\n    if (config['aws_cognito_identity_pool_id'] || config['aws_user_pools_id']) {\n        amplifyConfig.Auth = {\n            userPoolId: config['aws_user_pools_id'],\n            userPoolWebClientId: config['aws_user_pools_web_client_id'],\n            region: config['aws_cognito_region'],\n            identityPoolId: config['aws_cognito_identity_pool_id'],\n            identityPoolRegion: config['aws_cognito_region'],\n            mandatorySignIn: config['aws_mandatory_sign_in'] === 'enable',\n            signUpVerificationMethod: config['aws_cognito_sign_up_verification_method'] || 'code',\n        };\n    }\n    // Storage\n    var storageConfig;\n    if (config['aws_user_files_s3_bucket']) {\n        storageConfig = {\n            AWSS3: {\n                bucket: config['aws_user_files_s3_bucket'],\n                region: config['aws_user_files_s3_bucket_region'],\n                dangerouslyConnectToHttpEndpointForTesting: config['aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing'],\n            },\n        };\n    }\n    else {\n        storageConfig = config ? config.Storage || config : {};\n    }\n    // Logging\n    if (config['Logging']) {\n        amplifyConfig.Logging = __assign(__assign({}, config['Logging']), { region: config['aws_project_region'] });\n    }\n    // Geo\n    if (config['geo']) {\n        amplifyConfig.Geo = Object.assign({}, config.geo);\n        if (config.geo['amazon_location_service']) {\n            amplifyConfig.Geo = {\n                AmazonLocationService: config.geo['amazon_location_service'],\n            };\n        }\n    }\n    amplifyConfig.Analytics = Object.assign({}, amplifyConfig.Analytics, config.Analytics);\n    amplifyConfig.Auth = Object.assign({}, amplifyConfig.Auth, config.Auth);\n    amplifyConfig.Storage = Object.assign({}, storageConfig);\n    amplifyConfig.Logging = Object.assign({}, amplifyConfig.Logging, config.Logging);\n    logger.debug('parse config', config, 'to amplifyconfig', amplifyConfig);\n    return amplifyConfig;\n};\n/**\n * @deprecated use per-function export\n */\nvar Parser = /** @class */ (function () {\n    function Parser() {\n    }\n    Parser.parseMobilehubConfig = parseMobileHubConfig;\n    return Parser;\n}());\n\n/**\n * @deprecated use per-function export\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Parser);\n//# sourceMappingURL=Parser.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9QYXJzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1QjtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDbUQ7QUFDbkQsaUJBQWlCLGtEQUFNO0FBQ2hCO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCx3QkFBd0Isc0NBQXNDO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUMseUNBQXlDO0FBQ3pDLDRDQUE0QztBQUM1Qyw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDaUI7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsTUFBTSxFQUFDO0FBQ3RCIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL1BhcnNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hc3NpZ24gPSAodGhpcyAmJiB0aGlzLl9fYXNzaWduKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuaW1wb3J0IHsgQ29uc29sZUxvZ2dlciBhcyBMb2dnZXIgfSBmcm9tICcuL0xvZ2dlcic7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignUGFyc2VyJyk7XG5leHBvcnQgdmFyIHBhcnNlTW9iaWxlSHViQ29uZmlnID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIHZhciBhbXBsaWZ5Q29uZmlnID0ge307XG4gICAgLy8gQW5hbHl0aWNzXG4gICAgaWYgKGNvbmZpZ1snYXdzX21vYmlsZV9hbmFseXRpY3NfYXBwX2lkJ10pIHtcbiAgICAgICAgdmFyIEFuYWx5dGljcyA9IHtcbiAgICAgICAgICAgIEFXU1BpbnBvaW50OiB7XG4gICAgICAgICAgICAgICAgYXBwSWQ6IGNvbmZpZ1snYXdzX21vYmlsZV9hbmFseXRpY3NfYXBwX2lkJ10sXG4gICAgICAgICAgICAgICAgcmVnaW9uOiBjb25maWdbJ2F3c19tb2JpbGVfYW5hbHl0aWNzX2FwcF9yZWdpb24nXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIGFtcGxpZnlDb25maWcuQW5hbHl0aWNzID0gQW5hbHl0aWNzO1xuICAgIH1cbiAgICAvLyBBdXRoXG4gICAgaWYgKGNvbmZpZ1snYXdzX2NvZ25pdG9faWRlbnRpdHlfcG9vbF9pZCddIHx8IGNvbmZpZ1snYXdzX3VzZXJfcG9vbHNfaWQnXSkge1xuICAgICAgICBhbXBsaWZ5Q29uZmlnLkF1dGggPSB7XG4gICAgICAgICAgICB1c2VyUG9vbElkOiBjb25maWdbJ2F3c191c2VyX3Bvb2xzX2lkJ10sXG4gICAgICAgICAgICB1c2VyUG9vbFdlYkNsaWVudElkOiBjb25maWdbJ2F3c191c2VyX3Bvb2xzX3dlYl9jbGllbnRfaWQnXSxcbiAgICAgICAgICAgIHJlZ2lvbjogY29uZmlnWydhd3NfY29nbml0b19yZWdpb24nXSxcbiAgICAgICAgICAgIGlkZW50aXR5UG9vbElkOiBjb25maWdbJ2F3c19jb2duaXRvX2lkZW50aXR5X3Bvb2xfaWQnXSxcbiAgICAgICAgICAgIGlkZW50aXR5UG9vbFJlZ2lvbjogY29uZmlnWydhd3NfY29nbml0b19yZWdpb24nXSxcbiAgICAgICAgICAgIG1hbmRhdG9yeVNpZ25JbjogY29uZmlnWydhd3NfbWFuZGF0b3J5X3NpZ25faW4nXSA9PT0gJ2VuYWJsZScsXG4gICAgICAgICAgICBzaWduVXBWZXJpZmljYXRpb25NZXRob2Q6IGNvbmZpZ1snYXdzX2NvZ25pdG9fc2lnbl91cF92ZXJpZmljYXRpb25fbWV0aG9kJ10gfHwgJ2NvZGUnLFxuICAgICAgICB9O1xuICAgIH1cbiAgICAvLyBTdG9yYWdlXG4gICAgdmFyIHN0b3JhZ2VDb25maWc7XG4gICAgaWYgKGNvbmZpZ1snYXdzX3VzZXJfZmlsZXNfczNfYnVja2V0J10pIHtcbiAgICAgICAgc3RvcmFnZUNvbmZpZyA9IHtcbiAgICAgICAgICAgIEFXU1MzOiB7XG4gICAgICAgICAgICAgICAgYnVja2V0OiBjb25maWdbJ2F3c191c2VyX2ZpbGVzX3MzX2J1Y2tldCddLFxuICAgICAgICAgICAgICAgIHJlZ2lvbjogY29uZmlnWydhd3NfdXNlcl9maWxlc19zM19idWNrZXRfcmVnaW9uJ10sXG4gICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlDb25uZWN0VG9IdHRwRW5kcG9pbnRGb3JUZXN0aW5nOiBjb25maWdbJ2F3c191c2VyX2ZpbGVzX3MzX2Rhbmdlcm91c2x5X2Nvbm5lY3RfdG9faHR0cF9lbmRwb2ludF9mb3JfdGVzdGluZyddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHN0b3JhZ2VDb25maWcgPSBjb25maWcgPyBjb25maWcuU3RvcmFnZSB8fCBjb25maWcgOiB7fTtcbiAgICB9XG4gICAgLy8gTG9nZ2luZ1xuICAgIGlmIChjb25maWdbJ0xvZ2dpbmcnXSkge1xuICAgICAgICBhbXBsaWZ5Q29uZmlnLkxvZ2dpbmcgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgY29uZmlnWydMb2dnaW5nJ10pLCB7IHJlZ2lvbjogY29uZmlnWydhd3NfcHJvamVjdF9yZWdpb24nXSB9KTtcbiAgICB9XG4gICAgLy8gR2VvXG4gICAgaWYgKGNvbmZpZ1snZ2VvJ10pIHtcbiAgICAgICAgYW1wbGlmeUNvbmZpZy5HZW8gPSBPYmplY3QuYXNzaWduKHt9LCBjb25maWcuZ2VvKTtcbiAgICAgICAgaWYgKGNvbmZpZy5nZW9bJ2FtYXpvbl9sb2NhdGlvbl9zZXJ2aWNlJ10pIHtcbiAgICAgICAgICAgIGFtcGxpZnlDb25maWcuR2VvID0ge1xuICAgICAgICAgICAgICAgIEFtYXpvbkxvY2F0aW9uU2VydmljZTogY29uZmlnLmdlb1snYW1hem9uX2xvY2F0aW9uX3NlcnZpY2UnXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgYW1wbGlmeUNvbmZpZy5BbmFseXRpY3MgPSBPYmplY3QuYXNzaWduKHt9LCBhbXBsaWZ5Q29uZmlnLkFuYWx5dGljcywgY29uZmlnLkFuYWx5dGljcyk7XG4gICAgYW1wbGlmeUNvbmZpZy5BdXRoID0gT2JqZWN0LmFzc2lnbih7fSwgYW1wbGlmeUNvbmZpZy5BdXRoLCBjb25maWcuQXV0aCk7XG4gICAgYW1wbGlmeUNvbmZpZy5TdG9yYWdlID0gT2JqZWN0LmFzc2lnbih7fSwgc3RvcmFnZUNvbmZpZyk7XG4gICAgYW1wbGlmeUNvbmZpZy5Mb2dnaW5nID0gT2JqZWN0LmFzc2lnbih7fSwgYW1wbGlmeUNvbmZpZy5Mb2dnaW5nLCBjb25maWcuTG9nZ2luZyk7XG4gICAgbG9nZ2VyLmRlYnVnKCdwYXJzZSBjb25maWcnLCBjb25maWcsICd0byBhbXBsaWZ5Y29uZmlnJywgYW1wbGlmeUNvbmZpZyk7XG4gICAgcmV0dXJuIGFtcGxpZnlDb25maWc7XG59O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgcGVyLWZ1bmN0aW9uIGV4cG9ydFxuICovXG52YXIgUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcnNlcigpIHtcbiAgICB9XG4gICAgUGFyc2VyLnBhcnNlTW9iaWxlaHViQ29uZmlnID0gcGFyc2VNb2JpbGVIdWJDb25maWc7XG4gICAgcmV0dXJuIFBhcnNlcjtcbn0oKSk7XG5leHBvcnQgeyBQYXJzZXIgfTtcbi8qKlxuICogQGRlcHJlY2F0ZWQgdXNlIHBlci1mdW5jdGlvbiBleHBvcnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgUGFyc2VyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UGFyc2VyLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Parser.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/index.js":
/*!******************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Platform/index.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Platform: () => (/* binding */ Platform),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAmplifyUserAgent: () => (/* binding */ getAmplifyUserAgent)\n/* harmony export */ });\n/* harmony import */ var _version__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./version */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/version.js\");\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nvar BASE_USER_AGENT = \"aws-amplify/\" + _version__WEBPACK_IMPORTED_MODULE_0__.version;\nvar Platform = {\n    userAgent: BASE_USER_AGENT + \" js\",\n    product: '',\n    navigator: null,\n    isReactNative: false,\n};\nif (typeof navigator !== 'undefined' && navigator.product) {\n    Platform.product = navigator.product || '';\n    Platform.navigator = navigator || null;\n    switch (navigator.product) {\n        case 'ReactNative':\n            Platform.userAgent = BASE_USER_AGENT + \" react-native\";\n            Platform.isReactNative = true;\n            break;\n        default:\n            Platform.userAgent = BASE_USER_AGENT + \" js\";\n            Platform.isReactNative = false;\n            break;\n    }\n}\nvar getAmplifyUserAgent = function (content) {\n    return \"\" + Platform.userAgent + (content ? content : '');\n};\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Platform);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9QbGF0Zm9ybS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ29DO0FBQ3BDLHVDQUF1Qyw2Q0FBTztBQUN2QztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWUsUUFBUSxFQUFDO0FBQ3hCIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL1BsYXRmb3JtL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSAnLi92ZXJzaW9uJztcbnZhciBCQVNFX1VTRVJfQUdFTlQgPSBcImF3cy1hbXBsaWZ5L1wiICsgdmVyc2lvbjtcbmV4cG9ydCB2YXIgUGxhdGZvcm0gPSB7XG4gICAgdXNlckFnZW50OiBCQVNFX1VTRVJfQUdFTlQgKyBcIiBqc1wiLFxuICAgIHByb2R1Y3Q6ICcnLFxuICAgIG5hdmlnYXRvcjogbnVsbCxcbiAgICBpc1JlYWN0TmF0aXZlOiBmYWxzZSxcbn07XG5pZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnByb2R1Y3QpIHtcbiAgICBQbGF0Zm9ybS5wcm9kdWN0ID0gbmF2aWdhdG9yLnByb2R1Y3QgfHwgJyc7XG4gICAgUGxhdGZvcm0ubmF2aWdhdG9yID0gbmF2aWdhdG9yIHx8IG51bGw7XG4gICAgc3dpdGNoIChuYXZpZ2F0b3IucHJvZHVjdCkge1xuICAgICAgICBjYXNlICdSZWFjdE5hdGl2ZSc6XG4gICAgICAgICAgICBQbGF0Zm9ybS51c2VyQWdlbnQgPSBCQVNFX1VTRVJfQUdFTlQgKyBcIiByZWFjdC1uYXRpdmVcIjtcbiAgICAgICAgICAgIFBsYXRmb3JtLmlzUmVhY3ROYXRpdmUgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBQbGF0Zm9ybS51c2VyQWdlbnQgPSBCQVNFX1VTRVJfQUdFTlQgKyBcIiBqc1wiO1xuICAgICAgICAgICAgUGxhdGZvcm0uaXNSZWFjdE5hdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuZXhwb3J0IHZhciBnZXRBbXBsaWZ5VXNlckFnZW50ID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICByZXR1cm4gXCJcIiArIFBsYXRmb3JtLnVzZXJBZ2VudCArIChjb250ZW50ID8gY29udGVudCA6ICcnKTtcbn07XG4vKipcbiAqIEBkZXByZWNhdGVkIHVzZSBuYW1lZCBpbXBvcnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgUGxhdGZvcm07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/version.js":
/*!********************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Platform/version.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n// generated by genversion\nvar version = '4.7.14';\n//# sourceMappingURL=version.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9QbGF0Zm9ybS92ZXJzaW9uLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNPO0FBQ1AiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vUGxhdGZvcm0vdmVyc2lvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBnZW5lcmF0ZWQgYnkgZ2VudmVyc2lvblxuZXhwb3J0IHZhciB2ZXJzaW9uID0gJzQuNy4xNCc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12ZXJzaW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/version.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/StorageHelper/index.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/StorageHelper/index.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MemoryStorage: () => (/* binding */ MemoryStorage),\n/* harmony export */   StorageHelper: () => (/* binding */ StorageHelper),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar dataMemory = {};\n/** @class */\nvar MemoryStorage = /** @class */ (function () {\n    function MemoryStorage() {\n    }\n    /**\n     * This is used to set a specific item in storage\n     * @param {string} key - the key for the item\n     * @param {object} value - the value\n     * @returns {string} value that was set\n     */\n    MemoryStorage.setItem = function (key, value) {\n        dataMemory[key] = value;\n        return dataMemory[key];\n    };\n    /**\n     * This is used to get a specific key from storage\n     * @param {string} key - the key for the item\n     * This is used to clear the storage\n     * @returns {string} the data item\n     */\n    MemoryStorage.getItem = function (key) {\n        return Object.prototype.hasOwnProperty.call(dataMemory, key)\n            ? dataMemory[key]\n            : undefined;\n    };\n    /**\n     * This is used to remove an item from storage\n     * @param {string} key - the key being set\n     * @returns {string} value - value that was deleted\n     */\n    MemoryStorage.removeItem = function (key) {\n        return delete dataMemory[key];\n    };\n    /**\n     * This is used to clear the storage\n     * @returns {string} nothing\n     */\n    MemoryStorage.clear = function () {\n        dataMemory = {};\n        return dataMemory;\n    };\n    return MemoryStorage;\n}());\n\nvar StorageHelper = /** @class */ (function () {\n    /**\n     * This is used to get a storage object\n     * @returns {object} the storage\n     */\n    function StorageHelper() {\n        try {\n            this.storageWindow = window.localStorage;\n            this.storageWindow.setItem('aws.amplify.test-ls', 1);\n            this.storageWindow.removeItem('aws.amplify.test-ls');\n        }\n        catch (exception) {\n            this.storageWindow = MemoryStorage;\n        }\n    }\n    /**\n     * This is used to return the storage\n     * @returns {object} the storage\n     */\n    StorageHelper.prototype.getStorage = function () {\n        return this.storageWindow;\n    };\n    return StorageHelper;\n}());\n\n/**\n * @deprecated use named import\n */\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StorageHelper);\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9TdG9yYWdlSGVscGVyL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUN3QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ3dCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGlFQUFlLGFBQWEsRUFBQztBQUM3QiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9TdG9yYWdlSGVscGVyL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAxNy0yMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoXG4gKiB0aGUgTGljZW5zZS4gQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiAgICAgaHR0cDovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC9cbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1JcbiAqIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG52YXIgZGF0YU1lbW9yeSA9IHt9O1xuLyoqIEBjbGFzcyAqL1xudmFyIE1lbW9yeVN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVtb3J5U3RvcmFnZSgpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBpcyB1c2VkIHRvIHNldCBhIHNwZWNpZmljIGl0ZW0gaW4gc3RvcmFnZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSB0aGUga2V5IGZvciB0aGUgaXRlbVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSB2YWx1ZSAtIHRoZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHZhbHVlIHRoYXQgd2FzIHNldFxuICAgICAqL1xuICAgIE1lbW9yeVN0b3JhZ2Uuc2V0SXRlbSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGRhdGFNZW1vcnlba2V5XSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gZGF0YU1lbW9yeVtrZXldO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyBpcyB1c2VkIHRvIGdldCBhIHNwZWNpZmljIGtleSBmcm9tIHN0b3JhZ2VcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gdGhlIGtleSBmb3IgdGhlIGl0ZW1cbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gY2xlYXIgdGhlIHN0b3JhZ2VcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgZGF0YSBpdGVtXG4gICAgICovXG4gICAgTWVtb3J5U3RvcmFnZS5nZXRJdGVtID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFNZW1vcnksIGtleSlcbiAgICAgICAgICAgID8gZGF0YU1lbW9yeVtrZXldXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgdXNlZCB0byByZW1vdmUgYW4gaXRlbSBmcm9tIHN0b3JhZ2VcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gdGhlIGtleSBiZWluZyBzZXRcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB2YWx1ZSAtIHZhbHVlIHRoYXQgd2FzIGRlbGV0ZWRcbiAgICAgKi9cbiAgICBNZW1vcnlTdG9yYWdlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBkZWxldGUgZGF0YU1lbW9yeVtrZXldO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhpcyBpcyB1c2VkIHRvIGNsZWFyIHRoZSBzdG9yYWdlXG4gICAgICogQHJldHVybnMge3N0cmluZ30gbm90aGluZ1xuICAgICAqL1xuICAgIE1lbW9yeVN0b3JhZ2UuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRhdGFNZW1vcnkgPSB7fTtcbiAgICAgICAgcmV0dXJuIGRhdGFNZW1vcnk7XG4gICAgfTtcbiAgICByZXR1cm4gTWVtb3J5U3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBNZW1vcnlTdG9yYWdlIH07XG52YXIgU3RvcmFnZUhlbHBlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gZ2V0IGEgc3RvcmFnZSBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSB0aGUgc3RvcmFnZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFN0b3JhZ2VIZWxwZXIoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2VXaW5kb3cgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlV2luZG93LnNldEl0ZW0oJ2F3cy5hbXBsaWZ5LnRlc3QtbHMnLCAxKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmFnZVdpbmRvdy5yZW1vdmVJdGVtKCdhd3MuYW1wbGlmeS50ZXN0LWxzJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlV2luZG93ID0gTWVtb3J5U3RvcmFnZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gcmV0dXJuIHRoZSBzdG9yYWdlXG4gICAgICogQHJldHVybnMge29iamVjdH0gdGhlIHN0b3JhZ2VcbiAgICAgKi9cbiAgICBTdG9yYWdlSGVscGVyLnByb3RvdHlwZS5nZXRTdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlV2luZG93O1xuICAgIH07XG4gICAgcmV0dXJuIFN0b3JhZ2VIZWxwZXI7XG59KCkpO1xuZXhwb3J0IHsgU3RvcmFnZUhlbHBlciB9O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2UgbmFtZWQgaW1wb3J0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IFN0b3JhZ2VIZWxwZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/StorageHelper/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/UniversalStorage/index.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/UniversalStorage/index.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UniversalStorage: () => (/* binding */ UniversalStorage)\n/* harmony export */ });\n/* harmony import */ var universal_cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! universal-cookie */ \"(ssr)/./node_modules/universal-cookie/es6/index.js\");\n/* harmony import */ var _JS__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../JS */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/JS.js\");\n\n\nvar isBrowser = (0,_JS__WEBPACK_IMPORTED_MODULE_0__.browserOrNode)().isBrowser;\nvar UniversalStorage = /** @class */ (function () {\n    function UniversalStorage(context) {\n        if (context === void 0) { context = {}; }\n        this.cookies = new universal_cookie__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n        this.store = isBrowser ? window.localStorage : Object.create(null);\n        this.cookies = context.req\n            ? new universal_cookie__WEBPACK_IMPORTED_MODULE_1__[\"default\"](context.req.headers.cookie)\n            : new universal_cookie__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n        Object.assign(this.store, this.cookies.getAll());\n    }\n    Object.defineProperty(UniversalStorage.prototype, \"length\", {\n        get: function () {\n            return Object.entries(this.store).length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    UniversalStorage.prototype.clear = function () {\n        var _this = this;\n        Array.from(new Array(this.length))\n            .map(function (_, i) { return _this.key(i); })\n            .forEach(function (key) { return _this.removeItem(key); });\n    };\n    UniversalStorage.prototype.getItem = function (key) {\n        return this.getLocalItem(key);\n    };\n    UniversalStorage.prototype.getLocalItem = function (key) {\n        return Object.prototype.hasOwnProperty.call(this.store, key)\n            ? this.store[key]\n            : null;\n    };\n    UniversalStorage.prototype.getUniversalItem = function (key) {\n        return this.cookies.get(key);\n    };\n    UniversalStorage.prototype.key = function (index) {\n        return Object.keys(this.store)[index];\n    };\n    UniversalStorage.prototype.removeItem = function (key) {\n        this.removeLocalItem(key);\n        this.removeUniversalItem(key);\n    };\n    UniversalStorage.prototype.removeLocalItem = function (key) {\n        delete this.store[key];\n    };\n    UniversalStorage.prototype.removeUniversalItem = function (key) {\n        this.cookies.remove(key, {\n            path: '/',\n        });\n    };\n    UniversalStorage.prototype.setItem = function (key, value) {\n        this.setLocalItem(key, value);\n        // keys take the shape:\n        //  1. `${ProviderPrefix}.${userPoolClientId}.${username}.${tokenType}\n        //  2. `${ProviderPrefix}.${userPoolClientId}.LastAuthUser\n        var tokenType = key.split('.').pop();\n        switch (tokenType) {\n            // LastAuthUser is needed for computing other key names\n            case 'LastAuthUser':\n            // accessToken is required for CognitoUserSession\n            case 'accessToken':\n            // refreshToken originates on the client, but SSR pages won't fail when this expires\n            // Note: the new `accessToken` will also be refreshed on the client (since Amplify doesn't set server-side cookies)\n            case 'refreshToken':\n            // Required for CognitoUserSession\n            case 'idToken':\n                isBrowser\n                    ? this.setUniversalItem(key, value)\n                    : this.setLocalItem(key, value);\n            // userData is used when `Auth.currentAuthenticatedUser({ bypassCache: false })`.\n            // Can be persisted to speed up calls to `Auth.currentAuthenticatedUser()`\n            // case 'userData':\n            // Ignoring clockDrift on the server for now, but needs testing\n            // case 'clockDrift':\n        }\n    };\n    UniversalStorage.prototype.setLocalItem = function (key, value) {\n        this.store[key] = value;\n    };\n    UniversalStorage.prototype.setUniversalItem = function (key, value) {\n        this.cookies.set(key, value, {\n            path: '/',\n            // `httpOnly` cannot be set via JavaScript: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#JavaScript_access_using_Document.cookie\n            sameSite: true,\n            // Allow unsecure requests to http://localhost:3000/ when in development.\n            secure: window.location.hostname === 'localhost' ? false : true,\n        });\n    };\n    return UniversalStorage;\n}());\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9Vbml2ZXJzYWxTdG9yYWdlL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1QztBQUNEO0FBQ3RDLGdCQUFnQixrREFBYTtBQUM3QjtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDLDJCQUEyQix3REFBTztBQUNsQztBQUNBO0FBQ0Esa0JBQWtCLHdEQUFPO0FBQ3pCLGtCQUFrQix3REFBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHNCQUFzQjtBQUN6RCxzQ0FBc0MsK0JBQStCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGVBQWUsR0FBRyxpQkFBaUIsR0FBRyxTQUFTLEdBQUc7QUFDcEUsa0JBQWtCLGVBQWUsR0FBRyxpQkFBaUI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxvQkFBb0I7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDMkI7QUFDNUIiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vVW5pdmVyc2FsU3RvcmFnZS9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29va2llcyBmcm9tICd1bml2ZXJzYWwtY29va2llJztcbmltcG9ydCB7IGJyb3dzZXJPck5vZGUgfSBmcm9tICcuLi9KUyc7XG52YXIgaXNCcm93c2VyID0gYnJvd3Nlck9yTm9kZSgpLmlzQnJvd3NlcjtcbnZhciBVbml2ZXJzYWxTdG9yYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFVuaXZlcnNhbFN0b3JhZ2UoY29udGV4dCkge1xuICAgICAgICBpZiAoY29udGV4dCA9PT0gdm9pZCAwKSB7IGNvbnRleHQgPSB7fTsgfVxuICAgICAgICB0aGlzLmNvb2tpZXMgPSBuZXcgQ29va2llcygpO1xuICAgICAgICB0aGlzLnN0b3JlID0gaXNCcm93c2VyID8gd2luZG93LmxvY2FsU3RvcmFnZSA6IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuY29va2llcyA9IGNvbnRleHQucmVxXG4gICAgICAgICAgICA/IG5ldyBDb29raWVzKGNvbnRleHQucmVxLmhlYWRlcnMuY29va2llKVxuICAgICAgICAgICAgOiBuZXcgQ29va2llcygpO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuc3RvcmUsIHRoaXMuY29va2llcy5nZXRBbGwoKSk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbml2ZXJzYWxTdG9yYWdlLnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyh0aGlzLnN0b3JlKS5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFVuaXZlcnNhbFN0b3JhZ2UucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBBcnJheS5mcm9tKG5ldyBBcnJheSh0aGlzLmxlbmd0aCkpXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBfdGhpcy5rZXkoaSk7IH0pXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBfdGhpcy5yZW1vdmVJdGVtKGtleSk7IH0pO1xuICAgIH07XG4gICAgVW5pdmVyc2FsU3RvcmFnZS5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxJdGVtKGtleSk7XG4gICAgfTtcbiAgICBVbml2ZXJzYWxTdG9yYWdlLnByb3RvdHlwZS5nZXRMb2NhbEl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5zdG9yZSwga2V5KVxuICAgICAgICAgICAgPyB0aGlzLnN0b3JlW2tleV1cbiAgICAgICAgICAgIDogbnVsbDtcbiAgICB9O1xuICAgIFVuaXZlcnNhbFN0b3JhZ2UucHJvdG90eXBlLmdldFVuaXZlcnNhbEl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvb2tpZXMuZ2V0KGtleSk7XG4gICAgfTtcbiAgICBVbml2ZXJzYWxTdG9yYWdlLnByb3RvdHlwZS5rZXkgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuc3RvcmUpW2luZGV4XTtcbiAgICB9O1xuICAgIFVuaXZlcnNhbFN0b3JhZ2UucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlTG9jYWxJdGVtKGtleSk7XG4gICAgICAgIHRoaXMucmVtb3ZlVW5pdmVyc2FsSXRlbShrZXkpO1xuICAgIH07XG4gICAgVW5pdmVyc2FsU3RvcmFnZS5wcm90b3R5cGUucmVtb3ZlTG9jYWxJdGVtID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBkZWxldGUgdGhpcy5zdG9yZVtrZXldO1xuICAgIH07XG4gICAgVW5pdmVyc2FsU3RvcmFnZS5wcm90b3R5cGUucmVtb3ZlVW5pdmVyc2FsSXRlbSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdGhpcy5jb29raWVzLnJlbW92ZShrZXksIHtcbiAgICAgICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVbml2ZXJzYWxTdG9yYWdlLnByb3RvdHlwZS5zZXRJdGVtID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRMb2NhbEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgICAgIC8vIGtleXMgdGFrZSB0aGUgc2hhcGU6XG4gICAgICAgIC8vICAxLiBgJHtQcm92aWRlclByZWZpeH0uJHt1c2VyUG9vbENsaWVudElkfS4ke3VzZXJuYW1lfS4ke3Rva2VuVHlwZX1cbiAgICAgICAgLy8gIDIuIGAke1Byb3ZpZGVyUHJlZml4fS4ke3VzZXJQb29sQ2xpZW50SWR9Lkxhc3RBdXRoVXNlclxuICAgICAgICB2YXIgdG9rZW5UeXBlID0ga2V5LnNwbGl0KCcuJykucG9wKCk7XG4gICAgICAgIHN3aXRjaCAodG9rZW5UeXBlKSB7XG4gICAgICAgICAgICAvLyBMYXN0QXV0aFVzZXIgaXMgbmVlZGVkIGZvciBjb21wdXRpbmcgb3RoZXIga2V5IG5hbWVzXG4gICAgICAgICAgICBjYXNlICdMYXN0QXV0aFVzZXInOlxuICAgICAgICAgICAgLy8gYWNjZXNzVG9rZW4gaXMgcmVxdWlyZWQgZm9yIENvZ25pdG9Vc2VyU2Vzc2lvblxuICAgICAgICAgICAgY2FzZSAnYWNjZXNzVG9rZW4nOlxuICAgICAgICAgICAgLy8gcmVmcmVzaFRva2VuIG9yaWdpbmF0ZXMgb24gdGhlIGNsaWVudCwgYnV0IFNTUiBwYWdlcyB3b24ndCBmYWlsIHdoZW4gdGhpcyBleHBpcmVzXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGUgbmV3IGBhY2Nlc3NUb2tlbmAgd2lsbCBhbHNvIGJlIHJlZnJlc2hlZCBvbiB0aGUgY2xpZW50IChzaW5jZSBBbXBsaWZ5IGRvZXNuJ3Qgc2V0IHNlcnZlci1zaWRlIGNvb2tpZXMpXG4gICAgICAgICAgICBjYXNlICdyZWZyZXNoVG9rZW4nOlxuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIENvZ25pdG9Vc2VyU2Vzc2lvblxuICAgICAgICAgICAgY2FzZSAnaWRUb2tlbic6XG4gICAgICAgICAgICAgICAgaXNCcm93c2VyXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5zZXRVbml2ZXJzYWxJdGVtKGtleSwgdmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5zZXRMb2NhbEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAvLyB1c2VyRGF0YSBpcyB1c2VkIHdoZW4gYEF1dGguY3VycmVudEF1dGhlbnRpY2F0ZWRVc2VyKHsgYnlwYXNzQ2FjaGU6IGZhbHNlIH0pYC5cbiAgICAgICAgICAgIC8vIENhbiBiZSBwZXJzaXN0ZWQgdG8gc3BlZWQgdXAgY2FsbHMgdG8gYEF1dGguY3VycmVudEF1dGhlbnRpY2F0ZWRVc2VyKClgXG4gICAgICAgICAgICAvLyBjYXNlICd1c2VyRGF0YSc6XG4gICAgICAgICAgICAvLyBJZ25vcmluZyBjbG9ja0RyaWZ0IG9uIHRoZSBzZXJ2ZXIgZm9yIG5vdywgYnV0IG5lZWRzIHRlc3RpbmdcbiAgICAgICAgICAgIC8vIGNhc2UgJ2Nsb2NrRHJpZnQnOlxuICAgICAgICB9XG4gICAgfTtcbiAgICBVbml2ZXJzYWxTdG9yYWdlLnByb3RvdHlwZS5zZXRMb2NhbEl0ZW0gPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0b3JlW2tleV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIFVuaXZlcnNhbFN0b3JhZ2UucHJvdG90eXBlLnNldFVuaXZlcnNhbEl0ZW0gPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLmNvb2tpZXMuc2V0KGtleSwgdmFsdWUsIHtcbiAgICAgICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgICAgIC8vIGBodHRwT25seWAgY2Fubm90IGJlIHNldCB2aWEgSmF2YVNjcmlwdDogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9Db29raWVzI0phdmFTY3JpcHRfYWNjZXNzX3VzaW5nX0RvY3VtZW50LmNvb2tpZVxuICAgICAgICAgICAgc2FtZVNpdGU6IHRydWUsXG4gICAgICAgICAgICAvLyBBbGxvdyB1bnNlY3VyZSByZXF1ZXN0cyB0byBodHRwOi8vbG9jYWxob3N0OjMwMDAvIHdoZW4gaW4gZGV2ZWxvcG1lbnQuXG4gICAgICAgICAgICBzZWN1cmU6IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgPyBmYWxzZSA6IHRydWUsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFVuaXZlcnNhbFN0b3JhZ2U7XG59KCkpO1xuZXhwb3J0IHsgVW5pdmVyc2FsU3RvcmFnZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/UniversalStorage/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/CognitoIdentityClient.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Util/CognitoIdentityClient.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCognitoIdentityClient: () => (/* binding */ createCognitoIdentityClient),\n/* harmony export */   middlewareArgs: () => (/* binding */ middlewareArgs)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-cognito-identity */ \"(ssr)/./node_modules/@aws-sdk/client-cognito-identity/dist/es/CognitoIdentityClient.js\");\n/* harmony import */ var _Platform__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Platform */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Platform/index.js\");\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n/**\n * Returns a CognitoIdentityClient with middleware\n * @param {CognitoIdentityClientConfig} config\n * @return {CognitoIdentityClient}\n */\nfunction createCognitoIdentityClient(config) {\n    var client = new _aws_sdk_client_cognito_identity__WEBPACK_IMPORTED_MODULE_0__.CognitoIdentityClient({\n        region: config.region,\n        customUserAgent: (0,_Platform__WEBPACK_IMPORTED_MODULE_1__.getAmplifyUserAgent)(),\n    });\n    client.middlewareStack.add(function (next, _) { return function (args) {\n        return next(middlewareArgs(args));\n    }; }, {\n        step: 'build',\n        name: 'cacheControlMiddleWare',\n    });\n    return client;\n}\nfunction middlewareArgs(args) {\n    return __assign(__assign({}, args), { request: __assign(__assign({}, args.request), { headers: __assign(__assign({}, args.request.headers), { 'cache-control': 'no-store' }) }) });\n}\n//# sourceMappingURL=CognitoIdentityClient.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL0NvZ25pdG9JZGVudGl0eUNsaWVudC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBLGdCQUFnQixTQUFJLElBQUksU0FBSTtBQUM1QjtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDMEU7QUFDeEI7QUFDbEQ7QUFDQTtBQUNBLFdBQVcsNkJBQTZCO0FBQ3hDLFlBQVk7QUFDWjtBQUNPO0FBQ1AscUJBQXFCLG1GQUFxQjtBQUMxQztBQUNBLHlCQUF5Qiw4REFBbUI7QUFDNUMsS0FBSztBQUNMLG9EQUFvRDtBQUNwRDtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDTztBQUNQLCtCQUErQixXQUFXLDZCQUE2QixtQkFBbUIsNkJBQTZCLDJCQUEyQiw2QkFBNkIsR0FBRyxHQUFHO0FBQ3JMO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vVXRpbC9Db2duaXRvSWRlbnRpdHlDbGllbnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbmltcG9ydCB7IENvZ25pdG9JZGVudGl0eUNsaWVudCwgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtY29nbml0by1pZGVudGl0eSc7XG5pbXBvcnQgeyBnZXRBbXBsaWZ5VXNlckFnZW50IH0gZnJvbSAnLi4vUGxhdGZvcm0nO1xuLyoqXG4gKiBSZXR1cm5zIGEgQ29nbml0b0lkZW50aXR5Q2xpZW50IHdpdGggbWlkZGxld2FyZVxuICogQHBhcmFtIHtDb2duaXRvSWRlbnRpdHlDbGllbnRDb25maWd9IGNvbmZpZ1xuICogQHJldHVybiB7Q29nbml0b0lkZW50aXR5Q2xpZW50fVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29nbml0b0lkZW50aXR5Q2xpZW50KGNvbmZpZykge1xuICAgIHZhciBjbGllbnQgPSBuZXcgQ29nbml0b0lkZW50aXR5Q2xpZW50KHtcbiAgICAgICAgcmVnaW9uOiBjb25maWcucmVnaW9uLFxuICAgICAgICBjdXN0b21Vc2VyQWdlbnQ6IGdldEFtcGxpZnlVc2VyQWdlbnQoKSxcbiAgICB9KTtcbiAgICBjbGllbnQubWlkZGxld2FyZVN0YWNrLmFkZChmdW5jdGlvbiAobmV4dCwgXykgeyByZXR1cm4gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIG5leHQobWlkZGxld2FyZUFyZ3MoYXJncykpO1xuICAgIH07IH0sIHtcbiAgICAgICAgc3RlcDogJ2J1aWxkJyxcbiAgICAgICAgbmFtZTogJ2NhY2hlQ29udHJvbE1pZGRsZVdhcmUnLFxuICAgIH0pO1xuICAgIHJldHVybiBjbGllbnQ7XG59XG5leHBvcnQgZnVuY3Rpb24gbWlkZGxld2FyZUFyZ3MoYXJncykge1xuICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgYXJncyksIHsgcmVxdWVzdDogX19hc3NpZ24oX19hc3NpZ24oe30sIGFyZ3MucmVxdWVzdCksIHsgaGVhZGVyczogX19hc3NpZ24oX19hc3NpZ24oe30sIGFyZ3MucmVxdWVzdC5oZWFkZXJzKSwgeyAnY2FjaGUtY29udHJvbCc6ICduby1zdG9yZScgfSkgfSkgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db2duaXRvSWRlbnRpdHlDbGllbnQuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/CognitoIdentityClient.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js":
/*!******************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AWS_CLOUDWATCH_BASE_BUFFER_SIZE: () => (/* binding */ AWS_CLOUDWATCH_BASE_BUFFER_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_CATEGORY: () => (/* binding */ AWS_CLOUDWATCH_CATEGORY),\n/* harmony export */   AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE: () => (/* binding */ AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_MAX_EVENT_SIZE: () => (/* binding */ AWS_CLOUDWATCH_MAX_EVENT_SIZE),\n/* harmony export */   AWS_CLOUDWATCH_PROVIDER_NAME: () => (/* binding */ AWS_CLOUDWATCH_PROVIDER_NAME),\n/* harmony export */   NO_CREDS_ERROR_STRING: () => (/* binding */ NO_CREDS_ERROR_STRING),\n/* harmony export */   RETRY_ERROR_CODES: () => (/* binding */ RETRY_ERROR_CODES)\n/* harmony export */ });\n/*\n * Copyright 2017-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// Logging constants\nvar AWS_CLOUDWATCH_BASE_BUFFER_SIZE = 26;\nvar AWS_CLOUDWATCH_MAX_BATCH_EVENT_SIZE = 1048576;\nvar AWS_CLOUDWATCH_MAX_EVENT_SIZE = 256000;\nvar AWS_CLOUDWATCH_CATEGORY = 'Logging';\nvar AWS_CLOUDWATCH_PROVIDER_NAME = 'AWSCloudWatch';\nvar NO_CREDS_ERROR_STRING = 'No credentials';\nvar RETRY_ERROR_CODES = [\n    'ResourceNotFoundException',\n    'InvalidSequenceTokenException',\n];\n\n//# sourceMappingURL=Constants.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL0NvbnN0YW50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNpTjtBQUNqTiIsInNvdXJjZXMiOlsiL1VzZXJzL3NhaXNpZGRoYXJ0aC9Eb3dubG9hZHMvYnl0ZXgtaHlkcm9oZXJvLTQvYnRoZS9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL0NvbnN0YW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMTctMjAxOSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIikuIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aFxuICogdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgIGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hcGFjaGUyLjAvXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SXG4gKiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcbiAqIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gTG9nZ2luZyBjb25zdGFudHNcbnZhciBBV1NfQ0xPVURXQVRDSF9CQVNFX0JVRkZFUl9TSVpFID0gMjY7XG52YXIgQVdTX0NMT1VEV0FUQ0hfTUFYX0JBVENIX0VWRU5UX1NJWkUgPSAxMDQ4NTc2O1xudmFyIEFXU19DTE9VRFdBVENIX01BWF9FVkVOVF9TSVpFID0gMjU2MDAwO1xudmFyIEFXU19DTE9VRFdBVENIX0NBVEVHT1JZID0gJ0xvZ2dpbmcnO1xudmFyIEFXU19DTE9VRFdBVENIX1BST1ZJREVSX05BTUUgPSAnQVdTQ2xvdWRXYXRjaCc7XG52YXIgTk9fQ1JFRFNfRVJST1JfU1RSSU5HID0gJ05vIGNyZWRlbnRpYWxzJztcbnZhciBSRVRSWV9FUlJPUl9DT0RFUyA9IFtcbiAgICAnUmVzb3VyY2VOb3RGb3VuZEV4Y2VwdGlvbicsXG4gICAgJ0ludmFsaWRTZXF1ZW5jZVRva2VuRXhjZXB0aW9uJyxcbl07XG5leHBvcnQgeyBBV1NfQ0xPVURXQVRDSF9CQVNFX0JVRkZFUl9TSVpFLCBBV1NfQ0xPVURXQVRDSF9DQVRFR09SWSwgQVdTX0NMT1VEV0FUQ0hfTUFYX0JBVENIX0VWRU5UX1NJWkUsIEFXU19DTE9VRFdBVENIX01BWF9FVkVOVF9TSVpFLCBBV1NfQ0xPVURXQVRDSF9QUk9WSURFUl9OQU1FLCBOT19DUkVEU19FUlJPUl9TVFJJTkcsIFJFVFJZX0VSUk9SX0NPREVTLCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29uc3RhbnRzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Constants.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js":
/*!**************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NonRetryableError: () => (/* binding */ NonRetryableError),\n/* harmony export */   jitteredBackoff: () => (/* binding */ jitteredBackoff),\n/* harmony export */   jitteredExponentialRetry: () => (/* binding */ jitteredExponentialRetry),\n/* harmony export */   retry: () => (/* binding */ retry)\n/* harmony export */ });\n/* harmony import */ var _Logger_ConsoleLogger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Logger/ConsoleLogger */ \"(ssr)/./node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (undefined && undefined.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (undefined && undefined.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\n\nvar logger = new _Logger_ConsoleLogger__WEBPACK_IMPORTED_MODULE_0__.ConsoleLogger('Util');\nvar NonRetryableError = /** @class */ (function (_super) {\n    __extends(NonRetryableError, _super);\n    function NonRetryableError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.nonRetryable = true;\n        return _this;\n    }\n    return NonRetryableError;\n}(Error));\n\nvar isNonRetryableError = function (obj) {\n    var key = 'nonRetryable';\n    return obj && obj[key];\n};\n/**\n * @private\n * Internal use of Amplify only\n */\nfunction retry(functionToRetry, args, delayFn, onTerminate) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return __generator(this, function (_a) {\n            if (typeof functionToRetry !== 'function') {\n                throw Error('functionToRetry must be a function');\n            }\n            return [2 /*return*/, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                    var attempt, terminated, timeout, wakeUp, lastError, _loop_1, state_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                attempt = 0;\n                                terminated = false;\n                                wakeUp = function () { };\n                                onTerminate &&\n                                    onTerminate.then(function () {\n                                        // signal not to try anymore.\n                                        terminated = true;\n                                        // stop sleeping if we're sleeping.\n                                        clearTimeout(timeout);\n                                        wakeUp();\n                                    });\n                                _loop_1 = function () {\n                                    var _a, _b, err_1, retryIn_1;\n                                    return __generator(this, function (_c) {\n                                        switch (_c.label) {\n                                            case 0:\n                                                attempt++;\n                                                logger.debug(functionToRetry.name + \" attempt #\" + attempt + \" with this vars: \" + JSON.stringify(args));\n                                                _c.label = 1;\n                                            case 1:\n                                                _c.trys.push([1, 3, , 7]);\n                                                _a = {};\n                                                _b = resolve;\n                                                return [4 /*yield*/, functionToRetry.apply(void 0, __spread(args))];\n                                            case 2: return [2 /*return*/, (_a.value = _b.apply(void 0, [_c.sent()]), _a)];\n                                            case 3:\n                                                err_1 = _c.sent();\n                                                lastError = err_1;\n                                                logger.debug(\"error on \" + functionToRetry.name, err_1);\n                                                if (isNonRetryableError(err_1)) {\n                                                    logger.debug(functionToRetry.name + \" non retryable error\", err_1);\n                                                    return [2 /*return*/, { value: reject(err_1) }];\n                                                }\n                                                retryIn_1 = delayFn(attempt, args, err_1);\n                                                logger.debug(functionToRetry.name + \" retrying in \" + retryIn_1 + \" ms\");\n                                                if (!(retryIn_1 === false || terminated)) return [3 /*break*/, 4];\n                                                return [2 /*return*/, { value: reject(err_1) }];\n                                            case 4: return [4 /*yield*/, new Promise(function (r) {\n                                                    wakeUp = r; // export wakeUp for onTerminate handling\n                                                    timeout = setTimeout(wakeUp, retryIn_1);\n                                                })];\n                                            case 5:\n                                                _c.sent();\n                                                _c.label = 6;\n                                            case 6: return [3 /*break*/, 7];\n                                            case 7: return [2 /*return*/];\n                                        }\n                                    });\n                                };\n                                _a.label = 1;\n                            case 1:\n                                if (!!terminated) return [3 /*break*/, 3];\n                                return [5 /*yield**/, _loop_1()];\n                            case 2:\n                                state_1 = _a.sent();\n                                if (typeof state_1 === \"object\")\n                                    return [2 /*return*/, state_1.value];\n                                return [3 /*break*/, 1];\n                            case 3:\n                                // reached if terminated while waiting for a timer.\n                                reject(lastError);\n                                return [2 /*return*/];\n                        }\n                    });\n                }); })];\n        });\n    });\n}\nvar MAX_DELAY_MS = 5 * 60 * 1000;\n/**\n * @private\n * Internal use of Amplify only\n */\nfunction jitteredBackoff(maxDelayMs) {\n    if (maxDelayMs === void 0) { maxDelayMs = MAX_DELAY_MS; }\n    var BASE_TIME_MS = 100;\n    var JITTER_FACTOR = 100;\n    return function (attempt) {\n        var delay = Math.pow(2, attempt) * BASE_TIME_MS + JITTER_FACTOR * Math.random();\n        return delay > maxDelayMs ? false : delay;\n    };\n}\n/**\n * @private\n * Internal use of Amplify only\n */\nvar jitteredExponentialRetry = function (functionToRetry, args, maxDelayMs, onTerminate) {\n    if (maxDelayMs === void 0) { maxDelayMs = MAX_DELAY_MS; }\n    return retry(functionToRetry, args, jitteredBackoff(maxDelayMs), onTerminate);\n};\n//# sourceMappingURL=Retry.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL1JldHJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQixzQ0FBc0Msa0JBQWtCO0FBQ3ZGLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNELGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3Qiw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBLG1CQUFtQixTQUFJLElBQUksU0FBSTtBQUMvQixjQUFjLDZCQUE2QiwwQkFBMEIsY0FBYyxxQkFBcUI7QUFDeEcsaUJBQWlCLG9EQUFvRCxxRUFBcUUsY0FBYztBQUN4Six1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QyxtQ0FBbUMsU0FBUztBQUM1QyxtQ0FBbUMsV0FBVyxVQUFVO0FBQ3hELDBDQUEwQyxjQUFjO0FBQ3hEO0FBQ0EsOEdBQThHLE9BQU87QUFDckgsaUZBQWlGLGlCQUFpQjtBQUNsRyx5REFBeUQsZ0JBQWdCLFFBQVE7QUFDakYsK0NBQStDLGdCQUFnQixnQkFBZ0I7QUFDL0U7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBLFVBQVUsWUFBWSxhQUFhLFNBQVMsVUFBVTtBQUN0RCxvQ0FBb0MsU0FBUztBQUM3QztBQUNBO0FBQ0EsY0FBYyxTQUFJLElBQUksU0FBSTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBSSxJQUFJLFNBQUk7QUFDNUIsNkJBQTZCLHNCQUFzQjtBQUNuRDtBQUNBO0FBQ2tFO0FBQ2xFLGlCQUFpQixnRUFBTTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUM0QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRUFBMkU7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLHNCQUFzQjtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RSxzQkFBc0I7QUFDOUY7QUFDQSxnRUFBZ0U7QUFDaEU7QUFDQSxpREFBaUQ7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUIsSUFBSTtBQUNyQixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLGlDQUFpQztBQUNqQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIi9Vc2Vycy9zYWlzaWRkaGFydGgvRG93bmxvYWRzL2J5dGV4LWh5ZHJvaGVyby00L2J0aGUvbm9kZV9tb2R1bGVzL0Bhd3MtYW1wbGlmeS9jb3JlL2xpYi1lc20vVXRpbC9SZXRyeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG52YXIgX19yZWFkID0gKHRoaXMgJiYgdGhpcy5fX3JlYWQpIHx8IGZ1bmN0aW9uIChvLCBuKSB7XG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICAgIGlmICghbSkgcmV0dXJuIG87XG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XG4gICAgdHJ5IHtcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XG4gICAgfVxuICAgIHJldHVybiBhcjtcbn07XG52YXIgX19zcHJlYWQgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcbiAgICByZXR1cm4gYXI7XG59O1xuaW1wb3J0IHsgQ29uc29sZUxvZ2dlciBhcyBMb2dnZXIgfSBmcm9tICcuLi9Mb2dnZXIvQ29uc29sZUxvZ2dlcic7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignVXRpbCcpO1xudmFyIE5vblJldHJ5YWJsZUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOb25SZXRyeWFibGVFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb25SZXRyeWFibGVFcnJvcihtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm5vblJldHJ5YWJsZSA9IHRydWU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIE5vblJldHJ5YWJsZUVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0IHsgTm9uUmV0cnlhYmxlRXJyb3IgfTtcbnZhciBpc05vblJldHJ5YWJsZUVycm9yID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHZhciBrZXkgPSAnbm9uUmV0cnlhYmxlJztcbiAgICByZXR1cm4gb2JqICYmIG9ialtrZXldO1xufTtcbi8qKlxuICogQHByaXZhdGVcbiAqIEludGVybmFsIHVzZSBvZiBBbXBsaWZ5IG9ubHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldHJ5KGZ1bmN0aW9uVG9SZXRyeSwgYXJncywgZGVsYXlGbiwgb25UZXJtaW5hdGUpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZnVuY3Rpb25Ub1JldHJ5ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ2Z1bmN0aW9uVG9SZXRyeSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdHRlbXB0LCB0ZXJtaW5hdGVkLCB0aW1lb3V0LCB3YWtlVXAsIGxhc3RFcnJvciwgX2xvb3BfMSwgc3RhdGVfMTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlcm1pbmF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FrZVVwID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblRlcm1pbmF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25UZXJtaW5hdGUudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2lnbmFsIG5vdCB0byB0cnkgYW55bW9yZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXJtaW5hdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdG9wIHNsZWVwaW5nIGlmIHdlJ3JlIHNsZWVwaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWtlVXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9vcF8xID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYiwgZXJyXzEsIHJldHJ5SW5fMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVtcHQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhmdW5jdGlvblRvUmV0cnkubmFtZSArIFwiIGF0dGVtcHQgI1wiICsgYXR0ZW1wdCArIFwiIHdpdGggdGhpcyB2YXJzOiBcIiArIEpTT04uc3RyaW5naWZ5KGFyZ3MpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFsxLCAzLCAsIDddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHJlc29sdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBmdW5jdGlvblRvUmV0cnkuYXBwbHkodm9pZCAwLCBfX3NwcmVhZChhcmdzKSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovLCAoX2EudmFsdWUgPSBfYi5hcHBseSh2b2lkIDAsIFtfYy5zZW50KCldKSwgX2EpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzEgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlcnJfMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhcImVycm9yIG9uIFwiICsgZnVuY3Rpb25Ub1JldHJ5Lm5hbWUsIGVycl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05vblJldHJ5YWJsZUVycm9yKGVycl8xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhmdW5jdGlvblRvUmV0cnkubmFtZSArIFwiIG5vbiByZXRyeWFibGUgZXJyb3JcIiwgZXJyXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7IHZhbHVlOiByZWplY3QoZXJyXzEpIH1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnlJbl8xID0gZGVsYXlGbihhdHRlbXB0LCBhcmdzLCBlcnJfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoZnVuY3Rpb25Ub1JldHJ5Lm5hbWUgKyBcIiByZXRyeWluZyBpbiBcIiArIHJldHJ5SW5fMSArIFwiIG1zXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmV0cnlJbl8xID09PSBmYWxzZSB8fCB0ZXJtaW5hdGVkKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgeyB2YWx1ZTogcmVqZWN0KGVycl8xKSB9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzQgLyp5aWVsZCovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdha2VVcCA9IHI7IC8vIGV4cG9ydCB3YWtlVXAgZm9yIG9uVGVybWluYXRlIGhhbmRsaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQod2FrZVVwLCByZXRyeUluXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0ZXJtaW5hdGVkKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs1IC8qeWllbGQqKi8sIF9sb29wXzEoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZV8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgc3RhdGVfMS52YWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVhY2hlZCBpZiB0ZXJtaW5hdGVkIHdoaWxlIHdhaXRpbmcgZm9yIGEgdGltZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChsYXN0RXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pOyB9KV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxudmFyIE1BWF9ERUxBWV9NUyA9IDUgKiA2MCAqIDEwMDA7XG4vKipcbiAqIEBwcml2YXRlXG4gKiBJbnRlcm5hbCB1c2Ugb2YgQW1wbGlmeSBvbmx5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBqaXR0ZXJlZEJhY2tvZmYobWF4RGVsYXlNcykge1xuICAgIGlmIChtYXhEZWxheU1zID09PSB2b2lkIDApIHsgbWF4RGVsYXlNcyA9IE1BWF9ERUxBWV9NUzsgfVxuICAgIHZhciBCQVNFX1RJTUVfTVMgPSAxMDA7XG4gICAgdmFyIEpJVFRFUl9GQUNUT1IgPSAxMDA7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhdHRlbXB0KSB7XG4gICAgICAgIHZhciBkZWxheSA9IE1hdGgucG93KDIsIGF0dGVtcHQpICogQkFTRV9USU1FX01TICsgSklUVEVSX0ZBQ1RPUiAqIE1hdGgucmFuZG9tKCk7XG4gICAgICAgIHJldHVybiBkZWxheSA+IG1heERlbGF5TXMgPyBmYWxzZSA6IGRlbGF5O1xuICAgIH07XG59XG4vKipcbiAqIEBwcml2YXRlXG4gKiBJbnRlcm5hbCB1c2Ugb2YgQW1wbGlmeSBvbmx5XG4gKi9cbmV4cG9ydCB2YXIgaml0dGVyZWRFeHBvbmVudGlhbFJldHJ5ID0gZnVuY3Rpb24gKGZ1bmN0aW9uVG9SZXRyeSwgYXJncywgbWF4RGVsYXlNcywgb25UZXJtaW5hdGUpIHtcbiAgICBpZiAobWF4RGVsYXlNcyA9PT0gdm9pZCAwKSB7IG1heERlbGF5TXMgPSBNQVhfREVMQVlfTVM7IH1cbiAgICByZXR1cm4gcmV0cnkoZnVuY3Rpb25Ub1JldHJ5LCBhcmdzLCBqaXR0ZXJlZEJhY2tvZmYobWF4RGVsYXlNcyksIG9uVGVybWluYXRlKTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZXRyeS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/Retry.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js":
/*!********************************************************************!*\
  !*** ./node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   urlSafeDecode: () => (/* binding */ urlSafeDecode),\n/* harmony export */   urlSafeEncode: () => (/* binding */ urlSafeEncode)\n/* harmony export */ });\nfunction urlSafeEncode(str) {\n    return str\n        .split('')\n        .map(function (char) {\n        return char\n            .charCodeAt(0)\n            .toString(16)\n            .padStart(2, '0');\n    })\n        .join('');\n}\nfunction urlSafeDecode(hex) {\n    return hex\n        .match(/.{2}/g)\n        .map(function (char) { return String.fromCharCode(parseInt(char, 16)); })\n        .join('');\n}\n//# sourceMappingURL=StringUtils.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L2NvcmUvbGliLWVzbS9VdGlsL1N0cmluZ1V0aWxzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ087QUFDUDtBQUNBLGtCQUFrQixFQUFFO0FBQ3BCLCtCQUErQixpREFBaUQ7QUFDaEY7QUFDQTtBQUNBIiwic291cmNlcyI6WyIvVXNlcnMvc2Fpc2lkZGhhcnRoL0Rvd25sb2Fkcy9ieXRleC1oeWRyb2hlcm8tNC9idGhlL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvY29yZS9saWItZXNtL1V0aWwvU3RyaW5nVXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIHVybFNhZmVFbmNvZGUoc3RyKSB7XG4gICAgcmV0dXJuIHN0clxuICAgICAgICAuc3BsaXQoJycpXG4gICAgICAgIC5tYXAoZnVuY3Rpb24gKGNoYXIpIHtcbiAgICAgICAgcmV0dXJuIGNoYXJcbiAgICAgICAgICAgIC5jaGFyQ29kZUF0KDApXG4gICAgICAgICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAgICAgICAucGFkU3RhcnQoMiwgJzAnKTtcbiAgICB9KVxuICAgICAgICAuam9pbignJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gdXJsU2FmZURlY29kZShoZXgpIHtcbiAgICByZXR1cm4gaGV4XG4gICAgICAgIC5tYXRjaCgvLnsyfS9nKVxuICAgICAgICAubWFwKGZ1bmN0aW9uIChjaGFyKSB7IHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGNoYXIsIDE2KSk7IH0pXG4gICAgICAgIC5qb2luKCcnKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0cmluZ1V0aWxzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aws-amplify/core/lib-esm/Util/StringUtils.js\n");

/***/ })

};
;